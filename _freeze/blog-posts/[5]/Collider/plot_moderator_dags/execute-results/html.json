{
  "hash": "75810a02515e0ae6a50c650bffee92b3",
  "result": {
    "markdown": "---\ntitle: \"Moderation DAGs\"\nauthor: \"Jon Brauer\"\ndate: \"2023-05-11\"\noutput: html_document\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'ggdag'\n\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n```{.r .cell-code}\n#Example 1: Simple effect heterogeneity (Typical moderation plot)\n  # Dial up X, either no change or dial up Y, depending on Mod\n  # Dial up Mod, turn on/dial up X -> Y \n  # Dial down Mod, dial down/turn off X -> Y \n\n# https://github.com/r-causal/ggdag/issues/6\n\ncoords <- tribble(\n  ~name,    ~x,  ~y,\n  \"X\",      1,   1,\n  \"Y\",      2,   1,\n  \"Mod\",      1.5, 0,\n  \"holder\", 1.5, 1.05\n) \n\nMod1 <- dagify(\n  Y ~ X,\n  holder ~ Mod,\n  coords = coords\n) %>%\n  tidy_dagitty() %>% \n  dplyr::mutate(Mod = ifelse(name != \"X\", \"#56B4E9\", \"#CC79A7\"))\n\n\n  Mod1p <- Mod1 %>% ggplot(aes(x = x, y = y, xend = xend, yend = yend)) + \n    # geom_dag_point(data = function(x) filter(x, name != \"holder\")) +\n    geom_dag_edges() + \n    geom_dag_text(data = function(x) filter(x, name != \"holder\"), \n                  aes(color = Mod)) +\n    theme_dag() + \n    guides(fill = 'none', color = 'none') +\n    scale_color_manual(values = c(\"#56B4E9\",\"#CC79A7\")) +\n    scale_y_continuous(expand=expansion(mult=c(0.2,0.2))) +\n      #change default expansion on y-axis min & max\n    ggtitle(\"Moderation Ex.1\") + \n    theme(plot.title = element_text(size = 12))\n  \nMod1p\n```\n\n::: {.cell-output-display}\n![](plot_moderator_dags_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Example 2: Shunting or switching process \n  # Dial up X, either dial up M1 or M2, depending on Mod\n  # Dial up Mod, turn on M1 -> Y, turn off M2 -> Y \n  # Dial down Mod, turn off M1 -> Y, turn on M2 -> Y \n  # Dial up M1, dial up Y\n  # Dial up M2, dial down Y\n\nMod2 <- dagify(\n  Y ~ M1 + M2,\n  M1 ~ X , \n  M2 ~ X , \n  holder1 ~ Mod,\n  holder2 ~ Mod, \n  exposure = \"X\",\n  outcome = \"Y\",\n  coords=list(\n    x=c(X=0, holder1=.5, holder2=.5, Mod=1, M1=1, M2=1, Y=2),\n    y=c(X=0, M1=1, M2=-1, Y=0, holder1=.5, holder2=-.5, Mod=0)\n  )) %>% tidy_dagitty() %>% \n  dplyr::mutate(Mod = ifelse(name != \"Mod\", \"#56B4E9\", \"#CC79A7\"))\n\nMod2p <- Mod2 %>% ggplot(aes(x=x, y=y, xend=xend, yend=yend)) +\n  # geom_dag_point(aes(color = Mod)) +\n  geom_dag_edges() +\n  geom_dag_text(data = function(x) filter(x, !name %in% c(\"holder1\",\"holder2\")), \n                  aes(color = Mod)) +\n  theme_dag() + \n  guides(fill = 'none', color = 'none') +\n  scale_color_manual(values = c(\"#56B4E9\",\"#CC79A7\")) +\n  scale_y_continuous(expand=expansion(mult=c(0.2,0.2))) +\n    #change default expansion on y-axis min & max\n  ggtitle(\"Moderation\") + \n  theme(plot.title = element_text(size = 12))\nMod2p\n```\n\n::: {.cell-output-display}\n![](plot_moderator_dags_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "plot_moderator_dags_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}