<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jon Brauer">
<meta name="dcterms.date" content="2023-04-15">

<title>reluctant criminologists - Thoughts on Kurz’s blog re:power</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-F0XQR72SS3"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-F0XQR72SS3', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/RC_banner.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">reluctant criminologists</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog-posts.html">
 <span class="menu-text">blog posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../course-materials.html">
 <span class="menu-text">course materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog-posts/[2]/favorite_links.html">
 <span class="menu-text">links we love</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:reluctantcrim@gmail.com"><i class="bi bi-envelope-fill" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jakeday4/reluctantcrim_website"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/reluctantcrim"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#inspiration" id="toc-inspiration" class="nav-link active" data-scroll-target="#inspiration">Inspiration</a></li>
  <li><a href="#reproduction" id="toc-reproduction" class="nav-link" data-scroll-target="#reproduction">Reproduction</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#anova-ols-based-model." id="toc-anova-ols-based-model." class="nav-link" data-scroll-target="#anova-ols-based-model.">ANOVA (OLS-based) model.</a></li>
  <li><a href="#introduce-baseline-covariate-or-y_pre" id="toc-introduce-baseline-covariate-or-y_pre" class="nav-link" data-scroll-target="#introduce-baseline-covariate-or-y_pre">Introduce baseline covariate, or Y_pre</a></li>
  <li><a href="#ancova-ols-based-models." id="toc-ancova-ols-based-models." class="nav-link" data-scroll-target="#ancova-ols-based-models.">ANCOVA (OLS-based) models.</a></li>
  </ul></li>
  <li><a href="#statistical-power-for-free" id="toc-statistical-power-for-free" class="nav-link" data-scroll-target="#statistical-power-for-free">Statistical Power for Free?</a>
  <ul class="collapse">
  <li><a href="#alternative-ancova-model" id="toc-alternative-ancova-model" class="nav-link" data-scroll-target="#alternative-ancova-model">Alternative ANCOVA model</a></li>
  </ul></li>
  <li><a href="#simulated-example-without-effect-heterogeneity" id="toc-simulated-example-without-effect-heterogeneity" class="nav-link" data-scroll-target="#simulated-example-without-effect-heterogeneity">Simulated Example without Effect Heterogeneity</a>
  <ul class="collapse">
  <li><a href="#simulation-example-1-n10000group" id="toc-simulation-example-1-n10000group" class="nav-link" data-scroll-target="#simulation-example-1-n10000group">Simulation example #1 (n=10,000/group)</a></li>
  <li><a href="#simulation-example-2-n1000group" id="toc-simulation-example-2-n1000group" class="nav-link" data-scroll-target="#simulation-example-2-n1000group">Simulation example #2 (n=1,000/group)</a></li>
  <li><a href="#simulation-example-3-n22group" id="toc-simulation-example-3-n22group" class="nav-link" data-scroll-target="#simulation-example-3-n22group">Simulation example #3 (n=22/group)</a></li>
  <li><a href="#on-sampling-variation-and-average-treatment-effects" id="toc-on-sampling-variation-and-average-treatment-effects" class="nav-link" data-scroll-target="#on-sampling-variation-and-average-treatment-effects">On sampling variation and average treatment effects</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Thoughts on Kurz’s blog re:power</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jon Brauer </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 15, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="inspiration" class="level2">
<h2 class="anchored" data-anchor-id="inspiration">Inspiration</h2>
<p>I have relied heavily on Solomon Kurz’s writings in his translational bookdown projects, so I was excited to continue the journey following his new blog series on causal inferences from RCT designs. Here are my thoughts about the first post, which you can find <a href="https://solomonkurz.netlify.app/blog/2023-04-12-boost-your-power-with-baseline-covariates/">here</a>.</p>
</section>
<section id="reproduction" class="level2">
<h2 class="anchored" data-anchor-id="reproduction">Reproduction</h2>
<p>Let’s reproduce his work.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the global plotting theme</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_gray</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>Read in data.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sl =</span> <span class="fu">c</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>], letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>], letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>], letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sn =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">80</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">19</span>, <span class="dv">19</span>))),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pre =</span> <span class="fu">c</span>(<span class="fl">149.5</span>, <span class="fl">131.25</span>, <span class="fl">146.5</span>, <span class="fl">133.25</span>, <span class="dv">131</span>, <span class="dv">141</span>, <span class="fl">145.75</span>, <span class="fl">146.75</span>, <span class="fl">172.5</span>, <span class="fl">156.5</span>, <span class="dv">153</span>, <span class="fl">136.25</span>, <span class="fl">148.25</span>, <span class="fl">152.25</span>, <span class="fl">167.5</span>, <span class="fl">169.5</span>, <span class="fl">151.5</span>, <span class="dv">165</span>, <span class="fl">144.25</span>, <span class="dv">167</span>, <span class="dv">195</span>, <span class="fl">179.5</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>          <span class="dv">127</span>, <span class="dv">134</span>, <span class="fl">163.5</span>, <span class="dv">155</span>, <span class="fl">157.25</span>, <span class="dv">121</span>, <span class="fl">161.25</span>, <span class="fl">147.25</span>, <span class="fl">134.5</span>, <span class="dv">121</span>, <span class="fl">133.5</span>, <span class="fl">128.5</span>, <span class="dv">151</span>, <span class="fl">141.25</span>, <span class="fl">164.25</span>, <span class="fl">138.25</span>, <span class="dv">176</span>, <span class="dv">178</span>, <span class="dv">183</span>, <span class="dv">164</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>          <span class="dv">149</span>, <span class="fl">134.25</span>, <span class="dv">168</span>, <span class="fl">116.25</span>, <span class="fl">122.75</span>, <span class="fl">122.5</span>, <span class="dv">130</span>, <span class="dv">139</span>, <span class="fl">121.75</span>, <span class="dv">126</span>, <span class="dv">159</span>, <span class="fl">134.75</span>, <span class="fl">140.5</span>, <span class="fl">174.25</span>, <span class="fl">140.25</span>, <span class="dv">133</span>, <span class="fl">171.25</span>, <span class="fl">198.25</span>, <span class="fl">141.25</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>          <span class="dv">137</span>, <span class="dv">157</span>, <span class="fl">142.25</span>, <span class="dv">123</span>, <span class="fl">163.75</span>, <span class="fl">168.25</span>, <span class="fl">146.25</span>, <span class="fl">174.75</span>, <span class="fl">174.5</span>, <span class="fl">179.75</span>, <span class="fl">162.5</span>, <span class="dv">145</span>, <span class="dv">127</span>, <span class="fl">146.75</span>, <span class="fl">137.5</span>, <span class="fl">179.75</span>, <span class="fl">168.25</span>, <span class="fl">187.5</span>, <span class="fl">144.5</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">post =</span> <span class="fu">c</span>(<span class="dv">149</span>, <span class="dv">130</span>, <span class="fl">147.75</span>, <span class="dv">139</span>, <span class="dv">134</span>, <span class="fl">145.25</span>, <span class="fl">142.25</span>, <span class="dv">147</span>, <span class="fl">158.25</span>, <span class="fl">155.25</span>, <span class="fl">151.5</span>, <span class="fl">134.5</span>, <span class="fl">145.75</span>, <span class="fl">153.5</span>, <span class="fl">163.75</span>, <span class="dv">170</span>, <span class="dv">153</span>, <span class="dv">178</span>, <span class="fl">144.75</span>, <span class="fl">164.25</span>, <span class="dv">194</span>, <span class="fl">183.25</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>           <span class="fl">121.75</span>, <span class="fl">132.25</span>, <span class="dv">166</span>, <span class="fl">146.5</span>, <span class="fl">154.5</span>, <span class="dv">114</span>, <span class="fl">148.25</span>, <span class="fl">148.25</span>, <span class="fl">133.5</span>, <span class="fl">126.5</span>, <span class="dv">137</span>, <span class="fl">126.5</span>, <span class="fl">148.5</span>, <span class="fl">145.5</span>, <span class="fl">151.5</span>, <span class="fl">128.5</span>, <span class="fl">176.5</span>, <span class="fl">170.5</span>, <span class="fl">181.5</span>, <span class="fl">160.5</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>           <span class="fl">145.5</span>, <span class="fl">122.75</span>, <span class="dv">164</span>, <span class="fl">118.5</span>, <span class="dv">122</span>, <span class="fl">125.5</span>, <span class="fl">129.5</span>, <span class="dv">137</span>, <span class="fl">119.5</span>, <span class="fl">123.5</span>, <span class="fl">150.5</span>, <span class="fl">125.75</span>, <span class="dv">135</span>, <span class="fl">164.25</span>, <span class="fl">144.5</span>, <span class="fl">135.5</span>, <span class="fl">169.5</span>, <span class="fl">194.5</span>, <span class="fl">142.5</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>           <span class="dv">129</span>, <span class="fl">146.5</span>, <span class="fl">142.25</span>, <span class="fl">114.5</span>, <span class="fl">148.25</span>, <span class="fl">161.25</span>, <span class="fl">142.5</span>, <span class="fl">174.5</span>, <span class="dv">163</span>, <span class="fl">160.5</span>, <span class="fl">151.25</span>, <span class="dv">144</span>, <span class="fl">135.5</span>, <span class="fl">136.5</span>, <span class="fl">145.5</span>, <span class="dv">185</span>, <span class="fl">174.75</span>, <span class="dv">179</span>, <span class="fl">141.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"delayed"</span>, <span class="st">"placebo"</span>, <span class="st">"scheduled"</span>, <span class="st">"experimental"</span>)))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># what is this?</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(horan1971)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  sl       sn treatment   pre  post
  &lt;chr&gt; &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 a         1 delayed    150.  149 
2 b         2 delayed    131.  130 
3 c         3 delayed    146.  148.
4 d         4 delayed    133.  139 
5 e         5 delayed    131   134 
6 f         6 delayed    141   145.</code></pre>
</div>
</div>
<p>Subset to two conditions.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="ot">&lt;-</span> horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treatment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"delayed"</span>, <span class="st">"experimental"</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  treatment        n
  &lt;fct&gt;        &lt;int&gt;
1 delayed         22
2 experimental    19</code></pre>
</div>
</div>
<p>Visualize Y_post (post-treatment weight) across treatment (experimental) &amp; control (delayed) groups.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="sc">%&gt;%</span>  </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> post)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"post-treatment weight (lbs)"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> treatment, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Mean difference in Y_post across groups.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(post),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(post),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">percent_missing =</span> <span class="fu">mean</span>(<span class="fu">is.na</span>(post)) <span class="sc">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  treatment     mean    sd     n percent_missing
  &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;           &lt;dbl&gt;
1 delayed       154.  16.3    22               0
2 experimental  151.  18.3    19               0</code></pre>
</div>
</div>
<p>Data wrangling.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="ot">&lt;-</span> horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make a mean-centered version of pre</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prec =</span> pre <span class="sc">-</span> <span class="fu">mean</span>(pre))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="ot">&lt;-</span> horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delayed      =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"delayed"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">experimental =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"experimental"</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(treatment, delayed, experimental)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  treatment    delayed experimental
  &lt;fct&gt;          &lt;dbl&gt;        &lt;dbl&gt;
1 delayed            1            0
2 experimental       0            1</code></pre>
</div>
</div>
</section>
<section id="anova-ols-based-model." class="level3">
<h3 class="anchored" data-anchor-id="anova-ols-based-model.">ANOVA (OLS-based) model.</h3>
<p>Fit &amp; summarize ANOVA (unconditional mean difference)</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the ANOVA-type model with OLS</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> horan1971,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental, data = horan1971)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.829  -9.079  -4.818   9.932  40.182 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   153.818      3.674  41.864   &lt;2e-16 ***
experimental   -2.489      5.397  -0.461    0.647    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.23 on 39 degrees of freedom
Multiple R-squared:  0.005424,  Adjusted R-squared:  -0.02008 
F-statistic: 0.2127 on 1 and 39 DF,  p-value: 0.6472</code></pre>
</div>
</div>
<p>Isolate key ANOVA estimate &amp; add 95%CI.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(ols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  term         estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 experimental    -2.49       5.4     -0.46    0.65    -13.4      8.43</code></pre>
</div>
</div>
</section>
<section id="introduce-baseline-covariate-or-y_pre" class="level3">
<h3 class="anchored" data-anchor-id="introduce-baseline-covariate-or-y_pre">Introduce baseline covariate, or Y_pre</h3>
<p>Baseline covariate, Y_pre (pre-treatment weight), is highly correlated with Y_post outcome</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">r =</span> <span class="fu">cor</span>(pre, post))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  treatment        r
  &lt;fct&gt;        &lt;dbl&gt;
1 delayed      0.955
2 experimental 0.909</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for the annotation</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>r_text <span class="ot">&lt;-</span> horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">r =</span> <span class="fu">cor</span>(pre, post)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pre  =</span> <span class="dv">130</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">post =</span> <span class="dv">190</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">text =</span> <span class="fu">str_c</span>(<span class="st">"italic(r)=="</span>, <span class="fu">round</span>(r, <span class="at">digits =</span> <span class="dv">3</span>)))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot!</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="sc">%&gt;%</span>  </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pre, <span class="at">y =</span> post)) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> r_text,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> text),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red4"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">110</span>, <span class="dv">200</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">110</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> treatment, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Summarize mean of Y_pre</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pre_mean =</span> <span class="fu">mean</span>(pre),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">pre_sd =</span> <span class="fu">sd</span>(pre),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">pre_min =</span> <span class="fu">min</span>(pre))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  pre_mean pre_sd pre_min
     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1     155.   17.5     123</code></pre>
</div>
</div>
</section>
<section id="ancova-ols-based-models." class="level3">
<h3 class="anchored" data-anchor-id="ancova-ols-based-models.">ANCOVA (OLS-based) models.</h3>
<p>Fit &amp; summarize ANCOVA (conditional mean difference) models by stratifying on Y_pre (centered and non-centered versions).</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit with the centered `prec` covariate</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ols2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> horan1971,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fit with the non-centered `pre` covariate</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ols3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> horan1971,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> pre</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the centered model</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + prec, data = horan1971)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.5810  -3.3996  -0.4384   2.7288  13.9824 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  154.78354    1.36142 113.693   &lt;2e-16 ***
experimental  -4.57237    2.00226  -2.284   0.0281 *  
prec           0.90845    0.05784  15.705   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.379 on 38 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.8602 
F-statistic: 124.1 on 2 and 38 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the non-centered model</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + pre, data = horan1971)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.5810  -3.3996  -0.4384   2.7288  13.9824 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  14.12281    8.99835   1.569   0.1248    
experimental -4.57237    2.00226  -2.284   0.0281 *  
pre           0.90845    0.05784  15.705   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.379 on 38 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.8602 
F-statistic: 124.1 on 2 and 38 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Isolate key ANCOVA estimate &amp; add 95%CI.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(ols2, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  term         estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 experimental    -4.57         2     -2.28    0.03    -8.63     -0.52</code></pre>
</div>
</div>
<p>Visualize ANOVA &amp; ANCOVA estimates + intervals.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">tidy</span>(ols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(ols2, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist])), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="statistical-power-for-free" class="level2">
<h2 class="anchored" data-anchor-id="statistical-power-for-free">Statistical Power for Free?</h2>
<p>At this point, Kurz states:</p>
<blockquote class="blockquote">
<p>“Both the ANOVA and ANCOVA models are known to produce unbiased estimates of the population parameters, but the ANCOVA model tends to produce estimates that are more precise (e.g., O’Connell et al., 2017). Thus if you have a high-quality baseline covariate laying around, it’s a good idea to throw it into the model.”</p>
</blockquote>
<p>He further notes:</p>
<blockquote class="blockquote">
<p>“…this pattern will arise again and again when you use OLS models. Adding baseline covariates will generally shrink your standard errors. It’s like getting statistical power for free. Perhaps a more helpful line of inquiry is: How can I use this information to better design my studies?”</p>
</blockquote>
<p>Statistical power for free! Is this really an exception to the <a href="https://en.wikipedia.org/wiki/There_ain%27t_no_such_thing_as_a_free_lunch">TNSTAAFL</a> (“There’s no such thing as a free lunch) adage? Before Milton Friedman ressurects <a href="https://www.youtube.com/watch?v=YmqoCHR14n8">in opposition</a>, let’s take a closer look at what might be happening here.</p>
<p>Might this simply be due to fundamental differences between the ANOVA and ANCOVA model estimates? The ANOVA model estimates the unconditional mean difference in post-treatment weight across groups, whereas the ANCOVA model estimates the mean difference in post-treatment weight across groups <em>at the average pre-treatment weight</em>. The ANOVA model’s standard error (SE) and 95%CIs communicate uncertainty in that estimate due to observed variation in the data, irrespective of the sources of that variation. The ANCOVA model’s SE and 95%CIs are estimated from a model that makes more restrictive assumptions about the sources of variation in the data - for instance, it imposes an assumption that the estimated treatment effect is constant across strata of the baseline covariate (i.e., pre-treatment weight).</p>
<p>Now, imagine there are substantial baseline differences in the distributions of pre-treatment weight across groups, or imagine that the treatment effect actually varies (i.e., there is effect heterogeneity) across levels of pre-treatment weight (Y_pre). Why might stratification on baseline Y_pre values result in smaller CIs and (the illusion of) increased power of the statistical test in the ANCOVA model? Well, for one, if the experimental treatment indeed had different effects for people with different baseline covariate (Y_pre) values, then the current OLS-based ANCOVA model above ignores this existing treatment heterogeneity. In contrast, the ANOVA model still estimates the mean difference between groups in post-treatment weights (Y_post). If there were no baseline distributional differences and the treatment has nearly the same effect on everyone in the treatment group, then I would expect the ANOVA model to estimate that effect relatively precisely (i.e., with narrower CIs). However, if the treatment effect varies, then the ANOVA estimate will necessarily capture that existing variation in its standard error and resulting confidence limits (i.e., with wide CIs). Put simply, the ANOVA model does not have the luxury of adjusting out or restrictively assuming away variation due to sources like effect heterogeneity - it’s SE and CIs must capture the existing variation when estimating the average treatment effect across the entire sample.</p>
<p>Let’s see if any of this might be happening in the current example. Below, I will rerun the OLS-based ANCOVA model, but this time I also include an interaction term. My hunch is that the treatment estimate might vary across levels of baseline pre-treatment weight and, if so, then it might do so in a way that as one “slides” the estimates around Y_pre values, the resulting CIs will be captured by the overall ANOVA bounds. Maybe I’m wrong, which might lead me to learn something about power along the way.</p>
<section id="alternative-ancova-model" class="level3">
<h3 class="anchored" data-anchor-id="alternative-ancova-model">Alternative ANCOVA model</h3>
<p>To simplify the process, I will create new Y_pre variables centered at the minimum and maximum pre-treatment weight values, then re-estimate the <code>ols2</code> model at the mean(Y_pre), min(Y_pre), and max(Y_pre) values, and finally plot the estimated mean differences alongside the ANOVA estimate.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>horan1971 <span class="ot">&lt;-</span> horan1971 <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make min-centered &amp; max-centered version of pre</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">premin =</span> pre <span class="sc">-</span> <span class="fu">min</span>(pre), </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">premax =</span> pre <span class="sc">-</span> <span class="fu">max</span>(pre))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fit with the Y_pre variables at different locations </span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>ols4min <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> horan1971,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premin <span class="sc">+</span> experimental<span class="sc">*</span>premin</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>ols4c <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> horan1971,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>ols4max <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> horan1971,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premax <span class="sc">+</span> experimental<span class="sc">*</span>premax</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the centered model</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols4min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + premin + experimental * 
    premin, data = horan1971)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.286  -3.055  -0.174   2.358  13.560 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         124.70416    2.96158  42.107  &lt; 2e-16 ***
experimental         -2.32029    4.23537  -0.548    0.587    
premin                0.94610    0.08530  11.092 2.53e-13 ***
experimental:premin  -0.07072    0.11691  -0.605    0.549    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.433 on 37 degrees of freedom
Multiple R-squared:  0.8685,    Adjusted R-squared:  0.8579 
F-statistic: 81.47 on 3 and 37 DF,  p-value: 2.314e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols4c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + prec + experimental * 
    prec, data = horan1971)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.286  -3.055  -0.174   2.358  13.560 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       154.82354    1.37452 112.639  &lt; 2e-16 ***
experimental       -4.57168    2.01917  -2.264   0.0295 *  
prec                0.94610    0.08530  11.092 2.53e-13 ***
experimental:prec  -0.07072    0.11691  -0.605   0.5489    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.433 on 37 degrees of freedom
Multiple R-squared:  0.8685,    Adjusted R-squared:  0.8579 
F-statistic: 81.47 on 3 and 37 DF,  p-value: 2.314e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols4max)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + premax + experimental * 
    premax, data = horan1971)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.286  -3.055  -0.174   2.358  13.560 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         192.82324    3.77461  51.084  &lt; 2e-16 ***
experimental         -7.41212    5.11039  -1.450    0.155    
premax                0.94610    0.08530  11.092 2.53e-13 ***
experimental:premax  -0.07072    0.11691  -0.605    0.549    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.433 on 37 degrees of freedom
Multiple R-squared:  0.8685,    Adjusted R-squared:  0.8579 
F-statistic: 81.47 on 3 and 37 DF,  p-value: 2.314e-16</code></pre>
</div>
</div>
<p>Now let’s plot these estimates and intervals along with the ANOVA estimate.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#unconditional (ANOVA) &amp; conditional (ANCOVA) mean difference estimates: </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">tidy</span>(ols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(ols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(ols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(ols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"ANCOVA_Ypremax"</span>), </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"ANCOVA_Ypremax"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist])), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To recap, what have I done here? First, I added an interaction term to the ANCOVA model to allow for the possibility of treatment heterogeneity across strata of the baseline covariate. Second, I reestimated the model using pre-treatment variables centered at different locations - that is, at the pre-treatment minimum, mean, and maximum weights - to facilitate generation of the (potentially variable) estimate of the treatment effect at these different baseline covariate values. If there were no treatment effect differences across pre-treatment weight strata, then all three new ANCOVA models would have generated comparable mean difference estimates. However, the model implies there <strong>are</strong> treatment effect differences across different pre-treatment weights, which is not too surprising. After all, those in heavier pre-treatment weight groups (e.g., “Y_premax”) at baseline have more to lose in an effective experimental treatment condition than do those in lighter pre-treatment weight groups (e.g., “Y_premin”).</p>
<p>Likewise, once I take these potential differences into account, the 95% CIs around our ANCOVA model estimates at these three strata together are much wider and more closely overlap the overall ANOVA estimate’s bounds. Note, too, that the overlap is not perfect. This is unsurprising given our model specifications. After all, our ANCOVA stratifies on baseline weight and assumes that a particular functional (multiplicative linear) form adequately summarizes the interactive relationship between pre-treatment weight and the experimental treatment effect, while the ANOVA model summarizes post-treatment differences in weight that are due to all possible sources, including potential experimental effects and existing baseline pre-treatment differences. Likewise, in estimating the treatment effect across the strata of the pre-treatment variable (i.e., across different pre-treatment weights), estimation of standard errors and resulting CIs are affected by available data within each strata which, unsurprisingly, are not constant across Y_pre strata.</p>
<p>But is it that simple? Does this imply that an ANOVA and an ANCOVA estimate will have more similar confidence limits if there is no effect heterogeneity? Let’s explore this question with a simulation - maybe this will help us build a better intuition for what is happening in the ANOVA and ANCOVA models.</p>
</section>
</section>
<section id="simulated-example-without-effect-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="simulated-example-without-effect-heterogeneity">Simulated Example without Effect Heterogeneity</h2>
<p>To generate the simulated data, I will use the observed statistical estimates from the example above as the population parameters in the simulation. For instance, I will first use <code>rnorm()</code> to simulate two groups of pre-treatment weights from a normally distributed population of pre-treatment weights summarized by the same group means and standard deviations observed in the “pre” weights above. Then, I use the <a href="https://debruine.github.io/faux/"><code>faux</code></a> package to simulate post-treatment weights from a population with the same overall mean and standard deviation obsvered for the “post” weights, and correlated with our simulated pre-treatment weights at a population average of <em>r</em>=0.95, plus a population-expected treatment effect of -4.57 for the experimental treatment group.</p>
<p>I will start with very large samples - two groups of n=10,000 each - to ensure our samples reflect the population parameters. Then, I will repeat the simulation with two groups of n=1,000, and finally repeat a third time with two groups of n=22 participants to better match the real-world example above.</p>
<section id="simulation-example-1-n10000group" class="level3">
<h3 class="anchored" data-anchor-id="simulation-example-1-n10000group">Simulation example #1 (n=10,000/group)</h3>
<section id="simulate-data" class="level4">
<h4 class="anchored" data-anchor-id="simulate-data">Simulate data</h4>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library("faux")</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#faux package removed from CRAN</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#archive: https://cran.r-project.org/src/contrib/Archive/faux/</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("groundhog")</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"groundhog"</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">groundhog.library</span>(faux, <span class="st">"2023-03-01"</span>, <span class="at">tolerate.R.version=</span><span class="st">'4.2.2'</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustrate sample mean differences for two independent population groups </span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>nval <span class="ot">&lt;-</span> <span class="dv">20000</span> <span class="co">#treat</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>ngrp <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1138</span>) </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>meanpret <span class="ot">&lt;-</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>pre[horan1971<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">"experimental"</span>])</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>sdpret <span class="ot">&lt;-</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>pre[horan1971<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">"experimental"</span>])</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>meanprec <span class="ot">&lt;-</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>pre[horan1971<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">"delayed"</span>])</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>sdprec <span class="ot">&lt;-</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>pre[horan1971<span class="sc">$</span>treatment<span class="sc">==</span><span class="st">"delayed"</span>])</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co">#sim two pre-treatment columns (groups) of rnorm values with "nval" size </span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>pretrt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanpret, <span class="at">sd=</span>sdpret) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>precon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanprec, <span class="at">sd=</span>sdprec) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pretrt, precon)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">sn =</span> <span class="dv">1</span><span class="sc">:</span>nval, </span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="fu">c</span>(ngrp, ngrp)))) <span class="sc">%&gt;%</span> </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"experimental"</span>, <span class="st">"control"</span>)),</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">experimental =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"experimental"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>         )  </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(simdata, pre)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> simdata <span class="sc">%&gt;%</span> </span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">post =</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fl">4.57</span><span class="sc">*</span>experimental <span class="sc">+</span> <span class="fu">rnorm_pre</span>(pre, <span class="at">mu =</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>post), <span class="at">sd =</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>post), <span class="at">r =</span> <span class="fl">0.95</span>), <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec =</span> pre <span class="sc">-</span> <span class="fu">mean</span>(pre), </span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">premin =</span> pre <span class="sc">-</span> <span class="fu">min</span>(pre), </span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">premax =</span> pre <span class="sc">-</span> <span class="fu">max</span>(pre)</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  sn    treatment experimental      pre   post       prec   premin    premax
1  1 experimental            1 144.6470 140.90 -10.258896 56.47521 -81.79768
2  2 experimental            1 144.5391 140.78 -10.366772 56.36733 -81.90555
3  3 experimental            1 164.3527 158.80   9.446877 76.18098 -62.09191
4  4 experimental            1 157.7138 139.61   2.807936 69.54204 -68.73085
5  5 experimental            1 144.9790 142.61  -9.926859 56.80725 -81.46564
6  6 experimental            1 144.4601 145.79 -10.445780 56.28832 -81.98456</code></pre>
</div>
</div>
<p>Summarize &amp; plot Y_pre distributions</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(pre),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(pre),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  treatment     mean    sd     n
  &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 experimental  155.  17.7 20000
2 control       155.  17.7 20000</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span>  </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pre)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"pre-treatment weight (lbs)"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> treatment, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Summarize &amp; plot Y_post distributions</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(post),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(post),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  treatment     mean    sd     n
  &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 experimental  148.  17.0 20000
2 control       153.  17.1 20000</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span>  </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> post)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"post-treatment weight (lbs)"</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> treatment, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pre-post correlation</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">r =</span> <span class="fu">cor</span>(pre, post))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  treatment        r
  &lt;fct&gt;        &lt;dbl&gt;
1 experimental 0.950
2 control      0.950</code></pre>
</div>
</div>
</section>
<section id="fit-models" class="level4">
<h4 class="anchored" data-anchor-id="fit-models">Fit models</h4>
<p>Let’s check the ANOVA estimate first.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA (OLS)</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>simols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental, data = simdata)

Residuals:
    Min      1Q  Median      3Q     Max 
-71.756 -11.405   0.044  11.434  74.024 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  152.6254     0.1206 1265.83   &lt;2e-16 ***
experimental  -4.4892     0.1705  -26.33   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.05 on 39998 degrees of freedom
Multiple R-squared:  0.01703,   Adjusted R-squared:  0.01701 
F-statistic: 693.1 on 1 and 39998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  term         estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 experimental    -4.49      0.17     -26.3       0    -4.82     -4.15</code></pre>
</div>
</div>
<p>Our ANOVA estimate (-4.49) is close to the population specified treatment effect (-4.57). Given how large our sample is, the confidence intervals [-4.82, -4.15] might seem somewhat imprecise.</p>
<p>Now, let’s fit the ANCOVA models and allow for the possibility of treatment effect heterogeneity across baseline pre-treatment weights. We did not specify effect heterogeneity in the population, so we do not expect our large samples to show evidence of much, if any, interaction.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANCOVA (OLS) with interaction to capture any effect heterogeneity  </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>simols4min <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premin <span class="sc">+</span> experimental<span class="sc">*</span>premin</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>simols4c <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>simols4max <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premax <span class="sc">+</span> experimental<span class="sc">*</span>premax</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the centered model</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols4min)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + premin + experimental * 
    premin, data = simdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-21.5773  -3.6340   0.0106   3.5920  21.3581 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         91.580137   0.146640 624.521   &lt;2e-16 ***
experimental        -4.442811   0.207694 -21.391   &lt;2e-16 ***
premin               0.914961   0.002124 430.753   &lt;2e-16 ***
experimental:premin -0.001109   0.003008  -0.369    0.712    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.328 on 39996 degrees of freedom
Multiple R-squared:  0.904, Adjusted R-squared:  0.904 
F-statistic: 1.256e+05 on 3 and 39996 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols4c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + prec + experimental * 
    prec, data = simdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-21.5773  -3.6340   0.0106   3.5920  21.3581 

Coefficients:
                    Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)       152.639222   0.037677 4051.216   &lt;2e-16 ***
experimental       -4.516850   0.053284  -84.770   &lt;2e-16 ***
prec                0.914961   0.002124  430.753   &lt;2e-16 ***
experimental:prec  -0.001109   0.003008   -0.369    0.712    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.328 on 39996 degrees of freedom
Multiple R-squared:  0.904, Adjusted R-squared:  0.904 
F-statistic: 1.256e+05 on 3 and 39996 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols4max)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + premax + experimental * 
    premax, data = simdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-21.5773  -3.6340   0.0106   3.5920  21.3581 

Coefficients:
                      Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)         218.094400   0.156588 1392.793   &lt;2e-16 ***
experimental         -4.596221   0.221694  -20.732   &lt;2e-16 ***
premax                0.914961   0.002124  430.753   &lt;2e-16 ***
experimental:premax  -0.001109   0.003008   -0.369    0.712    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.328 on 39996 degrees of freedom
Multiple R-squared:  0.904, Adjusted R-squared:  0.904 
F-statistic: 1.256e+05 on 3 and 39996 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot mean difference estimates: </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(simols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"ANCOVA_Ypremax"</span>), </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"ANCOVA_Ypremax"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist])), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Simulation #1, n=10,000 per group"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The first thing to note is that all four point estimates - the unconditional ANOVA estimate and the three conditional ANCOVA estimates at the maximum, mean, and minimum values of the baseline covariate - are very similar. This is unsurprising since I did not specify any population treatment effect heterogeneity when generating the simulated data, which means we forced the data to conform to an expectation that the treatment has the same effect on weight irrespective of one’s pre-treatment baseline weight.</p>
<p>The next thing to note is that the ANCOVA estimate of the conditional mean difference in post-treatment weights between experimental and baseline groups is far more precise - that is, it has much smaller confidence interval - at the mean value of the Y_pre variable (Yprec) compared to the ANOVA estimate. This is the same pattern referenced in Kurz’s post sometimes interpreted as free precision or statistical power. Moreover, a glance at the model summary output shows its point estimate (-4.52) to be a little closer to the population-specified treatment effect (-4.57) than was the ANOVA estimate (-4.49).</p>
<p>Now, note that the other two ANCOVA estimates have <em>wider</em> confidence intervals compared to the unconditional ANOVA estimate. Essentially, these models communicate greater uncertainty in estimating treatment effects at the tails of the baseline covariate’s distribution, where data are more sparse. This should help remind us that ANCOVA model <em>estimates and uncertainty are conditional</em> on the location of covariates; the ANOVA estimate, in contrast, is <em>unconditional</em>, meaning it does not depend on any specific value of a covariate in the model.</p>
<p>Conceptually, it might be helpful to think of the ANOVA estimate as summarizing our best guess of the group difference in the outcome (post-treatment weights) that might be due to any and all sources combined - and as summarizing our uncertainty in that best guess given the total amount of outcome variation (e.g., spread of post-treatment weights) observed across both groups. In our example, this means the ANOVA estimate of post-treatment differences is affected by both of the things that we specified as causally relevant in our simulation: (1) it is affected by the average group differences that are due to experimental treatment effects (-4.57*experimental) and any random sampling variation around that average treatment differences, and (2) by any average baseline differences in pre-treatment weight that existed due to research design and/or random sampling variation.</p>
<p>Hence, if what we really care about is an estimate of the causal effect of an experimental treatment on an outcome, then the ANOVA’s unconditional estimate is not a very good fit for that aim. The ANCOVA model, though, helps us adjust out or cleanse our unconditional estimate of average differences and sources of variation/uncertainty that are caused by things that are not our experimental treatment. For more information about the relationship between ANOVA and the average treatment effect, <a href="https://www.tandfonline.com/doi/abs/10.1080/00273171.2022.2068122">check out this paper</a>.)</p>
<p>Now, let’s rerun the simulation with smaller groups of n=1,000 each.</p>
</section>
</section>
<section id="simulation-example-2-n1000group" class="level3">
<h3 class="anchored" data-anchor-id="simulation-example-2-n1000group">Simulation example #2 (n=1,000/group)</h3>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustrate sample mean differences for two independent population groups </span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>nval <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co">#treat</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>ngrp <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1138</span>) </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co">#sim two pre-treatment columns (groups) of rnorm values with "nval" size </span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>pretrt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanpret, <span class="at">sd=</span>sdpret) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>precon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanprec, <span class="at">sd=</span>sdprec) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pretrt, precon)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sn =</span> <span class="dv">1</span><span class="sc">:</span>nval, </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="fu">c</span>(ngrp, ngrp)))) <span class="sc">%&gt;%</span> </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"experimental"</span>, <span class="st">"control"</span>)),</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">experimental =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"experimental"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>         )  </span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(simdata, pre)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> simdata <span class="sc">%&gt;%</span> </span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">post =</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fl">4.57</span><span class="sc">*</span>experimental <span class="sc">+</span> <span class="fu">rnorm_pre</span>(pre, <span class="at">mu =</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>post), <span class="at">sd =</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>post), <span class="at">r =</span> <span class="fl">0.95</span>), <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec =</span> pre <span class="sc">-</span> <span class="fu">mean</span>(pre), </span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">premin =</span> pre <span class="sc">-</span> <span class="fu">min</span>(pre), </span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">premax =</span> pre <span class="sc">-</span> <span class="fu">max</span>(pre)</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA (OLS)</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>simols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ANCOVA (OLS) with interaction to capture any effect heterogeneity  </span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>simols4min <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premin <span class="sc">+</span> experimental<span class="sc">*</span>premin</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>simols4c <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>simols4max <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premax <span class="sc">+</span> experimental<span class="sc">*</span>premax</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot mean difference estimates: </span></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb55-56"><a href="#cb55-56" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(simols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-57"><a href="#cb55-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-58"><a href="#cb55-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"ANCOVA_Ypremax"</span>), </span>
<span id="cb55-59"><a href="#cb55-59" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"ANCOVA_Ypremax"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb55-60"><a href="#cb55-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-61"><a href="#cb55-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb55-62"><a href="#cb55-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb55-63"><a href="#cb55-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb55-64"><a href="#cb55-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb55-65"><a href="#cb55-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist])), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb55-66"><a href="#cb55-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb55-67"><a href="#cb55-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Simulation #2, n=1,000 per group"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the second example, we still have pretty large samples, so what the heck happened here? Let’s check summaries of the pre-treatment weight distributions, as well as summary outputs from the ANOVA model and the ANCOVA model with the centered pre-treatment weight baseline covariate, to see if they can shed any light on this.</p>
<p>Summarize &amp; plot Y_pre distributions</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(pre),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(pre),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  treatment     mean    sd     n
  &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 experimental  155.  17.6  2000
2 control       156.  17.9  2000</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span>  </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pre)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"pre-treatment weight (lbs)"</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> treatment, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental, data = simdata)

Residuals:
    Min      1Q  Median      3Q     Max 
-63.828 -11.542  -0.196  11.500  59.892 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  153.2678     0.3847  398.43   &lt;2e-16 ***
experimental  -5.5072     0.5440  -10.12   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.2 on 3998 degrees of freedom
Multiple R-squared:  0.02499,   Adjusted R-squared:  0.02475 
F-statistic: 102.5 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols4c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + prec + experimental * 
    prec, data = simdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.5670  -3.6084  -0.0088   3.6110  18.3608 

Coefficients:
                    Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)       152.826898   0.118452 1290.206   &lt;2e-16 ***
experimental       -4.622233   0.167517  -27.593   &lt;2e-16 ***
prec                0.918004   0.006613  138.822   &lt;2e-16 ***
experimental:prec   0.006700   0.009429    0.711    0.477    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.295 on 3996 degrees of freedom
Multiple R-squared:  0.9077,    Adjusted R-squared:  0.9076 
F-statistic: 1.309e+04 on 3 and 3996 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Compared to our first simulation example (n=10,000/group), the ANOVA and ANCOVA (at centered baseline) estimates are more divergent in this second example with smaller groups (n=1,000 each). The ANOVA estimate (-5.51) is substantially off the population mark (-4.57), whereas the ANCOVA estimate is much closer (-4.62). Why?</p>
<p>Well, recall that the ANOVA model provides and <em>unconditional</em> estimate of the post-treatment differences between groups - ignoring any potential reasons for those differences, such as pre-treatment sampling variability or confounding. Yet, there is a small pre-treatment difference in weights due to sampling variability: the experimental group started off as approximately one pound (0.96) lighter on average than the control group before treatment. If we add this pre-existing difference to our population-expected treatment effect, we would expect an unconditional estimate of the group difference in post-treatment weights to be close to (-4.57 - 0.96) -5.53 pounds. Likewise, the ANOVA estimate is close, at -5.51 pounds. In short, baseline differences in pre-treatment weight shifts our ANOVA estimate about 1 unit (lbs) to the left in our plot.</p>
<p>Again, the unconditional ANOVA estimate summarizes post-treatment differences in weight from <em>all</em> sources. In contrast, the ANCOVA model stratifies on the centered baseline covariate to provide an estimate of the post-treatment differences in weights conditional on a specific strata of the baseline covariate (i.e., at the average pre-treatment weight). After holding constant pre-treatment weight at the baseline covariate’s mean, the ANCOVA model better estimates (-4.62) the population-expected post-treatment difference in group weight attributable to the treatment (-4.57). (Though the ANCOVA model estimate would also be confounded by any other unmeasured causes of difference, had we included any such confounding causes in our simulation).</p>
<p>Finally, note that the ANCOVA estimates vary somewhat across strata of the baseline covariate (i.e., across minimum, mean, and maximum pre-treatment values). Recall, I did not specify any such differences in the simulation; rather, these appeared due to sampling variation - and as samples get smaller, such “apparent interactions” are more likely to occur as artifacts of sampling variation.</p>
<p>Now, let’s run this one more time with smaller group sizes of n=22 each to provide a better match to the real-world example used in Kurz’s post.</p>
</section>
<section id="simulation-example-3-n22group" class="level3">
<h3 class="anchored" data-anchor-id="simulation-example-3-n22group">Simulation example #3 (n=22/group)</h3>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustrate sample mean differences for two independent population groups </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>nval <span class="ot">&lt;-</span> <span class="dv">44</span> <span class="co">#treat</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ngrp <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1138</span>) </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#sim two pre-treatment columns (groups) of rnorm values with "nval" size </span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>pretrt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanpret, <span class="at">sd=</span>sdpret) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>precon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanprec, <span class="at">sd=</span>sdprec) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pretrt, precon)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sn =</span> <span class="dv">1</span><span class="sc">:</span>nval, </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="fu">c</span>(ngrp, ngrp)))) <span class="sc">%&gt;%</span> </span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"experimental"</span>, <span class="st">"control"</span>)),</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">experimental =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"experimental"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>         )  </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(simdata, pre)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> simdata <span class="sc">%&gt;%</span> </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">post =</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fl">4.57</span><span class="sc">*</span>experimental <span class="sc">+</span> <span class="fu">rnorm_pre</span>(pre, <span class="at">mu =</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>post), <span class="at">sd =</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>post), <span class="at">r =</span> <span class="fl">0.95</span>), <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec =</span> pre <span class="sc">-</span> <span class="fu">mean</span>(pre), </span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">premin =</span> pre <span class="sc">-</span> <span class="fu">min</span>(pre), </span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">premax =</span> pre <span class="sc">-</span> <span class="fu">max</span>(pre)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA (OLS)</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>simols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ANCOVA (OLS) with interaction to capture any effect heterogeneity  </span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>simols4min <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premin <span class="sc">+</span> experimental<span class="sc">*</span>premin</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>simols4c <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>simols4max <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premax <span class="sc">+</span> experimental<span class="sc">*</span>premax</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize &amp; plot Y_pre distributions</span></span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span> </span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span> </span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(pre),</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(pre),</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  treatment     mean    sd     n
  &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 experimental  159.  16.6    44
2 control       154.  19.2    44</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>simdata <span class="sc">%&gt;%</span>  </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pre)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"pre-treatment weight (lbs)"</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> treatment, <span class="at">labeller =</span> label_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental, data = simdata)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.250 -14.274  -0.652  10.976  44.840 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  148.8298     2.6870  55.390   &lt;2e-16 ***
experimental   0.2139     3.7999   0.056    0.955    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.82 on 86 degrees of freedom
Multiple R-squared:  3.683e-05, Adjusted R-squared:  -0.01159 
F-statistic: 0.003168 on 1 and 86 DF,  p-value: 0.9552</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simols4c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = post ~ 1 + experimental + prec + experimental * 
    prec, data = simdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-18.5645  -3.0508  -0.3504   3.5406  11.7802 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       151.554009   0.852739 177.726  &lt; 2e-16 ***
experimental       -5.218918   1.208225  -4.319 4.26e-05 ***
prec                0.947323   0.044478  21.299  &lt; 2e-16 ***
experimental:prec  -0.005457   0.067966  -0.080    0.936    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.592 on 84 degrees of freedom
Multiple R-squared:  0.9038,    Adjusted R-squared:  0.9004 
F-statistic: 263.2 on 3 and 84 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot mean difference estimates: </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(simols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span> <span class="sc">|</span> term <span class="sc">==</span> <span class="st">"prec"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"Baseline_diff_prec"</span>, <span class="st">"ANCOVA_Ypremax"</span>), </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, <span class="st">"Baseline_diff_prec"</span>, <span class="st">"ANCOVA_Ypremax"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist])), <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Simulation #3, n=22 per group"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>First, note that at pre-treatment baseline the simulated experimental group (159.41) is about 5.75 pounds heavier on average than the control group (mean=153.66). In the above plot, I added this estimated baseline difference to the plot (“Baseline_diff_prec”), as it might help us visualize what is happening in the ANOVA estimate. Specifically, the baseline pre-treatment weight difference should shift the ANOVA estimate of post-treatment differences to the right, since the ANOVA model provides an unconditional estimate that essentially is an aggregated summary of all sources of post-treatment differences in weight - including treatment effects and pre-existing weight differences. Sure enough, the ANOVA model estimate and the coefficient plots bear out this expectation.</p>
<p>Second, we see the same pattern of differences in uncertainty across ANCOVA estimates where the baseline covariate is centered at different values (e.g., at the minimum, mean, or maximum pre-treatment weight). Conditional ANCOVA estimates are just that - they are conditional on specific values of the covariate - and thus they tend to be more certain at the center of a distribution and are less certain at the tails of a covariate distribution. Meanwhile, the ANOVA model’s unconditional estimate summarizes post-treatment differences and variation/uncertainty from all sources, including experimental effects and baseline differences in pre-treatment weight.</p>
</section>
<section id="on-sampling-variation-and-average-treatment-effects" class="level3">
<h3 class="anchored" data-anchor-id="on-sampling-variation-and-average-treatment-effects">On sampling variation and average treatment effects</h3>
<p>Now, let’s wrap up with a couple more illustrations using simulation #3. First, we will use the <code>margins</code> package to add an estimate of the experiment’s average marginal effect (AME). Kurz’s first post does not really get into this, though it sound like he plans to discuss marginal effects in later posts in the series. As such, we will not get into details here. For now, you might think of the AME conceptually as follows: It is the effect estimate that we would get if we followed our approach of fitting an ANCOVA model with new baseline covariates that were recentered at all observed values of pre-treatment weight, extracted the estimates and uncertainty intervals from each of those models, and then averaged all these into a single estimate and corresponding uncertainty interval.</p>
<p>Under certain conditions, such as a linear model with no effect heterogeneity, the ANCOVA estimate from a model with a baseline covariate centered at its mean will converge with the AME estimate and interval. However, in other situations, such as when effect heterogeneity is present (i.e., interactions exist) and/or when fitting a generalized linear model with a nonlinear link function, these estimates will not always converge. For now, let’s just add them to our plot to provide a bit more information.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"margins"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">lm</span>(post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec, <span class="at">data =</span> simdata)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">margins_summary</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       factor     AME     SE       z      p   lower   upper
 experimental -5.2189 1.2084 -4.3190 0.0000 -7.5872 -2.8506
         prec  0.9446 0.0340 27.7961 0.0000  0.8780  1.0112</code></pre>
</div>
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>amecoef <span class="ot">&lt;-</span> <span class="fu">tidy</span>(x, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>plot22_1138 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(simols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>          amecoef) <span class="sc">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>), </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist]))) <span class="sc">+</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sim #3, seed=1138"</span>) </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>plot22_1138</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As implied, the AME estimate converges with the ANCOVA estimate using the centered baseline covariate in this example. But what if we had a different random sample? Interestingly, this particular random sample shows no evidence of effect heterogeneity, even though random sampling variation led to such an artifact in simulation #2 with the larger samples (n=1,000 per group). As you might know, with small samples, we should expect a great deal of sampling variation and, as such, noisy estimates that jump around a lot. To some degree, the wider intervals in the ANOVA and ANCOVA at minimum and maximum baseline covariate values communicates this greater uncertainty. But what about the ANCOVA estimate at centered baseline weight or the AME - do these sufficiently convey uncertainty inherent in estimating from small samples?</p>
<p>To probe this intuition, let’s change the random seed to draw a couple new samples and then generate the same plot. I started with “1138,” which is one of my <a href="https://en.wikipedia.org/wiki/1138_(number)">favorite nerdy random seeds</a>. Let’s just add one, add two, and subtract one to the random seed and see what happens.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Illustrate sample mean differences for two independent population groups </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>nval <span class="ot">&lt;-</span> <span class="dv">44</span> <span class="co">#treat</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>ngrp <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1139 </span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1139</span>) </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co">#sim two pre-treatment columns (groups) of rnorm values with "nval" size </span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>pretrt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanpret, <span class="at">sd=</span>sdpret) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>precon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanprec, <span class="at">sd=</span>sdprec) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pretrt, precon)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">sn =</span> <span class="dv">1</span><span class="sc">:</span>nval, </span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="fu">c</span>(ngrp, ngrp)))) <span class="sc">%&gt;%</span> </span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"experimental"</span>, <span class="st">"control"</span>)),</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">experimental =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"experimental"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>         )  </span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(simdata, pre)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> simdata <span class="sc">%&gt;%</span> </span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">post =</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fl">4.57</span><span class="sc">*</span>experimental <span class="sc">+</span> <span class="fu">rnorm_pre</span>(pre, <span class="at">mu =</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>post), <span class="at">sd =</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>post), <span class="at">r =</span> <span class="fl">0.95</span>), <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec =</span> pre <span class="sc">-</span> <span class="fu">mean</span>(pre), </span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">premin =</span> pre <span class="sc">-</span> <span class="fu">min</span>(pre), </span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">premax =</span> pre <span class="sc">-</span> <span class="fu">max</span>(pre)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA (OLS)</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>simols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ANCOVA (OLS) with interaction to capture any effect heterogeneity  </span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>simols4min <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premin <span class="sc">+</span> experimental<span class="sc">*</span>premin</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>simols4c <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec</span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>simols4max <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premax <span class="sc">+</span> experimental<span class="sc">*</span>premax</span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">lm</span>(post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec, <span class="at">data =</span> simdata)</span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>amecoef2 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(x, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>)</span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>plot22_1139 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(simols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a>          amecoef2) <span class="sc">%&gt;%</span></span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>), </span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist]))) <span class="sc">+</span></span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sim #3, seed=1139"</span>) </span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a><span class="co"># 1140</span></span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1140</span>) </span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-81"><a href="#cb74-81" aria-hidden="true" tabindex="-1"></a><span class="co">#sim two pre-treatment columns (groups) of rnorm values with "nval" size </span></span>
<span id="cb74-82"><a href="#cb74-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a>pretrt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanpret, <span class="at">sd=</span>sdpret) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>precon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanprec, <span class="at">sd=</span>sdprec) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pretrt, precon)</span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">sn =</span> <span class="dv">1</span><span class="sc">:</span>nval, </span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="fu">c</span>(ngrp, ngrp)))) <span class="sc">%&gt;%</span> </span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"experimental"</span>, <span class="st">"control"</span>)),</span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a>         <span class="at">experimental =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"experimental"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a>         )  </span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(simdata, pre)</span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> simdata <span class="sc">%&gt;%</span> </span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">post =</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fl">4.57</span><span class="sc">*</span>experimental <span class="sc">+</span> <span class="fu">rnorm_pre</span>(pre, <span class="at">mu =</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>post), <span class="at">sd =</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>post), <span class="at">r =</span> <span class="fl">0.95</span>), <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb74-99"><a href="#cb74-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec =</span> pre <span class="sc">-</span> <span class="fu">mean</span>(pre), </span>
<span id="cb74-100"><a href="#cb74-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">premin =</span> pre <span class="sc">-</span> <span class="fu">min</span>(pre), </span>
<span id="cb74-101"><a href="#cb74-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">premax =</span> pre <span class="sc">-</span> <span class="fu">max</span>(pre)</span>
<span id="cb74-102"><a href="#cb74-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA (OLS)</span></span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a>simols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-107"><a href="#cb74-107" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental</span>
<span id="cb74-108"><a href="#cb74-108" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a><span class="co"># ANCOVA (OLS) with interaction to capture any effect heterogeneity  </span></span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a>simols4min <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-112"><a href="#cb74-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-113"><a href="#cb74-113" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premin <span class="sc">+</span> experimental<span class="sc">*</span>premin</span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a>simols4c <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-117"><a href="#cb74-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-118"><a href="#cb74-118" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec</span>
<span id="cb74-119"><a href="#cb74-119" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-120"><a href="#cb74-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-121"><a href="#cb74-121" aria-hidden="true" tabindex="-1"></a>simols4max <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-122"><a href="#cb74-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-123"><a href="#cb74-123" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premax <span class="sc">+</span> experimental<span class="sc">*</span>premax</span>
<span id="cb74-124"><a href="#cb74-124" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-125"><a href="#cb74-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-126"><a href="#cb74-126" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">lm</span>(post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec, <span class="at">data =</span> simdata)</span>
<span id="cb74-127"><a href="#cb74-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-128"><a href="#cb74-128" aria-hidden="true" tabindex="-1"></a>amecoef3 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(x, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>)</span>
<span id="cb74-129"><a href="#cb74-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-130"><a href="#cb74-130" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb74-131"><a href="#cb74-131" aria-hidden="true" tabindex="-1"></a>plot22_1140 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb74-132"><a href="#cb74-132" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(simols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb74-133"><a href="#cb74-133" aria-hidden="true" tabindex="-1"></a>          amecoef3) <span class="sc">%&gt;%</span></span>
<span id="cb74-134"><a href="#cb74-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb74-135"><a href="#cb74-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb74-136"><a href="#cb74-136" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>), </span>
<span id="cb74-137"><a href="#cb74-137" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb74-138"><a href="#cb74-138" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb74-139"><a href="#cb74-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-140"><a href="#cb74-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb74-141"><a href="#cb74-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb74-142"><a href="#cb74-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb74-143"><a href="#cb74-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb74-144"><a href="#cb74-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist]))) <span class="sc">+</span></span>
<span id="cb74-145"><a href="#cb74-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb74-146"><a href="#cb74-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb74-147"><a href="#cb74-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sim #3, seed=1140"</span>) </span>
<span id="cb74-148"><a href="#cb74-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-149"><a href="#cb74-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-150"><a href="#cb74-150" aria-hidden="true" tabindex="-1"></a><span class="co"># 1137</span></span>
<span id="cb74-151"><a href="#cb74-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-152"><a href="#cb74-152" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1137</span>) </span>
<span id="cb74-153"><a href="#cb74-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-154"><a href="#cb74-154" aria-hidden="true" tabindex="-1"></a><span class="co">#sim two pre-treatment columns (groups) of rnorm values with "nval" size </span></span>
<span id="cb74-155"><a href="#cb74-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-156"><a href="#cb74-156" aria-hidden="true" tabindex="-1"></a>pretrt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanpret, <span class="at">sd=</span>sdpret) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb74-157"><a href="#cb74-157" aria-hidden="true" tabindex="-1"></a>precon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nval, <span class="at">mean=</span>meanprec, <span class="at">sd=</span>sdprec) <span class="sc">%&gt;%</span> <span class="fu">as_tibble_col</span>(<span class="at">column_name =</span> <span class="st">"pre"</span>)</span>
<span id="cb74-158"><a href="#cb74-158" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pretrt, precon)</span>
<span id="cb74-159"><a href="#cb74-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-160"><a href="#cb74-160" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb74-161"><a href="#cb74-161" aria-hidden="true" tabindex="-1"></a>  <span class="at">sn =</span> <span class="dv">1</span><span class="sc">:</span>nval, </span>
<span id="cb74-162"><a href="#cb74-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">times =</span> <span class="fu">c</span>(ngrp, ngrp)))) <span class="sc">%&gt;%</span> </span>
<span id="cb74-163"><a href="#cb74-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"experimental"</span>, <span class="st">"control"</span>)),</span>
<span id="cb74-164"><a href="#cb74-164" aria-hidden="true" tabindex="-1"></a>         <span class="at">experimental =</span> <span class="fu">ifelse</span>(treatment <span class="sc">==</span> <span class="st">"experimental"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb74-165"><a href="#cb74-165" aria-hidden="true" tabindex="-1"></a>         )  </span>
<span id="cb74-166"><a href="#cb74-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-167"><a href="#cb74-167" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(simdata, pre)</span>
<span id="cb74-168"><a href="#cb74-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-169"><a href="#cb74-169" aria-hidden="true" tabindex="-1"></a>simdata <span class="ot">&lt;-</span> simdata <span class="sc">%&gt;%</span> </span>
<span id="cb74-170"><a href="#cb74-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-171"><a href="#cb74-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">post =</span> <span class="fu">round</span>(<span class="sc">-</span><span class="fl">4.57</span><span class="sc">*</span>experimental <span class="sc">+</span> <span class="fu">rnorm_pre</span>(pre, <span class="at">mu =</span> <span class="fu">mean</span>(horan1971<span class="sc">$</span>post), <span class="at">sd =</span> <span class="fu">sd</span>(horan1971<span class="sc">$</span>post), <span class="at">r =</span> <span class="fl">0.95</span>), <span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb74-172"><a href="#cb74-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">prec =</span> pre <span class="sc">-</span> <span class="fu">mean</span>(pre), </span>
<span id="cb74-173"><a href="#cb74-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">premin =</span> pre <span class="sc">-</span> <span class="fu">min</span>(pre), </span>
<span id="cb74-174"><a href="#cb74-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">premax =</span> pre <span class="sc">-</span> <span class="fu">max</span>(pre)</span>
<span id="cb74-175"><a href="#cb74-175" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-176"><a href="#cb74-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-177"><a href="#cb74-177" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA (OLS)</span></span>
<span id="cb74-178"><a href="#cb74-178" aria-hidden="true" tabindex="-1"></a>simols1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-179"><a href="#cb74-179" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-180"><a href="#cb74-180" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental</span>
<span id="cb74-181"><a href="#cb74-181" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-182"><a href="#cb74-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-183"><a href="#cb74-183" aria-hidden="true" tabindex="-1"></a><span class="co"># ANCOVA (OLS) with interaction to capture any effect heterogeneity  </span></span>
<span id="cb74-184"><a href="#cb74-184" aria-hidden="true" tabindex="-1"></a>simols4min <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-185"><a href="#cb74-185" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-186"><a href="#cb74-186" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premin <span class="sc">+</span> experimental<span class="sc">*</span>premin</span>
<span id="cb74-187"><a href="#cb74-187" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-188"><a href="#cb74-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-189"><a href="#cb74-189" aria-hidden="true" tabindex="-1"></a>simols4c <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-190"><a href="#cb74-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-191"><a href="#cb74-191" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec</span>
<span id="cb74-192"><a href="#cb74-192" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-193"><a href="#cb74-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-194"><a href="#cb74-194" aria-hidden="true" tabindex="-1"></a>simols4max <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb74-195"><a href="#cb74-195" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdata,</span>
<span id="cb74-196"><a href="#cb74-196" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> premax <span class="sc">+</span> experimental<span class="sc">*</span>premax</span>
<span id="cb74-197"><a href="#cb74-197" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-198"><a href="#cb74-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-199"><a href="#cb74-199" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">lm</span>(post <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> experimental <span class="sc">+</span> prec <span class="sc">+</span> experimental<span class="sc">*</span>prec, <span class="at">data =</span> simdata)</span>
<span id="cb74-200"><a href="#cb74-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-201"><a href="#cb74-201" aria-hidden="true" tabindex="-1"></a>amecoef4 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(x, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>)</span>
<span id="cb74-202"><a href="#cb74-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-203"><a href="#cb74-203" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb74-204"><a href="#cb74-204" aria-hidden="true" tabindex="-1"></a>plot22_1137 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">tidy</span>(simols1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4min, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb74-205"><a href="#cb74-205" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tidy</span>(simols4c, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), <span class="fu">tidy</span>(simols4max, <span class="at">conf.int =</span> <span class="cn">TRUE</span>), </span>
<span id="cb74-206"><a href="#cb74-206" aria-hidden="true" tabindex="-1"></a>          amecoef4) <span class="sc">%&gt;%</span></span>
<span id="cb74-207"><a href="#cb74-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"experimental"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-208"><a href="#cb74-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb74-209"><a href="#cb74-209" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>), </span>
<span id="cb74-210"><a href="#cb74-210" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ANOVA"</span>, <span class="st">"ANCOVA_Ypremin"</span>, <span class="st">"ANCOVA_Yprec"</span>, </span>
<span id="cb74-211"><a href="#cb74-211" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"ANCOVA_Ypremax"</span>, <span class="st">"AME_treatment"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb74-212"><a href="#cb74-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-213"><a href="#cb74-213" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb74-214"><a href="#cb74-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb74-215"><a href="#cb74-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb74-216"><a href="#cb74-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb74-217"><a href="#cb74-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist]))) <span class="sc">+</span></span>
<span id="cb74-218"><a href="#cb74-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb74-219"><a href="#cb74-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb74-220"><a href="#cb74-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sim #3, seed=1137"</span>) </span>
<span id="cb74-221"><a href="#cb74-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-222"><a href="#cb74-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-223"><a href="#cb74-223" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb74-224"><a href="#cb74-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-225"><a href="#cb74-225" aria-hidden="true" tabindex="-1"></a>(plot22_1137 <span class="sc">+</span> plot22_1138) <span class="sc">/</span> (plot22_1139 <span class="sc">+</span> plot22_1140)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Oh my - look at the differences across these plots! This is what happens when we use really small samples - our samples and sample-based estimates are noisy and unreliable. If we were interested in effect heterogeneity, such as differences in the experimental treatment effect for people with different baseline pre-treatment weights, then we would likely draw completely different inferences from each of these samples!</p>
<p>Also, note how the ANOVA estimate jumps around a lot. By now, this should be unsurprising. After all, recall the unconditional ANOVA estimate is summarizing post-treatment group differences from all causes, including from highly variable sample-dependent group differences in baseline weight and treatment effects. Moreover, this is compounded by the fact that ANOVA’s mean-based estimate is sensitive to another problem with small samples: their distributions often fail to adequately reflect the underlying population distributions from which they were drawn. Graefe and colleagues, <a href="file:///C:/Users/Jon/Downloads/GraefeHahnMayer2022.pdf">in their paper referenced earlier</a>, warn about relying on ANOVA to estimate an average treatment effect (ATE):</p>
<blockquote class="blockquote">
<p>“For the ATE being a meaningful effect, however, a representative sample or knowledge of the distribution of the covariate is essential. If the distribution of the covariate in the sample does not reflect the distribution in the population of interest, all approaches may result in incorrect estimations of ATEs and the computed average treatment effects themselves do not represent average causal effects but arbitrary computed differences between means. In this case, conditional treatment effects can and should be interpreted.”</p>
</blockquote>
<p>Likewise, note that the ANCOVA with a centered baseline covariate and the AME estimates are relatively more stable across these plots. Let’s extract the AME estimates and plot them together so we can more easily compare them.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(amecoef, amecoef2, amecoef3, amecoef4) <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"AME_1138"</span>, <span class="st">"AME_1139"</span>, <span class="st">"AME_1140"</span>, <span class="st">"AME_1137"</span>), </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"AME_1138"</span>, <span class="st">"AME_1139"</span>, <span class="st">"AME_1140"</span>, <span class="st">"AME_1137"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high, <span class="at">y =</span> model)) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(beta[<span class="dv">1</span>]<span class="sc">~</span>(mu[experimental]<span class="sc">-</span>mu[waitlist]))) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Sim #3, AMEs by random seed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Kurz_power_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These findings corroborate the quote above and confirm Kurz’s advice that “…if you have a high-quality baseline covariate laying around, it’s a good idea to throw it into the model.”</p>
<p>The reason, though, really is not because you can expect ANCOVA to improve the statistical power of your test. To be clear, you might expect a derived estimated of the statistical power of an ANCOVA-based test of a null hypothesis to be greater than the power estimate derived for an ANOVA-based test of a null hypothesis that was motivated by the same substantive question. However, at this point, it should be clear that the ANOVA and ANCOVA models might be generating fundamentally different estimates or “tests,” depending on your data and the causal and design processes that generated them. Rather, if you care about estimating the causal effect of a (randomized) experimental treatment, then what really matters is that you fit a model that adequately specifies the underlying causal structure that generated the data and that you stratify on or adjust for alternative (non-treatment) causes of post-treatment differences if any exist. Inclusion of baseline differences - or other approaches to analyzing within-unit change - can help in this regard by serving as a proxy to adjust for other unobserved causal processes that might generate observed differences in post-treatment outcomes above and beyond the experimental treatment effect of interest.</p>
<p>In short, count me as a skeptic of power-based arguments for selecting any particular model or determining covariate inclusion and, instead, as a believer that there is still no such thing as a free (power) lunch.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div quarto-reuse="quarto-reuse" class="quarto-appendix-contents"><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer2023,
  author = {Jon Brauer},
  title = {Thoughts on {Kurz’s} Blog Re:power},
  date = {2023-04-15},
  url = {https://www.reluctantcriminologists.com/Kurz_power.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer2023" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Jon Brauer. 2023. <span>“Thoughts on Kurz’s Blog Re:power.”</span> April
15, 2023. <a href="https://www.reluctantcriminologists.com/Kurz_power.html">https://www.reluctantcriminologists.com/Kurz_power.html</a>.
</div></div></section></div></main> <!-- /main -->

<div>
<hr>

<p> questions? feedback? want to connect? </p>

<table width="100%" cellspacing="0" cellpadding="0">
  <tbody><tr>
      <td>
          <table cellspacing="0" cellpadding="0">
              <tbody><tr>
                  <td style="border-radius: 2px;" bgcolor="#93c54b">
                      <a href="mailto:reluctantcrim@gmail.com" target="_blank" style="padding: 8px 12px; border: 1px solid #93c54b;border-radius: 2px;font-family: Helvetica, Arial, sans-serif;font-size: 14px; color: #ffffff;text-decoration: none;font-weight:bold;display: inline-block;">
                          send us an email             
                      </a>
                  </td>
              </tr>
          </tbody></table>
      </td>
  </tr>
</tbody></table>

<hr>
</div>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="jakeday4/reluctantcrim_comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://reluctantcriminologists.com/">
      <i class="bi bi-house-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:reluctantcrim@gmail.com">
      <i class="bi bi-envelope-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jakeday4/reluctantcrim_website">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/reluctantcrim">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>