<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Kansas City Community Survey - 12&nbsp; Appendix III - Research Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11_kc_comsurvey_appendix4-power.html" rel="next">
<link href="./9_kc_comsurvey_appendix2-neighborhood-data-clean.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10_kc_comsurvey_appendix3-design.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Appendix III - Research Design</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Kansas City Community Survey</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Kansas City Community Survey</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_kc_comsurvey_exec-summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Executive Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_kc_comsurvey_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_kc_comsurvey_duplicates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Quality Assessment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_kc_comsurvey_collective-efficacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Measuring Collective Efficacy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_kc_comsurvey_map-collective-efficacy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mapping Collective Efficacy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_kc_comsurvey_resident-survey-comp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Annual Resident Survey Comparison</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_kc_comsurvey_conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_kc_comsurvey_appendix1-survey-data-clean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Appendix I - Cleaning &amp; Wrangling the Survey Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_kc_comsurvey_appendix2-neighborhood-data-clean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Appendix II - Cleaning &amp; Wrangling the Neighborhood Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_kc_comsurvey_appendix3-design.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Appendix III - Research Design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_kc_comsurvey_appendix4-power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Appendix IV - Power Analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-app3" id="toc-sec-app3" class="nav-link active" data-scroll-target="#sec-app3"><span class="header-section-number">12.1</span> Introduction</a></li>
  <li><a href="#planned-research-design" id="toc-planned-research-design" class="nav-link" data-scroll-target="#planned-research-design"><span class="header-section-number">12.2</span> Planned research design</a></li>
  <li><a href="#random-sampling-interviewer-starting-points" id="toc-random-sampling-interviewer-starting-points" class="nav-link" data-scroll-target="#random-sampling-interviewer-starting-points"><span class="header-section-number">12.3</span> Random Sampling Interviewer Starting Points”</a>
  <ul class="collapse">
  <li><a href="#load-libraries-data" id="toc-load-libraries-data" class="nav-link" data-scroll-target="#load-libraries-data"><span class="header-section-number">12.3.1</span> Load libraries &amp; data</a></li>
  <li><a href="#sample-8-sp-per-neighborhood" id="toc-sample-8-sp-per-neighborhood" class="nav-link" data-scroll-target="#sample-8-sp-per-neighborhood"><span class="header-section-number">12.3.2</span> Sample 8 SP per Neighborhood</a></li>
  <li><a href="#sample-13-sp-per-neighborhood-4-original-9-reserve" id="toc-sample-13-sp-per-neighborhood-4-original-9-reserve" class="nav-link" data-scroll-target="#sample-13-sp-per-neighborhood-4-original-9-reserve"><span class="header-section-number">12.3.3</span> Sample 13 SP per Neighborhood (4 original + 9 reserve)</a></li>
  <li><a href="#slice-main-sp-first-4-primary-reserve-sp-next-4-and-secondary-reserve-last-5-per-neighborhood" id="toc-slice-main-sp-first-4-primary-reserve-sp-next-4-and-secondary-reserve-last-5-per-neighborhood" class="nav-link" data-scroll-target="#slice-main-sp-first-4-primary-reserve-sp-next-4-and-secondary-reserve-last-5-per-neighborhood"><span class="header-section-number">12.3.4</span> Slice Main SP (first 4), Primary Reserve SP (next 4), and Secondary Reserve (last 5) per Neighborhood</a></li>
  <li><a href="#save-to-excel-files" id="toc-save-to-excel-files" class="nav-link" data-scroll-target="#save-to-excel-files"><span class="header-section-number">12.3.5</span> Save to Excel files</a></li>
  <li><a href="#backup-neighborhood-selection" id="toc-backup-neighborhood-selection" class="nav-link" data-scroll-target="#backup-neighborhood-selection"><span class="header-section-number">12.3.6</span> Backup Neighborhood Selection</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Appendix III - Research Design</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-app3" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sec-app3"><span class="header-section-number">12.1</span> Introduction</h2>
<p>The following summarizes our understanding of KC Community Survey’s research design (per exchange from September 17, 2024):</p>
</section>
<section id="planned-research-design" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="planned-research-design"><span class="header-section-number">12.2</span> Planned research design</h2>
<p>The KC Community Surveyed conducted computer-assisted personal interviews (on tablets) with adults identified using stratified probability sampling of urban households in Kansas City, Missouri (KCMO). A two-stage stratified probability sampling procedure with stratified random oversampling was used to randomly select households in neighborhoods representing the general population living in each of the six KCMO administrative districts while also ensuring sufficient sampling coverage of households in neighborhoods identified as likely targets of crime-reduction initiatives.</p>
<p>The P.I. initially secured funding for a sample size of n=800 respondents age 18 and older. Since the results of the Census of population, households and dwellings in KC from 2020 show that there are 508,090 persons registered in KC metro, of which 400,050 are age 18 and older. Considering the specified sample size, the sample error, with confidence level of 95%, was estimated to be ±3.46% ( <em>p</em>≤0.05).</p>
<ol type="1">
<li>Council districts represented the first level of stratification (total of 6 districts)</li>
</ol>
<ul>
<li>5 randomly selected NH per each district (5 NH * 6 districts = 30 randomly selected NH)</li>
</ul>
<ol start="2" type="1">
<li>Neighborhood represented the second level of stratification (40 out of a total of 240 neighborhoods)</li>
</ol>
<ul>
<li>30 randomly selected NH (6 per district)</li>
<li>10 strategically selected NH to oversample “high risk” NH with 10 highest violent crime rates as of the most recent official data from KC police, as these NH are places where anti-crime interventions are most likely to be implemented</li>
</ul>
<ol start="3" type="1">
<li>In each NH, 1 adult per household (HH) from 10 HH around 2 random starting points per NH were selected for interview (1 adult * 10 HH * 2 SP per NH = 20 adults per NH; 800 adults total)</li>
</ol>
<p>Generalizability of the sample was maximized via random selection of starting points, random selection of households within cluster, and random selection of the household member selected for interview.</p>
<p>To conduct the survey, for each district the necessary number of starting points (two per neighborhood) were randomly selected from the total base of starting points (neighborhoods), using the Statistical Package for the Social Sciences version 21 (SPSS 21). At any selected starting point, no more than ten (10) surveys were permitted to be completed. In addition, additional substitute random starting points were selected as well so that, during fieldwork, when a need arised for additional starting points or to alter some of them (e.g., inaccessible; non-residential; etc.), a pre-determined principled probability sampling approach would be used.</p>
<p>In each of the areas covered by the randomly chosen starting point, households in which surveys were conducted were selected using a pre-determined Random Walk Technique (e.g., see <a href="https://www.mignex.org/news/new-mignex-resource-random-walk-sampling">here</a>), which was aided and simplified using pre-specified random walking routes displayed for interviewers using mapping software on an assigned interviewer tablet. This classical method was used due to insufficient proper lists of residents, which, given their consistent use and non-systematic biases in survey non-participation, should have enabled the researchers to meet their desired goal of sample representativeness.</p>
<p>Where necessary, the selected starting or interview points, interviewers were instructed to make selections using the “right hand rule”. For example, when interviewers arrived at the address noted, they would turn facing away from the starting point and move to her/his right. The first household the interviewers encountered would have represented the household where first survey should be attempted to be conducted. The interviewers were then instructed to continue to move in the same direction and on the same side of the street, and using the principle of selecting every third address, further selecting households where surveying would be conducted, all until the anticipated number of surveys for that starting point were complete.</p>
<p>In each of the households, the selection of respondents was performed by applying the Last Birthday Technique, which should have ensured a random selection of respondents within a household. Therefore, the household member older than 18 years of age who had most recently had a birthday, that is, the household member whose birth date is the closest to the date of contact was selected for invitation to be surveyed. If the person who had last had a birthday was absent (or for other non-contact reasons, e.g., no answer), the interviewer was instructed to arrange a different time for interviewing and/or a member of the research team would return to that household, before conducting the survey with another respondent from another household.</p>
<p>Due to various implementation challenges (e.g., community-engaged volunteering and training hurdles; lower than expected response rates; longer than expected survey administration time), some deviations occurred (e.g., supplemented online administration option at end in effort to increase participation rates for those lacking time for in-person interview), and the final “total” and “per-neighborhood” sample sizes were significantly smaller (e.g., approximately n=386 surveys; see report analysis sections for more details). The project P.I. (Dr.&nbsp;Marijana Kotlaja) would know more about specific design and implementation details or deviations.</p>
</section>
<section id="random-sampling-interviewer-starting-points" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="random-sampling-interviewer-starting-points"><span class="header-section-number">12.3</span> Random Sampling Interviewer Starting Points”</h2>
<p>Below is the code used to randomly sample starting points for each of the 40 sampled neighborhoods (provided to Dr.&nbsp;Kotlaja on September 24, 2024).</p>
<p>In this file, we start by using a population registry of addresses within 40 previously selected neighborhoods to sample 8 “starting points” (SP) each. The first 4 SP will be the addresses that interviewers will begin attempting to interview residents and from which they will systematically move to new potential addresses. The remaining 4 SP will be reserve SP to be used in the event that interview quotas (5 per SP) are not met in an initially selected SP. We later sampled 5 additional backup SPs per neighborhood (for 13 total) to be used if the first 8 selected were exhausted or otherwise unusable.</p>
<p>Though we share the code, to retain confidentiality, it is commented out or not evaluated and the corresponding randomly selected SP address file is not included.</p>
<p>After this, we sampled one additional neighborhood (NH) to replace an originally selected NH (due to lack of responses or valid residencies).</p>
<section id="load-libraries-data" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="load-libraries-data"><span class="header-section-number">12.3.1</span> Load libraries &amp; data</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># spdata &lt;- read_excel("study_addresses.xls")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># spdata</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sample-8-sp-per-neighborhood" class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="sample-8-sp-per-neighborhood"><span class="header-section-number">12.3.2</span> Sample 8 SP per Neighborhood</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1138</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>spsamp <span class="ot">&lt;-</span> spdata <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(KCMO_NeighborhoodsCensus.NBHID) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">8</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>spsamp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Some of these starting points are unusable (e.g., building address demolished). In addition to four reserve SPs per NH, sampling five additional reserve SPs per NH.</p>
</section>
<section id="sample-13-sp-per-neighborhood-4-original-9-reserve" class="level3" data-number="12.3.3">
<h3 data-number="12.3.3" class="anchored" data-anchor-id="sample-13-sp-per-neighborhood-4-original-9-reserve"><span class="header-section-number">12.3.3</span> Sample 13 SP per Neighborhood (4 original + 9 reserve)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1138</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>spsamp <span class="ot">&lt;-</span> spdata <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(KCMO_NeighborhoodsCensus.NBHID) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">13</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>spsamp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="slice-main-sp-first-4-primary-reserve-sp-next-4-and-secondary-reserve-last-5-per-neighborhood" class="level3" data-number="12.3.4">
<h3 data-number="12.3.4" class="anchored" data-anchor-id="slice-main-sp-first-4-primary-reserve-sp-next-4-and-secondary-reserve-last-5-per-neighborhood"><span class="header-section-number">12.3.4</span> Slice Main SP (first 4), Primary Reserve SP (next 4), and Secondary Reserve (last 5) per Neighborhood</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sptop8 <span class="ot">&lt;-</span> spsamp <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(KCMO_NeighborhoodsCensus.NBHID) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">8</span>) </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>spmain <span class="ot">&lt;-</span> sptop8 <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(KCMO_NeighborhoodsCensus.NBHID) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">4</span>) </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>spmain</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>spreserve <span class="ot">&lt;-</span> sptop8 <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(KCMO_NeighborhoodsCensus.NBHID) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n=</span><span class="dv">4</span>) </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>spreserve</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>spreserve2 <span class="ot">&lt;-</span> spsamp <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(KCMO_NeighborhoodsCensus.NBHID) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>spreserve2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="save-to-excel-files" class="level3" data-number="12.3.5">
<h3 data-number="12.3.5" class="anchored" data-anchor-id="save-to-excel-files"><span class="header-section-number">12.3.5</span> Save to Excel files</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(spmain, "spmain.csv")</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(spreserve, "spreserve.csv")</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(spreserve2, "spreserve2.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="backup-neighborhood-selection" class="level3" data-number="12.3.6">
<h3 data-number="12.3.6" class="anchored" data-anchor-id="backup-neighborhood-selection"><span class="header-section-number">12.3.6</span> Backup Neighborhood Selection</h3>
<section id="initial-nh-sample" class="level4" data-number="12.3.6.1">
<h4 data-number="12.3.6.1" class="anchored" data-anchor-id="initial-nh-sample"><span class="header-section-number">12.3.6.1</span> Initial NH sample</h4>
<p>Dr.&nbsp;Kotlaja’s team selected the initial sample of 40 neighborhoods. 30 NHs were selected via stratifed random sampling using a city administrative list of NH names as the sampling frame. Three NHs were eliminated from the sampling frame due to identification as industrial districts. After stratified random sampling of 30 NHs, another 10 NHs were strategically selected for inclusion as potential targets of violent crime initiatives by starting at the top of a list of NHs with the highest reported violent crime rates in 2023 and selecting the first 10 that were not already included in the stratified random sample of 30 NHs.</p>
<p>The following 30 NHs were selected via stratified random sampling of 5 NHs within each of 6 council districts. (Notes provided by NH association members about perceived issues with city NH names are included in parentheses.)</p>
<p>Council District 1</p>
<ol type="1">
<li>Prairie Point-Wildberry</li>
<li>New Mark</li>
<li>Shoal Creek</li>
<li>Gashland</li>
<li>Outer Gashland-Nashua</li>
</ol>
<p>Council District 2</p>
<ol type="1">
<li>Barry Harbour</li>
<li>The Coves</li>
<li>Ravenwood-Somerset</li>
<li>Maple Park</li>
<li>Winnwood Gardens</li>
</ol>
<p>Council District 3</p>
<ol type="1">
<li>Lykins</li>
<li>Longfellow</li>
<li>Palestine East (Oak Park is in Here)</li>
<li>Blue Valley</li>
<li>Oak Park</li>
</ol>
<p>Council District 4</p>
<ol type="1">
<li>North Hyde Park</li>
<li>Southmoreland</li>
<li>River Market</li>
<li>Davidson</li>
<li>Rockhill</li>
</ol>
<p>Council District 5</p>
<ol type="1">
<li>Ruskin Heights</li>
<li>East Meyer 6 (broken out into smaller segments- Neighbors United Together, East Meyer Cluster, East Meyer 6 vs.&nbsp;Fox Town East &amp; West).</li>
<li>Brown Estates</li>
<li>Little Blue</li>
<li>Hickman Mills South</li>
</ol>
<p>Council District 6</p>
<ol type="1">
<li>Tower Homes</li>
<li>Linden Hills And Indian Heights</li>
<li>Waldo Homes</li>
<li>Morningside</li>
<li>Richards Gebaur</li>
</ol>
<p>The following 10 NHs were strategically selected based on high violent crime rates:<br>
Paseo West Cunningham Ridge Key Coalition Ivanhoe Northeast + Southeast Dunbar (Heart of the City) Old Westport Mount Hope (Boston Heights/Mount Hope)<br>
Ivanhoe Southeast East Swope Highlands Blenheim Square Research (Tri-Blenheim)</p>
<p>Excluded: Blue Valley Industrial, Northeast Industrial District, and Hospital Hill.</p>
<p>Community-Engaged Interview Targets: 40 surveys per expert interviewer with 6 total (240 Interviews) 10 surveys min per 30 community members = 300 minimum (560 Interviews)</p>
</section>
<section id="nh-replacement" class="level4" data-number="12.3.6.2">
<h4 data-number="12.3.6.2" class="anchored" data-anchor-id="nh-replacement"><span class="header-section-number">12.3.6.2</span> NH replacement</h4>
<p>After a couple days of interviewing, Dr.&nbsp;Kotlaja’s team indicated a need to replace the following two NHs due to lack of responses and/or valid residencies:</p>
<p>Cunningham Ridge (District ?) Rockhill (District 4)</p>
<p>Cunningham Ridge was a strategically sampled NH. Dr.&nbsp;Kotlaja’s team replaced it with Oak Park Southwest, which was the next NH on the list of high violent crime rates.</p>
<p>Rockhill was selected via stratified random sampling as one of the original 5 NHs in District 4. Dr.&nbsp;Kotlaja asked us to randomly sample a backup neighborhood from District 4 to replace it.</p>
</section>
<section id="read-in-data" class="level4" data-number="12.3.6.3">
<h4 data-number="12.3.6.3" class="anchored" data-anchor-id="read-in-data"><span class="header-section-number">12.3.6.3</span> Read in Data</h4>
<p>Let’s read in a datafile containing all the KC neighborhoods.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nhdata <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"KC_NHs.xlsx"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nhdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 239 × 3
   NBHID BlockGroup               DistrictOrdinal
   &lt;dbl&gt; &lt;chr&gt;                              &lt;dbl&gt;
 1     0 KC Zoo-Swope Park                      5
 2     1 Columbus Park Industrial               4
 3     2 River Market                           4
 4     3 Quality Hill                           4
 5     4 CBD Downtown                           3
 6     5 Paseo West                             5
 7     6 Hospital Hill                          4
 8     7 Crossroads                             4
 9     8 Westside North                         4
10     9 Westside South                         4
# ℹ 229 more rows</code></pre>
</div>
</div>
<p>Now we need to randomly select another neighborhood from District 4 to replace Rockhill.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter to keep only 34 NHs in District 4</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>nhdist4 <span class="ot">&lt;-</span> nhdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(DistrictOrdinal <span class="sc">==</span> <span class="dv">4</span>) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove 5 previously selected NHs  </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>nhdist4 <span class="ot">&lt;-</span> <span class="fu">subset</span>(nhdist4, <span class="sc">!</span>(BlockGroup <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"North Hyde Park"</span>, <span class="st">"Southmoreland"</span>, <span class="st">"River Market"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"Davidson"</span>, <span class="st">"Rockhill"</span>)))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1138</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly select NH in District 4 to replace Rockhill </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>nhdist4sub <span class="ot">&lt;-</span> nhdist4 <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>nhdist4sub</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  NBHID BlockGroup DistrictOrdinal
  &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;
1    11 Union Hill               4</code></pre>
</div>
</div>
<p>The replacement NH for District 4 is Union Hill.</p>
<p>Now that we have randomly sampled the replacement NH, we will need to randomly sample 4 primary starting points (SPs) and 9 backup SPs for Union Hill and Oak Park Southwest (the strategic sample replacement).</p>
</section>
<section id="address-data" class="level4" data-number="12.3.6.4">
<h4 data-number="12.3.6.4" class="anchored" data-anchor-id="address-data"><span class="header-section-number">12.3.6.4</span> Address data</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>addsubdata <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Addresses_Update Union Hill and Oak Park Southwest.xlsx"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>addsubdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="sample-13-sp-per-substitute-nh-4-original-9-reserve" class="level4" data-number="12.3.6.5">
<h4 data-number="12.3.6.5" class="anchored" data-anchor-id="sample-13-sp-per-substitute-nh-4-original-9-reserve"><span class="header-section-number">12.3.6.5</span> Sample 13 SP per Substitute NH (4 original + 9 reserve)</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1138</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>spsubsamp <span class="ot">&lt;-</span> addsubdata <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(KCMO_NeighborhoodsCensus.NBHID) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">13</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>spsubsamp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="save-to-excel-file" class="level4" data-number="12.3.6.6">
<h4 data-number="12.3.6.6" class="anchored" data-anchor-id="save-to-excel-file"><span class="header-section-number">12.3.6.6</span> Save to Excel file</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write_csv(spsubsamp, "spsubsamp.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-brauer_pursuing_2025" class="csl-entry" role="listitem">
Brauer, Jonathan, and Jacob Day. 2025. <span>“Pursuing <span>Precision</span> in <span>Criminology</span>: <span>Why</span> <span>Ordinal</span> <span>Data</span> <span>Demand</span> <span>Ordinal</span> <span>Methods</span>.”</span> OSF. <a href="https://doi.org/10.31235/osf.io/fet4d_v1">https://doi.org/10.31235/osf.io/fet4d_v1</a>.
</div>
<div id="ref-day_trust_2023" class="csl-entry" role="listitem">
Day, Jake, Jon Brauer, and Maja Kotlaja. 2023. <span>“Trust <span>Issues</span>: <span>Examining</span> <span>Near</span> <span>Duplicates</span> in <span>Survey</span> <span>Data</span>.”</span> <a href="https://reluctantcriminologists.com/blog-posts/%5B8%5D/dup-series/duplicates">https://reluctantcriminologists.com/blog-posts/%5B8%5D/dup-series/duplicates</a>.
</div>
<div id="ref-kuriakose_dont_2015" class="csl-entry" role="listitem">
Kuriakose, Noble, and Michael Robbins. 2015. <span>“Don’t <span>Get</span> <span>Duped</span>: <span>Fraud</span> Through <span>Duplication</span> in <span>Public</span> <span>Opinion</span> <span>Surveys</span>.”</span> {SSRN} {Scholarly} {Paper}. Rochester, NY: Social Science Research Network. <a href="https://papers.ssrn.com/abstract=2580502">https://papers.ssrn.com/abstract=2580502</a>.
</div>
<div id="ref-revelle_seductive_2024" class="csl-entry" role="listitem">
Revelle, William. 2024. <span>“The Seductive Beauty of Latent Variable Models: <span>Or</span> Why <span>I</span> Don’t Believe in the <span>Easter</span> <span>Bunny</span>.”</span> <em>Personality and Individual Differences</em> 221 (April): 112552. <a href="https://doi.org/10.1016/j.paid.2024.112552">https://doi.org/10.1016/j.paid.2024.112552</a>.
</div>
<div id="ref-sampson_neighborhoods_1997" class="csl-entry" role="listitem">
Sampson, Robert J., Stephen W. Raudenbush, and Felton Earls. 1997. <span>“Neighborhoods and <span>Violent</span> <span>Crime</span>: <span>A</span> <span>Multilevel</span> <span>Study</span> of <span>Collective</span> <span>Efficacy</span>.”</span> <em>Science</em> 277 (5328): 918–24. <a href="https://doi.org/10.1126/science.277.5328.918">https://doi.org/10.1126/science.277.5328.918</a>.
</div>
<div id="ref-wheeler_survey_2023" class="csl-entry" role="listitem">
Wheeler, Andrew. 2023. <span>“Survey Duplicates and Other Stuff.”</span> <em>Andrew Wheeler</em>. <a href="https://andrewpwheeler.com/2023/10/13/survey-duplicates-and-other-stuff/">https://andrewpwheeler.com/2023/10/13/survey-duplicates-and-other-stuff/</a>.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./9_kc_comsurvey_appendix2-neighborhood-data-clean.html" class="pagination-link" aria-label="Appendix II - Cleaning &amp; Wrangling the Neighborhood Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Appendix II - Cleaning &amp; Wrangling the Neighborhood Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11_kc_comsurvey_appendix4-power.html" class="pagination-link" aria-label="Appendix IV - Power Analysis">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Appendix IV - Power Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>