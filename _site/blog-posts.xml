<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>reluctant criminologists</title>
<link>https://www.reluctantcriminologists.com/blog-posts.html</link>
<atom:link href="https://www.reluctantcriminologists.com/blog-posts.xml" rel="self" type="application/rss+xml"/>
<description>Jon Brauer and Jake Day&#39;s blog and course materials.</description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Mon, 26 Feb 2024 05:00:00 GMT</lastBuildDate>
<item>
  <title>Moderator Madness, Part 3</title>
  <dc:creator>Jon Brauer</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/med-or-mod-cartoon2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Two lemmings confused by exposure-mediator interactions (with help from DALL-E)</figcaption>
</figure>
</div>
<p>This is the third and final entry in a three-part blog series on modeling moderators in criminological data. In <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1.html">Part 1</a>, I covered issues related to estimating and interpreting interaction effects with binary or skewed count outcome variables. In <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a>, I introduced counterfactual causality, exposure-mediator interactions, and a potential outcomes framework for conducting a four-way decomposition of a total effect into controlled direct effect (<em>CDE</em>), pure indirect effect (<em>PIE</em>), reference interaction (<em>INT<sub>ref</sub></em>), and mediated interaction (<em>INT<sub>med</sub></em>) components.</p>
<p>In this final entry, I illustrate how to use the <code>CMAverse</code> software package in R to conduct “causal mediation” analysis, which relies on the 4-way potential outcomes decomposition introduced in <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a> to disentangle indirect and interaction effects in the presence of a potential exposure-mediator interaction. Along the way, I will also introduce the important assumptions required to interpret “causal mediation” results as estimates of causal effects.</p>
<section id="do-i-really-need-to-learn-this" class="level2">
<h2 class="anchored" data-anchor-id="do-i-really-need-to-learn-this">Do I really need to learn this?</h2>
<p>Do you ever examine interaction effects? If so, is it ever plausible that the hypothesized moderator also mediates the effect of the exposure (i.e., treatment or focal causal variable)?</p>
<p>Do you ever test for indirect effects? If so, is it ever plausible that the hypothesized mediator also interacts with the exposure (treatment or focal causal) variable? In other words, is it possible that the exposure variable’s effect could differ across levels of the mediator, or is it possible that the mediator’s effect could differ across exposed and unexposed groups?</p>
<p>Do you work with data (e.g., crime or delinquency counts) for which nonlinear modeling approaches (e.g., Poisson regression) are more appropriate than traditional linear regression procedures? When testing indirect effects with such data, do you find yourself making concessions (e.g., dichotomizing data or using linear models anyway) because the software programs you use to test for mediation are restricted to a limited set of specific (e.g., linear; logistic) distributions?</p>
<p>If you answered “YES” to any of the above questions, then you should probably learn about causal mediation procedures. If you said “NO” to the first two questions, consider the following footnote that I included in <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html#fn2">Part 2</a> of this series:</p>
<blockquote class="blockquote">
<p>“At this point, you might be wondering: ‘Do I really need to do this? The [insert] theory I am testing does not predict such an interaction!’ Well, failure to examine and adjust for the possibility of an exposure-mediator interaction is equivalent to forcing your model of the data generating process to conform to a strong and potentially incorrect theoretical assumption about underlying data generating processes.<br>
In SEM parlance, it is equivalent to ‘fixing’ the effect of X on Y through M to be the same at all values of M. In situations where the effect of X on Y indeed varies across strata of M, failure to account for it could result in biased or incomplete inferences. In contrast, allowing for and decomposing a potential exposure-mediator interaction is, in SEM terms, akin to ‘freeing’ that parameter, thus permitting a test of that strong theoretical assumption. In situations where no such interaction exists, the magnitude of the interaction will approach zero, and traditional and ‘causal’ mediation approaches (e.g., ‘controlled’ and ‘natural’ effect estimates) will converge to the same values. In those situations, decomposition would be unnecessary yet nonetheless informative.<br>
In short, there is substantial upside and little downside apart from learning the skills to testing and accounting for exposure-mediator interactions whether or not one exists, yet there are potentially substantial inferential risks to <em>not</em> doing so when one exists. So, just how <em>a priori</em> confident are you in that likely imprecise and discursive theory of yours?”</p>
</blockquote>
<p>If you ever test moderation or mediation hypotheses, then it is generally <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6992469/">a good idea to incorporate the evaluation of exposure-mediator interactions</a> into your research workflow. The “causal mediation” approach I describe in this post is well-suited for this task. It is also generally applicable to a wide variety of data analytic situations and distributional types for exposures, mediators, and outcomes. For example, the <code>CMAverse</code> package in R introduced below <a href="https://bs1125.github.io/CMAverse/">can be applied to various combinations</a> of continuous, binary, count, nominal, ordinal, and survival data.</p>
</section>
<section id="sec-readfirst" class="level2">
<h2 class="anchored" data-anchor-id="sec-readfirst">Have you read Parts 1 and 2?</h2>
<p>At this point, I am assuming you read the first two entries in this series. In particular, I assume you understand the issues discussed in <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1.html">Part 1</a> pertaining to the conditional or “interactive” nature of model coefficients when nonlinear link functions are specified in generalized linear models. I also assume you understand the four-way total effect decomposition components (<em>CDE</em>; <em>PIE</em>; <em>INT<sub>ref</sub></em>; <em>INT<sub>med</sub></em>) described in <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a>.</p>
<p>If so, then you are ready to move on to a more realistic example of total effect decomposition using simulated data in R. For this example, I will rely primarily on the <a href="https://bs1125.github.io/CMAverse/"><code>CMAverse</code> package</a>, which adopts a <a href="https://www.hsph.harvard.edu/tyler-vanderweele/tools-and-tutorials/">causal mediation approach</a> to disentangling indirect and interaction effects in the presence of an exposure-mediator interaction. Though we took a long and winding road to arrive here, as I explained at the beginning of my <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1">Moderator Madness, Part 1 post</a>, this is the goal that initially motivated the three-part blog series.</p>
<p>Before diving in, I should also explain that I wrote this example with social scientists in mind that already have some familiarity with “traditional” (e.g., Baron &amp; Kenny steps; product of <em>ab</em> path coefficients) approaches to modeling mediation processes and are looking for a basic introduction to the <a href="https://pubmed.ncbi.nlm.nih.gov/34239282/">less well known yet generally preferred</a> “causal mediation” methods. If you find yourself in the position of testing or estimating indirect effects and unaware of the causal mediation approach, then I strongly encourage you to read more on the topic. There are lots of excellent <a href="https://www.publichealth.columbia.edu/research/population-health-methods/causal-mediation">summaries</a>, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7853644/">overviews of software alternatives</a>, and introductory primers on <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10368791/">causal mediation</a> and on <a href="https://journals.lww.com/epidem/Fulltext/2021/09000/CMAverse__A_Suite_of_Functions_for_Reproducible.23.aspx">CMAverse specifically</a>. Additionally, the <a href="https://bs1125.github.io/CMAverse/articles/quickstart.html">CMAverse quickstart</a> website itself is a great place to start. If nothing else, I hope this entry serves as a segue for folks curious about advancing beyond traditional mediation tests by learning about causal mediation approaches.</p>
<p>Without further ado, let’s get to it!</p>
</section>
<section id="sec-DAG" class="level2">
<h2 class="anchored" data-anchor-id="sec-DAG">DAG of simulated data-generating processes</h2>
<p>For this illustration, I will generate simulated data that are very similar to those found in <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1#outline-of-the-post">Example 2 from my “Moderator Madness: Part 1” post</a>. In that post, I stated:</p>
<blockquote class="blockquote">
<p>In the second example, I assume that the true data generating process underlying both imaginary papers (i.e., “paper 1” and “paper 2” in our example above) is an integrated causal model in which moral beliefs is both a mediating and moderating mechanism. That is, in the simulated data for the second example, there is a true indirect effect of <em>parental support</em> on delinquency through <em>strong moral beliefs</em> as well as a direct effect of <em>parental support</em> on <em>delinquency</em> that varies systematically across levels of (i.e., “interacts with”) <em>strong moral beliefs</em>.</p>
</blockquote>
<p>Thus, the simulated data here contain the same three focal variables. The exposure, <em>parental support</em> practices, is conceptualized as a variable measure of parental intervention(s) on youth attitudes and behaviors; it is generated here as a continuous, normally distributed, mean-centered variable. The mechanism, youths’ <em>strong moral beliefs</em>, is generated as a negatively skewed ordinal variable ranging from 0 to 5, which was created by reverse-scoring a truncated Poisson-distributed <em>weak moral beliefs</em> variable. The outcome, <em>delinquency</em>, is a positively skewed, Poisson-distributed event count variable ranging from 0 to a truncated theoretical maximum of 7.</p>
<p>Again, the simulated data will be generated using the following hypothetical causal mediation and moderation assumptions: <em>Parental support</em> practices are a somewhat effective cause of youth’s internalization of <em>strong moral beliefs</em>, and <em>strong moral beliefs</em> effectively cause fewer delinquent behavior events (i.e., they constrain temptations, promote resistance to, or encourage selection out of delinquency). Thus, the data generating processes include causal mediation or indirect effects of an exposure through a mechanism.</p>
<p>Additionally, <em>parental support</em> directly discourages or reduces involvement in youth delinquency.<sup>1</sup> However, this effect varies across levels of the mechanism. Specifically, parental support’s negative effect on youth delinquency is most pronounced among youth with weak moral beliefs (i.e., low <em>strong moral beliefs</em> index scores); these youth are most at risk of engaging in delinquency, so effective parental interventions have the greatest potential to enact behavioral change among these youth. In contrast, youth with strong moral beliefs are highly unlikely to engage in delinquency irrespective of the degree of parental support they experience; therefore, parental support is largely ineffective among youth with the highest <em>strong moral beliefs</em> index scores. Since the effect of parental support on delinquency varies across levels of a mechanism (e.g., across youth with weak versus strong moral beliefs), then the data generating processes include moderation or interaction effects.</p>
<p>Moreover, since parental support both operates indirectly through and interacts with youth’s strong moral beliefs, I expect the operation of an underlying <em>exposure-mediator interaction</em> in the data generating process. Recall, when we expect the existence of an additive exposure-mediator interaction, then part of the total effect of parental support might be attributable to a <em>reference interaction</em>, which involves an additive interaction that would occur when the mediator is observed even the absence of the exposure (e.g., if some youth internalize strong moral beliefs even in the absence of high parental support). Additionally, since parental support also partly causes strong moral beliefs, then parental support may be partly responsible for setting the very levels across which it variably or conditionally affects delinquency. Thus, part of the total effect of parental support on delinquency also might be attributable to a <em>mediated interaction</em>.<sup>2</sup></p>
<p>Now that the key variables and their underlying causal relationships have been discursively described, it is a good idea to generate a <a href="https://rpubs.com/NickCHK/DAGWorkshop2020"><em>directed acyclic graph</em></a> or DAG that concisely and formally communicates the causal assumptions about the data generating processes underlying our data simulation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|echo=FALSE</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#explicitly set graphics device to png(type=cairo) to knit ggblend plots properly</span></span>
<span id="cb1-4">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dev =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"png"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dev.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cairo-png"</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(simstudy)</span>
<span id="cb2-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html</span></span>
<span id="cb2-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://kgoldfeld.github.io/simstudy/articles/simstudy.html</span></span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(psych) #detach to ensure alpha works with ggplot</span></span>
<span id="cb2-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(devtools)</span></span>
<span id="cb2-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install_github("jtextor/dagitty/r")</span></span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dagitty)</span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdag)</span>
<span id="cb2-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(truncnorm)</span>
<span id="cb2-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(see)</span>
<span id="cb2-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># devtools::install_github("strengejacke/strengejacke")</span></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sjPlot"</span>)</span>
<span id="cb2-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes"</span>)</span>
<span id="cb2-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"margins"</span>)</span>
<span id="cb2-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggdist"</span>)</span>
<span id="cb2-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb2-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtsummary)</span>
<span id="cb2-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggraph)</span>
<span id="cb2-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(CMAverse)</span>
<span id="cb2-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggExtra)</span>
<span id="cb2-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggeffects)</span>
<span id="cb2-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggblend)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#function to shorten arrows (edges)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://stackoverflow.com/questions/65420136/how-do-you-adjust-the-arrows-in-a-ggplot-of-a-ggdag</span></span>
<span id="cb3-3">shorten_dag_arrows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(tidy_dag, proportion){</span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update underlying ggdag object</span></span>
<span id="cb3-5">tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, </span>
<span id="cb3-6">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(xend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x, </span>
<span id="cb3-7">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(yend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y,</span>
<span id="cb3-8">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xstart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> xend,</span>
<span id="cb3-9">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ystart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>yend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> yend)</span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(tidy_dag)</span>
<span id="cb3-11">}</span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># modified from Valeri &amp; VanderWeele 2013, Fig.2 </span></span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># causalDAG2 &lt;- dagify(</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   Y ~ A + M + C1 + C2,</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   M ~ A + C1 + C2,</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   A ~ C1,</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   exposure = "A",</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   outcome = "Y",</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   coords=list(</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     x=c(A=1, M=1.5, Y=2, C1=1.5, C2=1.9),</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     y=c(A=1, M=2, Y=1, C1=1.4, C2=1.75)</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )) %&gt;% tidy_dagitty() </span></span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change to simplified version from </span></span>
<span id="cb3-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://bs1125.github.io/CMAverse/articles/quickstart.html</span></span>
<span id="cb3-28"></span>
<span id="cb3-29">causalDAG2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb3-30">  Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> M <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C,</span>
<span id="cb3-31">  M <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C,</span>
<span id="cb3-32">  A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> C,</span>
<span id="cb3-33">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>,</span>
<span id="cb3-34">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>,</span>
<span id="cb3-35">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>),</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb3-38">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>()</span>
<span id="cb3-39"></span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#shorten edges</span></span>
<span id="cb3-42">causalDAG2p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(causalDAG2, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb3-43"></span>
<span id="cb3-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#create factor variable to isolate edge of interest, permits specifying edge color</span></span>
<span id="cb3-45">causalDAG2p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> causalDAG2p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">myedge1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(causalDAG2p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no"</span>),</span>
<span id="cb3-47">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># myedge1 = if_else(causalDAG2p$data$name == "C1" | causalDAG2p$data$name == "C2",</span></span>
<span id="cb3-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                   "yes", "no"), </span></span>
<span id="cb3-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">modlinetype =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(myedge1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change 2nd "solid" to "dashed" if desired</span></span>
<span id="cb3-50">  ) </span>
<span id="cb3-51"></span>
<span id="cb3-52"></span>
<span id="cb3-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot dag</span></span>
<span id="cb3-54">fig4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> causalDAG2p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xstart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ystart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color=</span>myedge1, </span>
<span id="cb3-56">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_linetype =</span> modlinetype), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Parental</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Support)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Measured Confounders</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Not Affected by Exposure)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Moral</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Beliefs)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Delinquency)"</span>), </span>
<span id="cb3-58">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-62">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb3-63">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggtitle("Modified Figure 2 from Valeri &amp; VanderWeele 2013") + </span></span>
<span id="cb3-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_edge_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maroon"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/DAG4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 1. DAG illustrating simulated data-generating process and ‘no unmeasured confounding’ assumptions underlying causal mediation. (Modified from Fig.2 in Valeri &amp; VanderWeele 2013)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="sec-assumptions">“Causal mediation” assumptions</h2>
<p>The DAG above is a modified version of <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/fig1.png">Part 1’s basic DAG</a>, with a couple notable changes. First, I added common “causal mediation” notations to variable names, such as exposure label “A” to “Parental Support” variable. Second, I added “measured confounders” to the DAG. I made this change with the hopes of reminding readers that making causal inferences from results of “causal mediation” models (and from traditional mediation models) requires important, and perhaps untenable, assumptions about the lack of unmeasured sources of confounding of the X-M, M-Y, or X-Y relationships.<sup>3</sup> <a href="https://pubmed.ncbi.nlm.nih.gov/23379553/">Valeri and VanderWeele (2013)</a> succinctly describe these essential assumptions:</p>
<blockquote class="blockquote">
<p>“…controlled direct effects require (a) no unmeasured treatment– outcome confounding and (b) no unmeasured mediator–outcome confounding. Natural direct and indirect effects require these assumptions and also (c) no unmeasured treatment-mediator confounding and (d) no mediator–outcome confounder affected by treatment.” (p.140)</p>
</blockquote>
<p>They also describe a (regularly overlooked) challenge with meeting these assumptions even in randomized controlled trials:</p>
<blockquote class="blockquote">
<p>“It is important to note that randomizing the treatment is not enough to rule out confounding issues in mediation analysis. This is because randomization of the treatment rules out the problem of treatment–outcome and treatment-mediator confounding but does not guarantee that the assumption of no confounding of mediator– outcome relationship holds. This is because even if the treatment is randomized, the mediator generally will not be.” (p.140)</p>
</blockquote>
<p>Research designs in criminology often violate some or all of these assumptions, thereby calling into question the appropriateness of causal interpretations of results. At the very least, I think we owe it to readers to routinely acknowledge such necessary causal assumptions and to transparently identify those assumptions that we think may be plausibly violated in our research designs. Beyond this, researchers can also consider conducting <a href="https://www.hsph.harvard.edu/tyler-vanderweele/tools-and-tutorials/">sensitivity analyses</a> to determine the robustness of conclusions to assumption violations.</p>
<p>In this entry, I will not illustrate confounding adjustments or sensitivity checks. My primary goal here is to simply introduce the causal mediation approach as a generally preferred option over traditional (e.g., product of coefficients) approaches in situations where researchers have already decided that a mediation (or moderation) analysis is appropriate. Given these aims, the simulated example below is sufficiently complex for an introductory tutorial without also including confounding of the modeled relationships. However, once one is familiar with CMAverse code, terminology, and interpretation of results, it is pretty straightforward to extend this example by including and adjusting for measured confounders, and the various resources I have linked throughout will also provide readers with additional information about recommended sensitivity checks.<sup>4</sup></p>
</section>
<section id="sec-terms" class="level2">
<h2 class="anchored" data-anchor-id="sec-terms">Terminology</h2>
<p>Before getting to the simulation, it is probably a good idea to introduce some minor changes in terminology and basic notation that you will encounter when using CMAverse to perform effect decomposition.</p>
<section id="sec-variables" class="level3">
<h3 class="anchored" data-anchor-id="sec-variables">Variables</h3>
<p>First, the focal variables are labeled as follows:</p>
<p>Exposure == A (Alternatively referred to as “X” in <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a>)<br>
Mediator == M<br>
Outcome == Y<br>
Confounders == C (Ignored here, but <a href="https://reluctantcriminologists.com/blog-posts/%5B5%5D/colliders">choose wisely</a>)</p>
<p>Though I do not include confounders in this example, two types of outcome confounders are sometimes distinguished as C1 (exposure-outcome confounders) and C2 (mediator-outcome confounders). Note that there may also be potential confounding of the exposure-mediator relationship.</p>
</section>
<section id="sec-natural" class="level3">
<h3 class="anchored" data-anchor-id="sec-natural">Controlled versus natural effects</h3>
<p>Second, depending upon the model and options selected, the CMAverse output may contain terms that do not exactly match the four-way total effect decomposition components described in <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html#sec-fourwaydecomp">Part 2</a>. I recommend reviewing those four components (<em>CDE</em>; <em>PIE</em>; <em>INT<sub>ref</sub></em>, <em>INT<sub>med</sub></em>) if needed as they are foundational to understanding CMAverse’s effect decomposition.</p>
<p>Direct Effects: You should recognize the <em>controlled direct effect</em> (<em>CDE</em>). However, the CMAverse output may also contain estimates for a <em>pure natural direct effect</em> (<em>PNDE</em>) and a <em>total natural direct effect</em> (<em>TNDE</em>).</p>
<p>Indirect Effects: Instead of encountering a <em>pure indirect effect</em> (<em>PIE</em>) estimate, the output might instead contain estimates for a <em>pure natural indirect effect</em> (<em>PNIE</em>) and a <em>total natural indirect effect</em> (<em>TNIE</em>).</p>
<p>Recall, controlled direct effects hold the mediator constant at a specific value (M=m). For example, a controlled direct effect (<em>CDE</em>) might contrast expected outcomes across A=0 and A=1 while holding the mechanism constant at a specific value like M=0.</p>
<p>Understanding natural effects requires comprehending and extending upon the counterfactual contrasts underlying the <em>CDE</em> described in Part 2. Remember that, in the presence of mediation, the mediator is expected to change as the exposure changes. So, setting the mediator to a constant value (e.g., M=0) may not provide a realistic or “natural” contrast. Natural effects allow the mediator to vary as it “naturally” would across exposure conditions, and they are then estimated by holding the mediator constant at specific counterfactual values that the mediator would be expected to take under specified exposure conditions.</p>
<p>For example, we might estimate a (pure) natural direct effect as a contrast in Y across exposure levels A=0 and A=1 when M is set to the level it is expected to be when we do[A=0] (i.e., M0). Modifying the notation used above, we can summarize this contrast as Y(do[A=1],do[M<sub>A=0</sub>]) - Y(do[A=0],do[M<sub>A=0</sub>]), or Y10 - Y00. You might notice that this overlaps with the notation presented in Part 2; however, that post presented simplified “natural” contrasts for the sake of clarity in explaining the basic decomposition components. It is important to realize, though, that do[M<sub>A=0</sub>] is not necessarily the same as setting M to m=0, <em>unless</em> the mechanism is expected to equal “0” when A=0.<sup>5</sup></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/its-natural.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">“Natural” effects are estimated by allowing the mediator to vary as it naturally would across exposure conditions and then setting it to specific counterfactual values.</figcaption>
</figure>
</div>
<p>You can find <a href="https://www.publichealth.columbia.edu/research/population-health-methods/causal-mediation">more detailed descriptions elsewhere</a> of the differences between controlled and natural effects. Once you wrap your head around these important distinctions between counterfactual contrasts and their relations to natural and controlled effects, then you may find yourself beginning to comprehend other important issues underlying mediation, moderation, and total effect decomposition.</p>
<p>First, in a linear model without interactions (i.e., where <em>INT<sub>ref</sub></em>=0 and <em>INT<sub>med</sub></em>=0), the <em>CDE</em> estimates will not change across different values of M. Additionally, in such models, controlled and natural direct effects will converge on the same estimates. This is because doing A=1 (versus A=0) will have the same effect on Y at all values of M, so doing M=0 or doing M<sub>A=0</sub> will generate the same direct effect estimate. This should become apparent in the examples using simulated data below.</p>
<p>Second, as you have probably figured out by now, things are not as straightforward in more complex models with nonlinear link functions or exposure-mediator interactions. For instance, when the effect of the exposure varies across levels of the mechanism, as it would in the presence of an exposure-mediator interaction, controlled (Y1m - Y0m) and natural (e.g., Y10 - Y00) direct effect estimates may vary as well. This, too, should become apparent in the examples below.</p>
<p>Third, when there are nonlinearities or exposure-mediator interactions, one could conceivably estimate a different <em>CDE</em> for every possible value of M! This makes it impossible to perform effect decomposition in the presence of an interaction using controlled effects. However, the counterfactual contrasts underlying natural direct and indirect effect estimates are uniquely defined so there is a single value even in the presence of nonlinearities and exposure-mediator interactions. This permits us to perform effect decomposition even in those situations involving more complex causal relationships.</p>
<p>Put differently, given the same exposure contrasts (e.g., setting <code>astar=0</code> and <code>a=1</code> in CMAverse models), changing the mediator value (e.g, from <code>mval = list(0)</code> to <code>mval = list(1)</code>) may result in different controlled direct effect estimates, but it will not change natural direct effect estimates. This may not be apparent in the examples below, but you can easily test it yourself (e.g., by copying my code, setting <code>mval</code> to different mediator values, and comparing results).</p>
</section>
<section id="sec-pure" class="level3">
<h3 class="anchored" data-anchor-id="sec-pure">Pure versus total effects</h3>
<p>I just told you that there is only one natural direct and natural indirect effect. Yet, your CMAverse output will probably show more than one natural direct and indirect effect estimate! Do not lose trust in me just yet. It is more accurate to say that there is only one “pure” natural direct effect, and there is only one “total” natural direct effect estimate. So, what is the difference between “pure” and “total” effects?</p>
<p>Ultimately, the difference between “pure” and “total” effects comes down to the nonzero “mediated interaction” or <em>INT<sub>med</sub></em> estimate that we may find when there is an exposure-mediator interaction. Recall, the <em>INT<sub>med</sub></em> estimate describes how, in the presence of both mediation and moderation, we can contribute some differences in the effect of X on Y across different levels of M to the fact that X <em>causes</em> different levels of M. Well, when we decompose mediation and moderation components, should we attribute <em>INT<sub>med</sub></em> effects to mediation processes or to moderation processes?</p>
<p>That is, are <em>INT<sub>med</sub></em> effects best thought of as indirect effects, or are they best thought of as interaction effects? The secret to understanding the difference between “pure” and “total” effect estimates, and which specific ones you will want to interpret, lies in your answer to that question.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/catfight.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">When interpreting “pure” and “total” effects, remember the “total” cat won the fight over the <em>INT<sub>med</sub></em> component.</figcaption>
</figure>
</div>
<p>Fundamentally, <em>INT<sub>med</sub></em> effects are simultaneously indirect <em>and</em> interaction effects. However, depending upon your research question and estimand of interest, you may wish to attribute that <em>INT<sub>med</sub></em> component to the “direct” effect of X on Y at specific counterfactual values of M (i.e., absorbed into heterogeneous estimates of direct effects across values of M) or, instead, to the “indirect” effect of X on Y through M. In any case, there are a few important points to remember when interpreting these effects.</p>
<p>First, “pure” effects <em>do not</em> include the <em>INT<sub>med</sub></em> component, whereas “total” effects <em>do</em> include the <em>INT<sub>med</sub></em> component. So, for instance, a “pure direct effect” does not contain <em>any</em> mediation components; rather, it purely summarizes the effect of X on Y that is due to its controlled direct effect (CDE) and any heterogeneity across M that is not due to mediation (i.e.&nbsp;attributed to <em>INT<sub>ref</sub></em> but not <em>INT<sub>med</sub></em>). Meanwhile, a “total indirect effect” contains <em>all</em> indirect effect sources, including the “pure” indirect effect (<em>PIE</em>) of X on Y through M and any interaction component that is due to mediation (i.e., <em>INT<sub>med</sub></em>).</p>
<p>Second, we always pair the following effect estimates:</p>
<ul>
<li>Pure natural direct effect &amp; total natural indirect effect (<em>PNDE</em> &amp; <em>TNIE</em>)</li>
<li>Total natural direct effect &amp; pure natural direct effect (<em>TNDE</em> &amp; <em>PNIE</em>)</li>
</ul>
<p>These pairings ensure that: (1) all mediation and moderation components (<em>CDE</em>; <em>PIE</em>; <em>INT<sub>ref</sub></em>; <em>INT<sub>med</sub></em>) are accounted for in the given pair, and (2) that the <em>INT<sub>med</sub></em> component is always counted once and only once, either in the (total) direct effect estimate or in the (total) indirect effect estimate. The table below shows which of the four decomposition components are included in each of the pure and total direct and indirect effect estimates.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/effects-table.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Relationship between 4-way effect decomposition and CMAverse effect estimates. Modified from Table 4 in Vanderweele 2014</figcaption>
</figure>
</div>
<p>Third, since all four components of a total effect are accounted for in each of these two pairings of pure and total effects, each paired direct and indirect effect estimate essentially sums to the total effect of an exposure on an outcome. In fact, in a linear model, the <em>PNDE</em> + <em>TNIE</em> estimates quite literally will sum to the same value as the <em>TNDE</em> + <em>PNIE</em> estimates, and each of these pairs will sum to the total effect estimate. The pair you choose to interpret, then, depends upon your research question, goals, and estimand of interest.</p>
<p>Fourth, in the absence of an exposure-mediator interaction - such as when the interaction term equals zero or when you ignore a nonzero interaction term by not including it in the model - then the <em>CDE</em>, <em>TNDE</em>, and <em>PNDE</em> estimates all will converge to the same value. This is because the <em>INT<sub>ref</sub></em> and <em>INT<sub>med</sub></em> components are essentially fixed to zero in these situations, either by the data or by the researcher.</p>
<p>That’s enough talking. Let’s start walking with a simulation.</p>
</section>
</section>
<section id="sec-simulate" class="level2">
<h2 class="anchored" data-anchor-id="sec-simulate">Simulate data</h2>
<p>I start by simulating n=3,000 observations, which should allow us to generate relatively precise estimates of each estimated component. We have more than enough going on; we do not need to deal simultaneously with issues related to particularly noisy estimates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data (Sim.2)</span></span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb4-8">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span></span>
<span id="cb4-9"></span>
<span id="cb4-10">def2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb4-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-12">def2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.3 + (-.3)*ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb4-14">def2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + (-.25)*ParentSupport + .4*WeakMoralBlfs + </span></span>
<span id="cb4-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    (-.15)*ParentSupport*WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb4-17">def2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + (-.25)*ParentSupport + .4*WeakMoralBlfs + </span></span>
<span id="cb4-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    (-.15)*ParentSupport*WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb4-20">simdat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(n, def2)</span>
<span id="cb4-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#NOTE: Simulated alternative "Delinquency2" variable to illustrate interaction </span></span>
<span id="cb4-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># on linear estimation scale in nonlinear model</span></span>
<span id="cb4-23"></span>
<span id="cb4-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;% sjPlot::view_df()</span></span>
<span id="cb4-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;% </span></span>
<span id="cb4-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(aes(x=WeakMoralBlfs, y=Delinquency)) +</span></span>
<span id="cb4-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_point()</span></span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap LowMoral at 5 (0-5 item) - randomly replace oob values with values in bounds </span></span>
<span id="cb4-30">inds2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb4-31">simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs[inds2] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-32">simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs</span>
<span id="cb4-33"></span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap Delinquency at 7 (0-7 item) - randomly replace oob values with in bounds values</span></span>
<span id="cb4-35">inds2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb4-36">simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency[inds2] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-37"></span>
<span id="cb4-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inds3 &lt;- simdat2$Delinquency2 &gt; 7</span></span>
<span id="cb4-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2$Delinquency2[inds3] &lt;- sample(0:7, sum(inds3), replace = TRUE)</span></span>
<span id="cb4-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Truncation minimizes relative interaction, so not truncate Delinquency2 </span></span>
<span id="cb4-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># increases relative differences on outcome scale for viz in final example</span></span>
<span id="cb4-42"></span>
<span id="cb4-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;% sjPlot::view_df()</span></span>
<span id="cb4-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;%</span></span>
<span id="cb4-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(aes(x=WeakMoralBlfs, y=Delinquency)) +</span></span>
<span id="cb4-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_point()</span></span>
<span id="cb4-47"></span>
<span id="cb4-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Even with n=10k, need to consider collapsing low values for StrgMoralBlfs and recenter to min=0</span></span>
<span id="cb4-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Raise points re: rare events &amp; skewed data</span></span>
<span id="cb4-50">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># out of n=10k, 18.1% of cases have StrgMoralBlfs &lt;=3 </span></span>
<span id="cb4-51">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (nrow(subset(simdat2, StrgMoralBlfs &lt;=3))/10000)*100</span></span>
<span id="cb4-52">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># out of n=10k, 1.02% (n=102) of cases have StrgMoralBlfs &lt;=1 </span></span>
<span id="cb4-53">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (nrow(subset(simdat2, StrgMoralBlfs &lt;=1))/10000)*100</span></span>
<span id="cb4-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># out of n=10k, 0.17% (n=17) of cases have StrgMoralBlfs &lt;=0 </span></span>
<span id="cb4-55">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (nrow(subset(simdat2, StrgMoralBlfs &lt;=1))/10000)*100</span></span>
<span id="cb4-56"></span>
<span id="cb4-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Collapse [0,1] values &amp; recenter StrgMoralBlfs from 0-4</span></span>
<span id="cb4-58">simdat3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrgMoralBlfs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(</span>
<span id="cb4-61">      StrgMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, StrgMoralBlfs), </span>
<span id="cb4-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrgMoralBlfs =</span> StrgMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-63">    )</span>
<span id="cb4-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(simdat3$StrgMoralBlfs)</span></span>
<span id="cb4-65"></span>
<span id="cb4-66">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(simdat3, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> ParentSupport, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb4-69"></span>
<span id="cb4-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Densigram</span></span>
<span id="cb4-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggMarginal</span>(p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"densigram"</span>, </span>
<span id="cb4-72">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot above shows the joint distribution of the exposure (A=ParentSupport) and mechanism (M=StrgMoralBlfs). Notice the lack of observations in the bottom right of the plot, at the highest values of parental support (A&gt;2) and lowest values of strong moral beliefs (M=0). This pattern might be expected given the existence of mediation processes; that is, high parental support causes strong moral beliefs, so we might not expect to observe the lowest values of the mechanism at the highest exposure levels.</p>
<p>Note, too, that there are observations with high mechanism values (e.g., strong moral beliefs, or M=4) across a wide range of exposure levels (e.g., from -2SD to +3SD levels of parent support). This means a nonzero <em>INT<sub>ref</sub></em> component is possible, since a nonzero reference interaction requires that the mechanism be present even in the absence (or, in this case, at low levels) of the exposure.</p>
<p>Finally, there are relatively few observations at the lowest value (M=0) of the skewed, Poisson-distributed mechanism across the range of exposure levels. One consequence is that estimates of the causal effect of the exposure generated at the highest mechanism levels will be much noisier and more uncertain than those generated at the lowest mechanism levels. This is the case despite simulating a relatively large sample of n=3,000 observations. Assuming distributions of variables like moral beliefs and delinquency tend to be similarly skewed in the real world (and they are), you can imagine how much noisier and more uncertain such estimates might be in smaller real-world criminological samples.</p>
</section>
<section id="sec-plots" class="level2">
<h2 class="anchored" data-anchor-id="sec-plots">Regressions &amp; interaction plots</h2>
<p>Now that I have simulated data resembling real-world self-reported criminological data, my next step will be to build regression models and then estimate and plot marginal effects of parental support on delinquency at different levels of strong moral beliefs to visualize any exposure-mediator interactions in these data.</p>
<p>As I explained in <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1.html">Part 1</a>, I will want to build a generalized linear model with a nonlinear link function that can flexibly describe the data generating processes causing the skewed distributions and nonlinearities observed in the simulated data. Additionally, I will want to add an interaction term to that model to account for the possibility of an exposure-mediator interaction on the estimation scale.</p>
<p>Yet, I will start by presenting results from a simple linear interaction model. Why? Well, because so many researchers in our field seem to be most comfortable, if not outright obsessed, with simple linear models. What else explains our field’s collective unwillingness to move on from them?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.2 linear model</span></span>
<span id="cb5-4">lm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3)</span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.2 nonlinear model</span></span>
<span id="cb5-7">glm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb5-8"></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function for custom p-values</span></span>
<span id="cb5-11">roundp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb5-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(</span>
<span id="cb5-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x), </span>
<span id="cb5-14">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>,</span>
<span id="cb5-15">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scientific =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scientific =</span> F))</span>
<span id="cb5-16">    )</span>
<span id="cb5-17">  } </span>
<span id="cb5-18"></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function for reg output w/custom p-values</span></span>
<span id="cb5-20">regsum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(mymod) {</span>
<span id="cb5-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(mymod, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pvalue_fun =</span> roundp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_significance_stars</span>(</span>
<span id="cb5-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_p =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb5-26">      )</span>
<span id="cb5-27">}</span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Regression output</span></span>
<span id="cb5-30"></span>
<span id="cb5-31">Ex2tab1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(lm2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-33">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear regression predicting delinquency values"</span>)</span>
<span id="cb5-34"></span>
<span id="cb5-35">Ex2tab2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-37">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Poisson regression predicting delinquency event rates"</span>)</span>
<span id="cb5-38"></span>
<span id="cb5-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Plot interactions </span></span>
<span id="cb5-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot at all four values: minimum (0), (1), median (2), and maximum (3) strong moral beliefs</span></span>
<span id="cb5-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#show x-axis from approx -2sd to 2sd parental support</span></span>
<span id="cb5-42">plot_lm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(lm2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,   </span>
<span id="cb5-43">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs [0,2,4]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>, </span>
<span id="cb5-49">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb5-50">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency"</span>, </span>
<span id="cb5-51">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted at minimum (0), scale midpoint (2), &amp; maximum (4) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Linear regression, n=3k simulated observations)"</span>)  </span>
<span id="cb5-52"></span>
<span id="cb5-53">plot_glm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-54">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs [0,2,4]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>, </span>
<span id="cb5-60">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb5-61">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency"</span>, </span>
<span id="cb5-62">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted at minimum (0), scale midpoint (2), &amp; maximum (4) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Poisson regression, n=3k simulated observations)"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="general-linear-interaction-model" class="level2">
<h2 class="anchored" data-anchor-id="general-linear-interaction-model">General linear interaction model</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">General linear interaction model results</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Prediction plots</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">Prediction plots with data</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" aria-controls="tabset-1-4" aria-selected="false">Prediction plots (min-to-max ParentSupport)</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" aria-controls="tabset-1-5" aria-selected="false">Prediction plots with data (M=0 only)</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">Ex2tab1</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="wrxfwrmosu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wrxfwrmosu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wrxfwrmosu thead, #wrxfwrmosu tbody, #wrxfwrmosu tfoot, #wrxfwrmosu tr, #wrxfwrmosu td, #wrxfwrmosu th {
  border-style: none;
}

#wrxfwrmosu p {
  margin: 0;
  padding: 0;
}

#wrxfwrmosu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wrxfwrmosu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wrxfwrmosu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wrxfwrmosu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wrxfwrmosu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wrxfwrmosu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wrxfwrmosu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wrxfwrmosu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wrxfwrmosu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wrxfwrmosu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wrxfwrmosu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wrxfwrmosu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wrxfwrmosu .gt_spanner_row {
  border-bottom-style: hidden;
}

#wrxfwrmosu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wrxfwrmosu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wrxfwrmosu .gt_from_md > :first-child {
  margin-top: 0;
}

#wrxfwrmosu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wrxfwrmosu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wrxfwrmosu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wrxfwrmosu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wrxfwrmosu .gt_row_group_first td {
  border-top-width: 2px;
}

#wrxfwrmosu .gt_row_group_first th {
  border-top-width: 2px;
}

#wrxfwrmosu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wrxfwrmosu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wrxfwrmosu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wrxfwrmosu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wrxfwrmosu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wrxfwrmosu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wrxfwrmosu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wrxfwrmosu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wrxfwrmosu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wrxfwrmosu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wrxfwrmosu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wrxfwrmosu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wrxfwrmosu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wrxfwrmosu .gt_left {
  text-align: left;
}

#wrxfwrmosu .gt_center {
  text-align: center;
}

#wrxfwrmosu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wrxfwrmosu .gt_font_normal {
  font-weight: normal;
}

#wrxfwrmosu .gt_font_bold {
  font-weight: bold;
}

#wrxfwrmosu .gt_font_italic {
  font-style: italic;
}

#wrxfwrmosu .gt_super {
  font-size: 65%;
}

#wrxfwrmosu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wrxfwrmosu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wrxfwrmosu .gt_indent_1 {
  text-indent: 5px;
}

#wrxfwrmosu .gt_indent_2 {
  text-indent: 10px;
}

#wrxfwrmosu .gt_indent_3 {
  text-indent: 15px;
}

#wrxfwrmosu .gt_indent_4 {
  text-indent: 20px;
}

#wrxfwrmosu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Linear regression predicting delinquency values</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Beta</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Beta</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">2.1***</td>
<td headers="std.error" class="gt_row gt_center">0.068</td>
<td headers="ci" class="gt_row gt_center">2.0, 2.3</td>
<td headers="p.value" class="gt_row gt_center">1.11e-190</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-1.2***</td>
<td headers="std.error" class="gt_row gt_center">0.063</td>
<td headers="ci" class="gt_row gt_center">-1.3, -1.1</td>
<td headers="p.value" class="gt_row gt_center"> 1.46e-72</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.42***</td>
<td headers="std.error" class="gt_row gt_center">0.020</td>
<td headers="ci" class="gt_row gt_center">-0.46, -0.38</td>
<td headers="p.value" class="gt_row gt_center"> 9.17e-91</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">0.26***</td>
<td headers="std.error" class="gt_row gt_center">0.019</td>
<td headers="ci" class="gt_row gt_center">0.23, 0.30</td>
<td headers="p.value" class="gt_row gt_center"> 9.07e-43</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb7-2"></span>
<span id="cb7-3">plot_lm2</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot_lm2 &amp; </span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   theme(legend.position = 'bottom',</span></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#         legend.direction = 'horizontal') </span></span></code></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb9-2"></span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#dev = "png" </span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#dev.args = list(type = "cairo-png")</span></span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use ggeffects::ggpredict() to save plot_model data for use in ggplot </span></span>
<span id="cb9-8">lm2df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggpredict</span>(lm2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs [0,2,4]"</span>))</span>
<span id="cb9-9"></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#save subsets of simdat3 to plot observations where StrgMoralBlfs in (0,2,4)</span></span>
<span id="cb9-11">simdat3sub <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(StrgMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb9-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrgMoralBlfs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(StrgMoralBlfs))</span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prediction plot with data subset - use ggblend to improve overlap viz</span></span>
<span id="cb9-17">predplot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3sub, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>ParentSupport, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency, </span>
<span id="cb9-18">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_point(data=simdat3sub[simdat3sub$StrgMoralBlfs == 0], alpha=0.4)  +</span></span>
<span id="cb9-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_point(data=simdat3sub[simdat3sub$StrgMoralBlfs %in% c(2,4)], alpha=0.1) +</span></span>
<span id="cb9-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">partition</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">blend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lighten"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb9-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">blend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiply"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>lm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted,</span>
<span id="cb9-28">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span>group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>group), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb9-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>lm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted, </span>
<span id="cb9-30">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>conf.high, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>group), </span>
<span id="cb9-31">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linetype_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>,</span>
<span id="cb9-35">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb9-36">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency"</span>, </span>
<span id="cb9-37">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted at minimum (0), scale midpoint (2), &amp; maximum (4) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Poisson regression, n=3k simulated observations)"</span>) </span>
<span id="cb9-38"></span>
<span id="cb9-39">predplot1</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb10-2"></span>
<span id="cb10-3">plot_lm2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(simdat3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ParentSupport), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(simdat3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ParentSupport)), </span>
<span id="cb10-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>,</span>
<span id="cb10-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb10-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency"</span>, </span>
<span id="cb10-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted across full range (min-to-max) of parental support values and</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">at minimum (0), scale midpoint (2), &amp; maximum (4) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Poisson regression, n=3k simulated observations)"</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3sub, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>ParentSupport, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency, </span>
<span id="cb11-4">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3sub[simdat3sub<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>lm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted,</span>
<span id="cb11-11">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span>group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>group), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb11-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>lm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted, </span>
<span id="cb11-13">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>conf.high, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>group), </span>
<span id="cb11-14">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linetype_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>,</span>
<span id="cb11-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb11-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency"</span>, </span>
<span id="cb11-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted at minimum (0) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Poisson regression, n=3k simulated observations)"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Hey, the linear interaction model detected a substantial interaction between parental support and moral beliefs! So far, so good, right? Not so fast. How well do you think the linear regression slopes describe the data and underlying data generating processes?</p>
<p>I attempt to visualize this in the second figure above (third tab, entitled “Prediction Plots with Data”), which overlays the marginal effect prediction lines with a scatterplot of the relevant data (i.e., a subset of Strong Moral Beliefs values equal to “0”, “2”, and “4”). Close examination of this figure appears to reveal some areas of poor fit between the model’s linear predictions and the underlying data. Of particular concern are some out of bounds predictions below “0” on predicted delinquency counts (bottom right side of the plot). Of course, you expected some problems with a linear model because you read <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1.html">Part 1</a> entry.</p>
<p>Yet, what would happen if I were to use this particular linear interaction model to make predictions about delinquency values at higher exposure levels? After all, our maximum observed ParentSupport score is 3.6, but we are only plotting from about -2SD to +2SD values on this variable in the first figure. You can see what happens when I extend the prediction plot to the full observed (minimum to maximum) range of ParentSupport scores in the third figure (fourth tab) above.</p>
<p>Perhaps unsurprisingly, the crossover interaction appears even more pronounced in this version of the plot. With the exception of predictions at the highest mechanism values (M=4), this model predicts <em>negative</em> delinquency counts at high observed exposure levels; of course, negative outcome scores were not observed and are not even logically possible in this case. As discussed in Part 1, these sorts of problematic model predictions are routinely generated as artifacts of inappropriately applying a linear model to nonlinear data.</p>
<p>Speaking of model issues, I often think regression results like these convey an illusory degree of precision around model-based estimates and predictions. To illustrate, check out the fourth figure (fifth tab) above, which overlays marginal predictions with a scatterplot of only the subset of observations for which M=0.</p>
<p>In this plot, notice the relative lack of observations at M=0 despite a relatively large sample (n=3,000 total)? I referenced this issue earlier after simulating the data. Now, look at the spread of the relatively sparse observations where M=0 (black dots), and compare the confidence interval bands for the M=0 prediction line (black line). Given the scarcity of data at this mechanism level and the fit of that line to the data points in the scatterplot, do you feel that these confidence bands effectively communicate the degree of uncertainty we should have with the predictions implied by that line? Perhaps you do, and I am simply a curmudgeon. In any case, this is another topic for a different entry.</p>
<p>Now, let’s compare these results with those generated by a generalized linear model specifying a Poisson distributed outcome with a log link (aka, a “nonlinear” model).</p>
</section>
<section id="generalized-linear-poisson-nonlinear-interaction-model" class="level2">
<h2 class="anchored" data-anchor-id="generalized-linear-poisson-nonlinear-interaction-model">Generalized linear Poisson (“nonlinear”) interaction model</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Nonlinear interaction model results</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Prediction plots</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" aria-controls="tabset-2-3" aria-selected="false">Prediction plots with data</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" aria-controls="tabset-2-4" aria-selected="false">Prediction plots with data (M=0 only)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">Ex2tab2</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="zcfhdpajps" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zcfhdpajps table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zcfhdpajps thead, #zcfhdpajps tbody, #zcfhdpajps tfoot, #zcfhdpajps tr, #zcfhdpajps td, #zcfhdpajps th {
  border-style: none;
}

#zcfhdpajps p {
  margin: 0;
  padding: 0;
}

#zcfhdpajps .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zcfhdpajps .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zcfhdpajps .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zcfhdpajps .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zcfhdpajps .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zcfhdpajps .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zcfhdpajps .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zcfhdpajps .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zcfhdpajps .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zcfhdpajps .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zcfhdpajps .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zcfhdpajps .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zcfhdpajps .gt_spanner_row {
  border-bottom-style: hidden;
}

#zcfhdpajps .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zcfhdpajps .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zcfhdpajps .gt_from_md > :first-child {
  margin-top: 0;
}

#zcfhdpajps .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zcfhdpajps .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zcfhdpajps .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zcfhdpajps .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zcfhdpajps .gt_row_group_first td {
  border-top-width: 2px;
}

#zcfhdpajps .gt_row_group_first th {
  border-top-width: 2px;
}

#zcfhdpajps .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zcfhdpajps .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zcfhdpajps .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zcfhdpajps .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zcfhdpajps .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zcfhdpajps .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zcfhdpajps .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zcfhdpajps .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zcfhdpajps .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zcfhdpajps .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zcfhdpajps .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zcfhdpajps .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zcfhdpajps .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zcfhdpajps .gt_left {
  text-align: left;
}

#zcfhdpajps .gt_center {
  text-align: center;
}

#zcfhdpajps .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zcfhdpajps .gt_font_normal {
  font-weight: normal;
}

#zcfhdpajps .gt_font_bold {
  font-weight: bold;
}

#zcfhdpajps .gt_font_italic {
  font-style: italic;
}

#zcfhdpajps .gt_super {
  font-size: 65%;
}

#zcfhdpajps .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zcfhdpajps .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zcfhdpajps .gt_indent_1 {
  text-indent: 5px;
}

#zcfhdpajps .gt_indent_2 {
  text-indent: 10px;
}

#zcfhdpajps .gt_indent_3 {
  text-indent: 15px;
}

#zcfhdpajps .gt_indent_4 {
  text-indent: 20px;
}

#zcfhdpajps .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Poisson regression predicting delinquency event rates</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">0.99***</td>
<td headers="std.error" class="gt_row gt_center">0.064</td>
<td headers="ci" class="gt_row gt_center">0.86, 1.1</td>
<td headers="p.value" class="gt_row gt_center">9.75e-54</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-0.38***</td>
<td headers="std.error" class="gt_row gt_center">0.047</td>
<td headers="ci" class="gt_row gt_center">-0.47, -0.29</td>
<td headers="p.value" class="gt_row gt_center">1.08e-15</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.42***</td>
<td headers="std.error" class="gt_row gt_center">0.021</td>
<td headers="ci" class="gt_row gt_center">-0.46, -0.38</td>
<td headers="p.value" class="gt_row gt_center">1.88e-90</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">0.00</td>
<td headers="std.error" class="gt_row gt_center">0.016</td>
<td headers="ci" class="gt_row gt_center">-0.03, 0.03</td>
<td headers="p.value" class="gt_row gt_center">0.963</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb13-2"></span>
<span id="cb13-3">plot_glm2</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb14-2"></span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use ggeffects::ggpredict() to save plot_model data for use in ggplot </span></span>
<span id="cb14-4">glm2df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggpredict</span>(glm2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs [0,2,4]"</span>))</span>
<span id="cb14-5"></span>
<span id="cb14-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#prediction plot with data subset &amp; ggblend</span></span>
<span id="cb14-7">predplot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3sub, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>ParentSupport, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency, </span>
<span id="cb14-8">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_point(data=simdat3sub[simdat3sub$StrgMoralBlfs == 0], alpha=0.4)  +</span></span>
<span id="cb14-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_point(data=simdat3sub[simdat3sub$StrgMoralBlfs %in% c(2,4)], alpha=0.1) +</span></span>
<span id="cb14-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">partition</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">blend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lighten"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb14-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">blend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiply"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>glm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted,</span>
<span id="cb14-18">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span>group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>group), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb14-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>glm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted, </span>
<span id="cb14-20">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>conf.high, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>group), </span>
<span id="cb14-21">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linetype_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>,</span>
<span id="cb14-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb14-26">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency"</span>, </span>
<span id="cb14-27">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted at minimum (0), scale midpoint (2), &amp; maximum (4) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Poisson regression, n=3k simulated observations)"</span>) </span>
<span id="cb14-28"></span>
<span id="cb14-29">predplot2</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#prediction plot with data subset &amp; ggblend</span></span>
<span id="cb15-4">predplot2b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3sub, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>ParentSupport, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency, </span>
<span id="cb15-5">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3sub[simdat3sub<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>glm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted,</span>
<span id="cb15-12">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span>group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>group), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb15-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>glm2df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted, </span>
<span id="cb15-14">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>conf.high, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>group), </span>
<span id="cb15-15">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linetype_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>,</span>
<span id="cb15-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb15-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency"</span>, </span>
<span id="cb15-21">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted at minimum (0) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Poisson regression, n=3k simulated observations)"</span>) </span>
<span id="cb15-22"></span>
<span id="cb15-23">predplot2b</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>The first thing you might notice is that the results tables show a statistically non-significant interaction term that is near-zero in magnitude on the estimation scale (logged delinquency event rates) in this model. Of course, after reading Part 1, you know better than to rely on the sign and significance of an interaction term from a generalized regression model with a nonlinear link function to draw inferences about model predictions on the outcome scale. Rather, you know it is a good idea to estimate and plot marginal effects, which I also do here.</p>
<p>Second, as with the linear model results, examination of marginal prediction plots appears to reveal an additive interaction pattern on the outcome scale (delinquency event rates). However, unlike the linear model results, the greater flexibility and appropriateness of the nonlinear functional form specified in this model permits a better fit between the marginal predictions and the data while also avoiding illogical negative delinquency predictions. The model is not perfect; for instance, we might wish to account for a threshold effect or censoring at the highest delinquency observations. Still, this model should be good enough for our purposes here.</p>
</section>
<section id="sec-indirect" class="level2">
<h2 class="anchored" data-anchor-id="sec-indirect">Whither the indirect effect?</h2>
<p>Now, for some in our field, documenting an additive interaction like this, whether generated with linear or nonlinear model specifications, would be deemed sufficient grounds for declaring a contribution to existing literature and for publishing a manuscript in a peer-reviewed journal. (Remember the <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1#two-papers-walk-into-a-bar">hypothetical paper #2</a> from Part 1?)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="fake_paper2.jpg"><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/fake_paper2.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><a href="fake_paper2.jpg">Part 1’s “Imaginary Paper #2”</a></p>
<p>Yet, note that this model does not seem to account for the possibility of an indirect effect of parental support on delinquency through the moderating mechanism. Moreover, since the exposure causes the mechanism, is the observed interaction an example of a “mediated interaction” (<em>INT<sub>med</sub></em>)? Or, is this an example of a reference interaction (<em>INT<sub>ref</sub></em>), or perhaps both? We will use CMAverse to answer this question soon, but you might be able to intuit the answer from prediction plots and with an understanding of what these two components represent that you gained from the toe-stubbing example in Part 2.</p>
<p>Before using CMAverse, I want to first illustrate a “traditional” approach to testing for indirect effects. Commonly, researchers in our field might use what is popularly known as the classic <a href="https://www.psych.mcgill.ca/perpg/fac/falk/tutorials/mediation/methods/#baron-kenny-1986">“Baron and Kenny” (1986) causal steps approach</a> to detecting indirect effects. This “traditional” approach to testing mediation hypotheses usually involves estimating a series of regression models and then, depending upon the specific procedures adopted, estimating a “difference in coefficients” or “product of coefficients” representing causal path estimates (e.g., <em>ab</em> paths) paired with a test of significance. (See <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2819363/">MacKinnon and colleagues’ 2002</a> paper, and especially their Table 1, for a summary of these traditional approaches).<sup>6</sup></p>
<p>For this illustration, I will use <code>psych::mediate()</code> to estimate “traditional” direct and indirect effects of parental support on delinquency through moral beliefs. This package by default relies upon the “product of coefficients” estimation approach with bootstrapped standard errors, which is a very popular method in social sciences due perhaps to its status for years as the default method for testing indirect effects in <a href="https://www.statmodel.com/download/Causal.pdf">SEM programs like Mplus</a> as well as the increasing popularity of <a href="https://processmacro.org/index.html">PROCESS modeling</a>.</p>
</section>
<section id="sec-traditional" class="level2">
<h2 class="anchored" data-anchor-id="sec-traditional">Traditional (<em>ab</em>) linear mediation model</h2>
<p>Traditional product of coefficients approach</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mediate</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (StrgMoralBlfs), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">short =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mediation/Moderation Analysis 
Call: psych::mediate(y = Delinquency ~ ParentSupport + (StrgMoralBlfs), 
    data = simdat3, n.iter = 2000)

The DV (Y) was  Delinquency . The IV (X) was  ParentSupport . The mediating variable(s) =  StrgMoralBlfs .

Total effect(c) of  ParentSupport  on  Delinquency  =  -0.43   S.E. =  0.02  t  =  -21.6  df=  2998   with p =  9.9e-97
Direct effect (c') of  ParentSupport  on  Delinquency  removing  StrgMoralBlfs  =  -0.33   S.E. =  0.02  t  =  -17.7  df=  2997   with p =  1.5e-66
Indirect effect (ab) of  ParentSupport  on  Delinquency  through  StrgMoralBlfs   =  -0.1 
Mean bootstrapped indirect effect =  -0.1  with standard error =  0.01  Lower CI =  -0.12    Upper CI =  -0.08
R = 0.53 R2 = 0.28   F = 580 on 2 and 2997 DF   p-value:  4.04e-297 

 To see the longer output, specify short = FALSE in the print statement or ask for the summary</code></pre>
</div>
</div>
<p>Results from the “traditional” mediation analysis show an indirect effect estimate of -0.10. You can calculate the indirect effect estimate yourself from the path diagram by multiplying the so-called <em>a</em> and <em>b</em> path coefficients, or (0.20)x(-0.48) = -0.10, hence the “product of coefficients” terminology.</p>
<p>The estimate is also statistically significant. Of course, with a simulated sample size of n=3,000, even modest non-zero estimates will be significant. You will rarely find us pointing to statistical significance as a useful information signal in our blog entries; that is a topic for another time.</p>
<p>To me, a better question here might be whether, given a causal indirect effect of this estimated magnitude, a change in exposure (e.g., from “0” to “1”) would be predicted to generate differences of substantively meaningful magnitudes on the outcome scale indirectly through a mechanistic change in the mediator. You might notice that our interaction plots above depicting predicted marginal effects provide us substantially greater leverage for answering this type of question.</p>
<p>Still, we are on a mission here, so I will avoid the temptation to embark on a yet another tangent, this time about effect sizes. Instead, I will simply note that this indirect effect output and path diagram might be viewed as sufficient in our field to declare another contribution and submit yet another paper to the publication pile. (Remember <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1#two-papers-walk-into-a-bar">hypothetical paper #1</a> from Part 1?)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="fake_paper1.jpg"><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/fake_paper1.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><a href="fake_paper1.jpg">Part 1’s “Imaginary Paper #1”</a></p>
<p>Let’s move to <code>CMAverse</code>, starting with a simple linear mediation model that reproduces key results from the “traditional” mediation approach.</p>
</section>
<section id="sec-CMAlin-noint" class="level2">
<h2 class="anchored" data-anchor-id="sec-CMAlin-noint">Linear CMA model, no <em>EMint</em></h2>
<p>Below, I use the <code>cmest()</code> function from the <code>CMAverse</code> R package. Specifying the mediator and outcome distributions (<code>mreg</code> and <code>yreg</code>) as “linear” and setting the exposure-mediator coefficient (<code>EMint</code>) to “FALSE” makes this model equivalent to the traditional mediation model above.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb18-2">est2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cmest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rb"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>,</span>
<span id="cb18-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mediator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">EMint =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb18-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mreg =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yreg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>,</span>
<span id="cb18-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">astar =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mval =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb18-6">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imputation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inference =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bootstrap"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nboot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">Results: linear no EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false">Default plot: linear no EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" aria-controls="tabset-3-3" aria-selected="false">Full output: linear no EMint</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">est2dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>effect.pe) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>) </span>
<span id="cb19-2"></span>
<span id="cb19-3"></span>
<span id="cb19-4">est2dattab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> est2dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_column</span>(</span>
<span id="cb19-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trad_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"direct"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"indirect"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prop_med"</span>), </span>
<span id="cb19-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">43</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_noEM"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est2$effect.pe"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(trad_est, estimate) </span>
<span id="cb19-10"></span>
<span id="cb19-11">est2dattab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMAverse&lt;br&gt;(linear)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_noEM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Traditional&lt;br&gt;(linear)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trad_est"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.after =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'estimate'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&amp;emsp;&amp;emsp;&amp;emsp;'</span>),</span>
<span id="cb19-17">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trad_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>, </span>
<span id="cb19-18">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>,</span>
<span id="cb19-19">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>,</span>
<span id="cb19-20">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear_noEM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No_EMint&lt;br&gt;estimate"</span>)</span>
<span id="cb19-21">               )</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="babjvbhiev" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#babjvbhiev table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#babjvbhiev thead, #babjvbhiev tbody, #babjvbhiev tfoot, #babjvbhiev tr, #babjvbhiev td, #babjvbhiev th {
  border-style: none;
}

#babjvbhiev p {
  margin: 0;
  padding: 0;
}

#babjvbhiev .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#babjvbhiev .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#babjvbhiev .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#babjvbhiev .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#babjvbhiev .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#babjvbhiev .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#babjvbhiev .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#babjvbhiev .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#babjvbhiev .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#babjvbhiev .gt_spanner_row {
  border-bottom-style: hidden;
}

#babjvbhiev .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#babjvbhiev .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#babjvbhiev .gt_from_md > :first-child {
  margin-top: 0;
}

#babjvbhiev .gt_from_md > :last-child {
  margin-bottom: 0;
}

#babjvbhiev .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#babjvbhiev .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#babjvbhiev .gt_row_group_first td {
  border-top-width: 2px;
}

#babjvbhiev .gt_row_group_first th {
  border-top-width: 2px;
}

#babjvbhiev .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#babjvbhiev .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#babjvbhiev .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_left {
  text-align: left;
}

#babjvbhiev .gt_center {
  text-align: center;
}

#babjvbhiev .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#babjvbhiev .gt_font_normal {
  font-weight: normal;
}

#babjvbhiev .gt_font_bold {
  font-weight: bold;
}

#babjvbhiev .gt_font_italic {
  font-style: italic;
}

#babjvbhiev .gt_super {
  font-size: 65%;
}

#babjvbhiev .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#babjvbhiev .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#babjvbhiev .gt_indent_1 {
  text-indent: 5px;
}

#babjvbhiev .gt_indent_2 {
  text-indent: 10px;
}

#babjvbhiev .gt_indent_3 {
  text-indent: 15px;
}

#babjvbhiev .gt_indent_4 {
  text-indent: 20px;
}

#babjvbhiev .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Traditional<br>(linear)">
        <span class="gt_column_spanner">Traditional<br>(linear)</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="   ">   </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="CMAverse<br>(linear)">
        <span class="gt_column_spanner">CMAverse<br>(linear)</span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No_EMint<br>estimate">No_EMint<br>estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="trad_est" class="gt_row gt_left">direct</td>
<td headers="estimate" class="gt_row gt_right">-0.33</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">cde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">indirect</td>
<td headers="estimate" class="gt_row gt_right">-0.10</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">total</td>
<td headers="estimate" class="gt_row gt_right">-0.43</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">te</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.428</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">prop_med</td>
<td headers="estimate" class="gt_row gt_right">0.23</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pm</td>
<td headers="linear_noEM" class="gt_row gt_right">0.235</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcmest</span>(est2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-2">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)) </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(est2)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Causal Mediation Analysis

# Outcome regression:

Call:
glm(formula = Delinquency ~ ParentSupport + StrgMoralBlfs, family = gaussian(), 
    data = getCall(x$reg.output$yreg)$data, weights = getCall(x$reg.output$yreg)$weights)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     2.4282     0.0668    36.4   &lt;2e-16 ***
ParentSupport  -0.3273     0.0185   -17.7   &lt;2e-16 ***
StrgMoralBlfs  -0.4890     0.0200   -24.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.969)

    Null deviance: 4028.6  on 2999  degrees of freedom
Residual deviance: 2904.8  on 2997  degrees of freedom
AIC: 8425

Number of Fisher Scoring iterations: 2


# Mediator regressions: 

Call:
glm(formula = StrgMoralBlfs ~ ParentSupport, family = gaussian(), 
    data = getCall(x$reg.output$mreg[[1L]])$data, weights = getCall(x$reg.output$mreg[[1L]])$weights)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     3.2145     0.0164   195.9   &lt;2e-16 ***
ParentSupport   0.2061     0.0165    12.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.807)

    Null deviance: 2546.9  on 2999  degrees of freedom
Residual deviance: 2420.6  on 2998  degrees of freedom
AIC: 7876

Number of Fisher Scoring iterations: 2


# Effect decomposition on the mean difference scale via the regression-based approach
 
Direct counterfactual imputation estimation with 
 bootstrap standard errors, percentile confidence intervals and p-values 
 
     Estimate Std.error  95% CIL 95% CIU  P.val    
cde  -0.32727   0.02071 -0.35504  -0.285 &lt;2e-16 ***
pnde -0.32727   0.02071 -0.35504  -0.285 &lt;2e-16 ***
tnde -0.32727   0.02071 -0.35504  -0.285 &lt;2e-16 ***
pnie -0.10078   0.01025 -0.11819  -0.084 &lt;2e-16 ***
tnie -0.10078   0.01025 -0.11819  -0.084 &lt;2e-16 ***
te   -0.42805   0.02439 -0.46258  -0.371 &lt;2e-16 ***
pm    0.23545   0.01995  0.20332   0.275 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(cde: controlled direct effect; pnde: pure natural direct effect; tnde: total natural direct effect; pnie: pure natural indirect effect; tnie: total natural indirect effect; te: total effect; pm: overall proportion mediated)

Relevant variable values: 
$a
[1] 1

$astar
[1] 0

$mval
$mval[[1]]
[1] 0</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>First, looking at the results, you will notice that all the CMAverse direct effect estimates are equivalent (i.e., <em>CDE</em> = <em>PNDE</em> = <em>TNDE</em>), and that both indirect effect estimates are equivalent as well (<em>PNIE</em> = <em>TNIE</em>). This is because we set <code>EMint=FALSE</code>, which means we did not specify an exposure-mediator interaction. Of course, this does not mean there is no exposure-mediator interaction in the data. On the contrary, we simulated the data to include one! Rather, it just means we ignored the possibility by essentially fixing the exposure-mediator interaction parameter to equal “0” in our model.</p>
<p>This is also what happens by default in the traditional “product of coefficients” mediation approach. In fact, you can see the estimates from both approaches converge in this case; that is, the “traditional” direct, indirect, and total effect estimates are equivalent to the comparable <em>CDE</em>, <em>PNIE</em>, and <em>TE</em> effect estimates from the CMAverse model.</p>
<p>The “pm” or “prop_med” estimates refer to “proportion mediated” or the proportion of the total effect attributable to mediation. Though they are included here to show equivalence across traditional and CMAverse output, as explained later, I will not focus much on proportion measures in this entry.</p>
<p>Also, with an exposure variable with more than two levels, note that I could have defined different meaningful contrasts (e.g., -1SD vs.&nbsp;1SD; max vs.&nbsp;min). Recall that ParentSupport is simulated as a standardized exposure variable, so by setting <code>astar=0</code> and <code>a=1</code>, I am specifying the exposure contrast as the predicted difference in Y at mean parental support values (ParentSupport=0) and +1SD parental support values (ParentSupport=1). The setting <code>mval = list(0)</code> indicates that I want controlled direct effect estimates to be calculated at m=0 (StrgMoralBlfs=0).</p>
<p>You might also wonder why confidence intervals are asymmetric around point estimates in these tables and plots. This is because “bootstrap” is the default inference method for estimating standard errors and confidence intervals <a href="https://bs1125.github.io/CMAverse/reference/cmest.html">in CMAverse</a>. Unlike the well-known “delta” method (available for some models), which calculates confidence intervals using approximations to a normal distribution, this method estimates percentile-based confidence intervals using the standard deviations of estimates from bootstrapped samples. Since indirect effect estimators (e.g., <a href="https://journals.sagepub.com/doi/full/10.1177/0956797613480187?casa_token=lnKZD-5ujc0AAAAA%3AqL5l3aA8B2BgzQ7cKoBvqkNAx8BA7T7G-ZUR3JwLffMuJn3ensuaDZF3tSn3kmiZny-zhMFAumSPysA"><em>ab</em> product term</a> or <a href="https://imai.fas.harvard.edu/research/files/BaronKenny.pdf">potential outcomes resampling procedures</a>) are known to generate non-normally distributed estimates, bootstrapped confidence intervals are <a href="https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2014.01549/full#B7a">generally preferred in mediation tests</a> because they better represent the asymptotic distributions generated by indirect effect estimators.</p>
</section>
<section id="sec-CMAlin-int" class="level2">
<h2 class="anchored" data-anchor-id="sec-CMAlin-int">Linear CMA model, with <em>EMint</em></h2>
<p>Now, let’s estimate another linear model in CMAverse but instead allow for the possibility of an exposure-mediator interaction by setting <code>EMint=TRUE</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb23-2">est3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cmest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rb"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>,</span>
<span id="cb23-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mediator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">EMint =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb23-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mreg =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yreg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>,</span>
<span id="cb23-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">astar =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mval =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb23-6">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imputation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inference =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bootstrap"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nboot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" aria-controls="tabset-4-1" aria-selected="true">Results: linear with EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" aria-controls="tabset-4-2" aria-selected="false">Default plot: linear with EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" aria-controls="tabset-4-3" aria-selected="false">Custom plot: linear with EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" aria-controls="tabset-4-4" aria-selected="false">Full output: linear with EMint</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">est3dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>effect.pe) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>) </span>
<span id="cb24-2"></span>
<span id="cb24-3">est3dattab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(est2dattab, est3dat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_EM"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est3$effect.pe"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intref(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intmed(prop)"</span>, </span>
<span id="cb24-6">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb24-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trad_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(trad_est), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, trad_est)</span>
<span id="cb24-9">  )</span>
<span id="cb24-10"></span>
<span id="cb24-11">est3dattab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb24-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMAverse&lt;br&gt;(linear)"</span>), </span>
<span id="cb24-14">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_noEM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_EM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Traditional&lt;br&gt;(linear)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trad_est"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.after =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'estimate'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&amp;emsp;&amp;emsp;&amp;emsp;'</span>),</span>
<span id="cb24-18">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trad_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>, </span>
<span id="cb24-19">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>,</span>
<span id="cb24-20">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>,</span>
<span id="cb24-21">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear_noEM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No_EMint&lt;br&gt;estimate"</span>),</span>
<span id="cb24-22">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear_EM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EMint&lt;br&gt;estimate"</span>)</span>
<span id="cb24-23">               )</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="babjvbhiev" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#babjvbhiev table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#babjvbhiev thead, #babjvbhiev tbody, #babjvbhiev tfoot, #babjvbhiev tr, #babjvbhiev td, #babjvbhiev th {
  border-style: none;
}

#babjvbhiev p {
  margin: 0;
  padding: 0;
}

#babjvbhiev .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#babjvbhiev .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#babjvbhiev .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#babjvbhiev .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#babjvbhiev .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#babjvbhiev .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#babjvbhiev .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#babjvbhiev .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#babjvbhiev .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#babjvbhiev .gt_spanner_row {
  border-bottom-style: hidden;
}

#babjvbhiev .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#babjvbhiev .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#babjvbhiev .gt_from_md > :first-child {
  margin-top: 0;
}

#babjvbhiev .gt_from_md > :last-child {
  margin-bottom: 0;
}

#babjvbhiev .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#babjvbhiev .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#babjvbhiev .gt_row_group_first td {
  border-top-width: 2px;
}

#babjvbhiev .gt_row_group_first th {
  border-top-width: 2px;
}

#babjvbhiev .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#babjvbhiev .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#babjvbhiev .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_left {
  text-align: left;
}

#babjvbhiev .gt_center {
  text-align: center;
}

#babjvbhiev .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#babjvbhiev .gt_font_normal {
  font-weight: normal;
}

#babjvbhiev .gt_font_bold {
  font-weight: bold;
}

#babjvbhiev .gt_font_italic {
  font-style: italic;
}

#babjvbhiev .gt_super {
  font-size: 65%;
}

#babjvbhiev .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#babjvbhiev .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#babjvbhiev .gt_indent_1 {
  text-indent: 5px;
}

#babjvbhiev .gt_indent_2 {
  text-indent: 10px;
}

#babjvbhiev .gt_indent_3 {
  text-indent: 15px;
}

#babjvbhiev .gt_indent_4 {
  text-indent: 20px;
}

#babjvbhiev .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Traditional<br>(linear)">
        <span class="gt_column_spanner">Traditional<br>(linear)</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="   ">   </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="CMAverse<br>(linear)">
        <span class="gt_column_spanner">CMAverse<br>(linear)</span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No_EMint<br>estimate">No_EMint<br>estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="EMint<br>estimate">EMint<br>estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="trad_est" class="gt_row gt_left">direct</td>
<td headers="estimate" class="gt_row gt_right">-0.33</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">cde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-1.1747</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-0.3325</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-0.2784</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">indirect</td>
<td headers="estimate" class="gt_row gt_right">-0.10</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td>
<td headers="linear_EM" class="gt_row gt_right">-0.0864</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td>
<td headers="linear_EM" class="gt_row gt_right">-0.0322</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">total</td>
<td headers="estimate" class="gt_row gt_right">-0.43</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">te</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.428</td>
<td headers="linear_EM" class="gt_row gt_right">-0.3647</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">intref</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">0.8422</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">intmed</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">0.0541</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcmest</span>(est3) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-2">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)) </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#save estimates and intervals data</span></span>
<span id="cb26-2">est3dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est3[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>)</span>
<span id="cb26-4"></span>
<span id="cb26-5"></span>
<span id="cb26-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop proportion estimates</span></span>
<span id="cb26-7">est3dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intref(prop)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intmed(prop)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(CMA_est, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intmed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"intref"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"te"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cde"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reorder the coefficients so that the largest is at the top of the plot</span></span>
<span id="cb26-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mutate(term = fct_reorder(CMA_est, effect.pe)) %&gt;%</span></span>
<span id="cb26-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(effect.pe, CMA_est)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb26-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbarh</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> effect.ci.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> effect.ci.high), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add in a dotted line at zero</span></span>
<span id="cb26-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb26-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated effects on linear difference scale"</span>,</span>
<span id="cb26-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb26-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect estimates from causal mediation decomposition"</span></span>
<span id="cb26-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb26-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(est3)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Causal Mediation Analysis

# Outcome regression:

Call:
glm(formula = Delinquency ~ ParentSupport + StrgMoralBlfs + ParentSupport * 
    StrgMoralBlfs, family = gaussian(), data = getCall(x$reg.output$yreg)$data, 
    weights = getCall(x$reg.output$yreg)$weights)

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   2.1496     0.0678    31.7   &lt;2e-16 ***
ParentSupport                -1.1747     0.0634   -18.5   &lt;2e-16 ***
StrgMoralBlfs                -0.4190     0.0200   -20.9   &lt;2e-16 ***
ParentSupport:StrgMoralBlfs   0.2626     0.0189    13.9   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.911)

    Null deviance: 4028.6  on 2999  degrees of freedom
Residual deviance: 2728.2  on 2996  degrees of freedom
AIC: 8239

Number of Fisher Scoring iterations: 2


# Mediator regressions: 

Call:
glm(formula = StrgMoralBlfs ~ ParentSupport, family = gaussian(), 
    data = getCall(x$reg.output$mreg[[1L]])$data, weights = getCall(x$reg.output$mreg[[1L]])$weights)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     3.2145     0.0164   195.9   &lt;2e-16 ***
ParentSupport   0.2061     0.0165    12.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.807)

    Null deviance: 2546.9  on 2999  degrees of freedom
Residual deviance: 2420.6  on 2998  degrees of freedom
AIC: 7876

Number of Fisher Scoring iterations: 2


# Effect decomposition on the mean difference scale via the regression-based approach
 
Direct counterfactual imputation estimation with 
 bootstrap standard errors, percentile confidence intervals and p-values 
 
              Estimate Std.error   95% CIL 95% CIU  P.val    
cde          -1.174713  0.111557 -1.393855  -1.036 &lt;2e-16 ***
pnde         -0.332465  0.016572 -0.354123  -0.297 &lt;2e-16 ***
tnde         -0.278356  0.013193 -0.295906  -0.252 &lt;2e-16 ***
pnie         -0.086354  0.007336 -0.098157  -0.074 &lt;2e-16 ***
tnie         -0.032245  0.006340 -0.037651  -0.018 &lt;2e-16 ***
te           -0.364710  0.014081 -0.380222  -0.331 &lt;2e-16 ***
intref        0.842248  0.099992  0.722433   1.046 &lt;2e-16 ***
intmed        0.054109  0.008268  0.042002   0.067 &lt;2e-16 ***
cde(prop)     3.220949  0.264090  2.949594   3.800 &lt;2e-16 ***
intref(prop) -2.309362  0.249934 -2.851880  -2.049 &lt;2e-16 ***
intmed(prop) -0.148362  0.020618 -0.180025  -0.120 &lt;2e-16 ***
pnie(prop)    0.236775  0.018755  0.209000   0.273 &lt;2e-16 ***
pm            0.088413  0.018417  0.047611   0.107 &lt;2e-16 ***
int          -2.457724  0.267019 -3.026326  -2.169 &lt;2e-16 ***
pe           -2.220949  0.264090 -2.800203  -1.950 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(cde: controlled direct effect; pnde: pure natural direct effect; tnde: total natural direct effect; pnie: pure natural indirect effect; tnie: total natural indirect effect; te: total effect; intref: reference interaction; intmed: mediated interaction; cde(prop): proportion cde; intref(prop): proportion intref; intmed(prop): proportion intmed; pnie(prop): proportion pnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)

Relevant variable values: 
$a
[1] 1

$astar
[1] 0

$mval
$mval[[1]]
[1] 0</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>First, a comparison of the tabled results reveals substantial differences in estimates across the linear models with and without an “EMint” term. This is a signal that there is a non-negligible exposure-mediator interaction in these simulated data. Recall, the initial <code>EMint=FALSE</code> specification forced our model to fit a constant effect of parental support on delinquency across all values of moral beliefs. In contrast, specifying <code>EMint=TRUE</code> made the model more flexible by permitting it to fit different conditional average linear effects of parental support on delinquency across values of strong moral beliefs. If no such differences in effects had existed in the data, the linear interaction term would have been near zero, and both sets of linear model results would have converged.<sup>7</sup></p>
<p>Second, when we ignored the exposure-mediator interaction (i.e, by using traditional <em>ab</em> method or by setting <code>EMint=FALSE</code> in CMAverse), the “proportion mediated” estimate was about 24%. After allowing for the possibility of a nonzero exposure-mediator interaction (with <code>EMint=TRUE</code>), the proportion mediated estimate dropped to 7.2%. What happened? Did the indirect effect shrink after including the interaction term?</p>
<p>To understand what is happening here, recall the “<em>TNIE</em>” component, which represents the “total” indirect effect of X on Y through M, is a composite measure of the total indirect effect comprised of both the “pure” indirect effect component (<em>PNIE</em>) and the part of an exposure-mediator interaction that is due to mediation (<em>INT<sub>med</sub></em>). Now, check out the <em>PNIE</em> and <em>INT<sub>med</sub></em> effect estimates, which are similar in magnitude but in opposite directions. As a result, these two indirect effect components largely cancel each other out (-0.09 vs.&nbsp;0.06), resulting in a very small “total” natural indirect effect estimate (<em>TNIE</em>) and, likewise, a small proportion mediated estimated (<em>PM</em> = <em>TNIE</em>/<em>TE</em>). Meanwhile, the proportion of the total effect that is due to the pure indirect effect (<em>PNIE</em>) remains approximately 24%.</p>
<p>Similarly, the results also show negative direct effect estimates (<em>CDE</em>; <em>PNDE</em>) and a positive reference interaction (<em>INT<sub>ref</sub></em>) effect. The presence of such non-monotonic effect estimates, or effects operating in different directions, undermines the utility of “proportion mediated” estimates. While proportion mediated estimators can be useful for interpreting relative contributions of components under certain assumptions and conditions (e.g., no opposite-signed direct or indirect effects), too often those assumptions are untenable and, when they are, the properties of these estimators become unreliable. For this reason and others,<sup>8</sup> I will exclude most proportion estimates (except proportion mediated or <em>PM</em>) in custom tables and plots and will largely avoid discussing proportion estimates moving forward.</p>
<p>Third, notice that the <em>CDE</em>(M=0) estimate is much larger and is no longer equivalent to the <em>PNDE</em> or <em>TNDE</em> estimates in the linear model with <code>EMint=TRUE</code>. This is because the effect of parental support varies across values of the mediator, and we estimated the <em>CDE</em> at M=0, or at the lowest value of strong moral beliefs, where the effect of parental support is strongest. You can see this in the regression prediction plots presented earlier. In fact, if you look closely at the linear prediction plot, you will notice that the slope of the “M=0” line is equivalent to the <em>CDE</em> estimate from this model (<em>CDE</em> = -1.17); that is, with a ParentSupport change from “0” to “1” units, delinquency is predicted to change by -1.17 units. To help visualize this, I regenerated the linear prediction plot from earlier and added lines to help visualize the slope of this <em>CDE</em> estimate.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb29-2"></span>
<span id="cb29-3">segdat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x3 =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x4 =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>, </span>
<span id="cb29-4">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.03</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y3 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y4 =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span>)</span>
<span id="cb29-5"></span>
<span id="cb29-6">plot_lm2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y1), </span>
<span id="cb29-8">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maroon"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb29-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y2),</span>
<span id="cb29-10">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maroon"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb29-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> segdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y4),</span>
<span id="cb29-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maroon"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb29-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CDE(M=0) = -1.17"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maroon"</span>, </span>
<span id="cb29-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at this plot, I am hoping it is clear that the magnitude of the <em>CDE</em> estimate would have been much smaller or even negligible if we had instead estimated it at a different level of strong moral beliefs (e.g., M=4).</p>
<p>Unlike the <em>CDE</em>, the <em>PNDE</em> estimate remains largely unchanged across the linear models that do and do not specify an exposure-mediator interaction. Substantively, the <em>PNDE</em> indicates that doing <code>a=1</code> instead of <code>astar=0</code>, or increasing from mean levels of parental support to one-SD unit above the mean levels of parental support, is predicted to reduce delinquency by -0.33 units on the linear difference scale in the absence of the exposure. However, recall that <em>PNDE</em> is estimating Y1M<sub>A=0</sub> - Y0M<sub>A=0</sub> or setting M to value it is expected to be when A=0. So, changing the exposure contrast, say, to <code>astar=-1</code> and <code>a=0</code>, would change the <em>PNDE</em> because it would change the value at which M is set (e.g., estimating Y1M<sub>X=-1</sub> - Y0M<sub>X=-1</sub> instead); in contrast, changing the exposure contrast would have no effect on the <em>CDE</em>(M=0) in a linear model.</p>
<p>Fourth, recall that in a linear model, the sum of <em>PIE</em> and <em>TNIE</em> estimates should equal the sum of the <em>TNDE</em> and <em>PNIE</em> estimates, and each of these sums should equal to the total effect (<em>TE</em>) estimate. I explained this before; you can check to see that it holds true here.</p>
<p>Fifth, notice how small in magnitude the pure indirect (<em>PNIE</em>) and mediated interaction (<em>INT<sub>med</sub></em>) components are relative to the pure natural direct (<em>PNDE</em>) and reference interaction (<em>INT<sub>ref</sub></em>) components. Though there is some evidence of mediation in these simulated data, it would seem that parental support primarily causes delinquency directly and conditionally via unmediated interaction with strong moral beliefs.</p>
<p>Finally, I hope one lesson is apparent by now: If you wish to interpret any of these estimates, or indirect and interaction effects generally, then it is important to know precisely what each estimate means,<sup>9</sup> which causal contrasts you do (and do not) wish to make, and what assumptions your model and you are making if interpreting them as causal effects. Such determinations require an understanding of the various decomposition components described earlier and careful consideration of which components align best with your causal estimand of interest.</p>
</section>
<section id="sec-CMAnonlin-noint" class="level2">
<h2 class="anchored" data-anchor-id="sec-CMAnonlin-noint">Nonlinear CMA model, no <em>EMint</em></h2>
<p>Now, we already know the linear model does not provide a good approximation for the data generating processes underlying these simulated data. This is frequently the case when analyzing real-world criminological data as well. Yet, given the familiarity that many readers will likely have with linear models, my hope is that the relatively poor-fitting linear models above will help ease the transition to better-fitting but more complex nonlinear models.</p>
<p>Below, I conclude by briefly presenting CMAverse models with and without EM interactions again but, this time, I will specify a Poisson distribution for the outcome variable. This means that the predicted contrasts will be described on the event rate ratio scale instead of the linear difference scale.<sup>10</sup> As you will soon see, the output and interpretations get a bit more complicated with nonlinear models due to changes in the outcome scale (and related issues like <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7986756/">noncollapsibility</a> of certain estimates).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb30-2">est4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cmest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rb"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>,</span>
<span id="cb30-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mediator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">EMint =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb30-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mreg =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yreg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb30-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">astar =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mval =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb30-6">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imputation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inference =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bootstrap"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nboot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" aria-controls="tabset-5-1" aria-selected="true">Results: nonlinear no EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" aria-controls="tabset-5-2" aria-selected="false">Default plot: nonlinear no EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" aria-controls="tabset-5-3" aria-selected="false">Full output: nonlinear no EMint</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">est4dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>effect.pe) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cde"</span>,CMA_est2),</span>
<span id="cb31-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnde"</span>,CMA_est), </span>
<span id="cb31-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnde"</span>,CMA_est),</span>
<span id="cb31-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnie"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnie"</span>,CMA_est),</span>
<span id="cb31-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnie"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnie"</span>,CMA_est),</span>
<span id="cb31-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rte"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"te"</span>,CMA_est)</span>
<span id="cb31-8">  )</span>
<span id="cb31-9"></span>
<span id="cb31-10">est4dattab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(est3dattab, est4dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nonlin_noEM"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est4$effect.pe"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb31-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(CMA_est2), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, CMA_est2)</span>
<span id="cb31-14">  )</span>
<span id="cb31-15">  </span>
<span id="cb31-16"></span>
<span id="cb31-17">est4dattab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMAverse&lt;br&gt;(nonlinear)"</span>), </span>
<span id="cb31-20">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nonlin_noEM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMAverse&lt;br&gt;(linear)"</span>), </span>
<span id="cb31-22">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_noEM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_EM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Traditional&lt;br&gt;(linear)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trad_est"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.after =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'estimate'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&amp;emsp;&amp;emsp;&amp;emsp;'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank2'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CMA_est2'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank2'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&amp;emsp;&amp;emsp;&amp;emsp;'</span>), </span>
<span id="cb31-28">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trad_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>, </span>
<span id="cb31-29">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>,</span>
<span id="cb31-30">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>,</span>
<span id="cb31-31">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>,</span>
<span id="cb31-32">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear_noEM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No_EMint&lt;br&gt;estimate"</span>),</span>
<span id="cb31-33">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear_EM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EMint&lt;br&gt;estimate"</span>),</span>
<span id="cb31-34">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nonlin_noEM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No_EMint&lt;br&gt;estimate"</span>)</span>
<span id="cb31-35">               )</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="babjvbhiev" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#babjvbhiev table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#babjvbhiev thead, #babjvbhiev tbody, #babjvbhiev tfoot, #babjvbhiev tr, #babjvbhiev td, #babjvbhiev th {
  border-style: none;
}

#babjvbhiev p {
  margin: 0;
  padding: 0;
}

#babjvbhiev .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#babjvbhiev .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#babjvbhiev .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#babjvbhiev .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#babjvbhiev .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#babjvbhiev .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#babjvbhiev .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#babjvbhiev .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#babjvbhiev .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#babjvbhiev .gt_spanner_row {
  border-bottom-style: hidden;
}

#babjvbhiev .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#babjvbhiev .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#babjvbhiev .gt_from_md > :first-child {
  margin-top: 0;
}

#babjvbhiev .gt_from_md > :last-child {
  margin-bottom: 0;
}

#babjvbhiev .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#babjvbhiev .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#babjvbhiev .gt_row_group_first td {
  border-top-width: 2px;
}

#babjvbhiev .gt_row_group_first th {
  border-top-width: 2px;
}

#babjvbhiev .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#babjvbhiev .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#babjvbhiev .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_left {
  text-align: left;
}

#babjvbhiev .gt_center {
  text-align: center;
}

#babjvbhiev .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#babjvbhiev .gt_font_normal {
  font-weight: normal;
}

#babjvbhiev .gt_font_bold {
  font-weight: bold;
}

#babjvbhiev .gt_font_italic {
  font-style: italic;
}

#babjvbhiev .gt_super {
  font-size: 65%;
}

#babjvbhiev .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#babjvbhiev .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#babjvbhiev .gt_indent_1 {
  text-indent: 5px;
}

#babjvbhiev .gt_indent_2 {
  text-indent: 10px;
}

#babjvbhiev .gt_indent_3 {
  text-indent: 15px;
}

#babjvbhiev .gt_indent_4 {
  text-indent: 20px;
}

#babjvbhiev .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Traditional<br>(linear)">
        <span class="gt_column_spanner">Traditional<br>(linear)</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="   ">   </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="CMAverse<br>(linear)">
        <span class="gt_column_spanner">CMAverse<br>(linear)</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="   ">   </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="CMAverse<br>(nonlinear)">
        <span class="gt_column_spanner">CMAverse<br>(nonlinear)</span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No_EMint<br>estimate">No_EMint<br>estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="EMint<br>estimate">EMint<br>estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No_EMint<br>estimate">No_EMint<br>estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="trad_est" class="gt_row gt_left">direct</td>
<td headers="estimate" class="gt_row gt_right">-0.33</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">cde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-1.1747</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rcde</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.683</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-0.3325</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rpnde</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.683</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-0.2784</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rtnde</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.683</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">indirect</td>
<td headers="estimate" class="gt_row gt_right">-0.10</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td>
<td headers="linear_EM" class="gt_row gt_right">-0.0864</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rpnie</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.917</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td>
<td headers="linear_EM" class="gt_row gt_right">-0.0322</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rtnie</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.917</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">total</td>
<td headers="estimate" class="gt_row gt_right">-0.43</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">te</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.428</td>
<td headers="linear_EM" class="gt_row gt_right">-0.3647</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rte</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.626</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">intref</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">0.8422</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">--</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">intmed</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">0.0541</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">--</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcmest</span>(est4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-2">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(est4)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Causal Mediation Analysis

# Outcome regression:

Call:
glm(formula = Delinquency ~ ParentSupport + StrgMoralBlfs, family = poisson(), 
    data = getCall(x$reg.output$yreg)$data, weights = getCall(x$reg.output$yreg)$weights)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     0.9880     0.0540    18.3   &lt;2e-16 ***
ParentSupport  -0.3816     0.0202   -18.9   &lt;2e-16 ***
StrgMoralBlfs  -0.4178     0.0175   -23.8   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4367.7  on 2999  degrees of freedom
Residual deviance: 3219.5  on 2997  degrees of freedom
AIC: 6788

Number of Fisher Scoring iterations: 5


# Mediator regressions: 

Call:
glm(formula = StrgMoralBlfs ~ ParentSupport, family = gaussian(), 
    data = getCall(x$reg.output$mreg[[1L]])$data, weights = getCall(x$reg.output$mreg[[1L]])$weights)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     3.2145     0.0164   195.9   &lt;2e-16 ***
ParentSupport   0.2061     0.0165    12.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.807)

    Null deviance: 2546.9  on 2999  degrees of freedom
Residual deviance: 2420.6  on 2998  degrees of freedom
AIC: 7876

Number of Fisher Scoring iterations: 2


# Effect decomposition on the rate ratio scale via the regression-based approach
 
Direct counterfactual imputation estimation with 
 bootstrap standard errors, percentile confidence intervals and p-values 
 
      Estimate Std.error  95% CIL 95% CIU  P.val    
Rcde  0.682781  0.013782 0.664411   0.711 &lt;2e-16 ***
Rpnde 0.682781  0.013782 0.664411   0.711 &lt;2e-16 ***
Rtnde 0.682781  0.013782 0.664411   0.711 &lt;2e-16 ***
Rpnie 0.917494  0.006533 0.906926   0.928 &lt;2e-16 ***
Rtnie 0.917494  0.006533 0.906926   0.928 &lt;2e-16 ***
Rte   0.626448  0.013760 0.607616   0.654 &lt;2e-16 ***
pm    0.150804  0.012626 0.131287   0.177 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Rcde: controlled direct effect rate ratio; Rpnde: pure natural direct effect rate ratio; Rtnde: total natural direct effect rate ratio; Rpnie: pure natural indirect effect rate ratio; Rtnie: total natural indirect effect rate ratio; Rte: total effect rate ratio; pm: overall proportion mediated)

Relevant variable values: 
$a
[1] 1

$astar
[1] 0

$mval
$mval[[1]]
[1] 0</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>It should be immediately apparent that the estimates from this model look different from the estimates reported with the linear models - each estimate is now designated with an “R” prefix (e.g., “Rcde”). This is because the nonlinear model estimates describe relative effects on the rate ratio scale (or risk ratio for logistic outcome models) instead of effects on the linear difference scale.</p>
<p>You can find various accessible discussions of interpreting risk and rate ratio estimates online; for a couple examples, see <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8351073/">here</a>, <a href="https://sphweb.bumc.bu.edu/otlt/mph-modules/ep/ep713_association/ep713_association_print.html">here</a>, and <a href="https://sph.unc.edu/wp-content/uploads/sites/112/2015/07/nciph_ERIC7.pdf">here</a>. Briefly, rate ratio estimates less than one indicate negative effects; estimates equal to one indicate null effects; and estimates greater than one indicate positive effects.</p>
<p>So, this model predicts a moderate direct effect of parental support on delinquency; increasing parental support from its mean (astar=0) to one standard deviation above its mean (a=1) is predicted to directly reduce delinquency to 0.68 times the rate at the mean (i.e., at astar=0). In comparison, the model predicts a modest indirect effect of parental support on delinquency through moral beliefs; similarly increasing parental support from astar=0 to a=1 is predicted to indirectly reduce delinquency to 0.92 times the rate at the mean (i.e., at astar=0).</p>
<p>Though the outcome scale and resulting estimates changed, some patterns should be familiar by now. For instance, all the direct effect estimates are equivalent (i.e., <em>CDE</em> = <em>PNDE</em> = <em>TNDE</em>), as are the indirect effect estimates (<em>PNIE</em> = <em>TNIE</em>). Also, the results lack any <em>INT<sub>med</sub></em> or <em>INT<sub>ref</sub></em> estimates. Again, these patterns are expected because we set <code>EMint=FALSE</code>, which means we constrained the model to ignore any exposure-mediator interaction by essentially fixing the interaction parameter to zero. In the final model below, I relax this constraint by specifying <code>EMint = TRUE</code> to include an exposure-mediator interaction term on the estimation scale.</p>
</section>
<section id="sec-CMAnonlin-int" class="level2">
<h2 class="anchored" data-anchor-id="sec-CMAnonlin-int">Nonlinear CMA model, with <em>EMint</em></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb35-2">est5 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cmest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rb"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>,</span>
<span id="cb35-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mediator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">EMint =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb35-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mreg =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yreg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb35-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">astar =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mval =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb35-6">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imputation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inference =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bootstrap"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nboot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" aria-controls="tabset-6-1" aria-selected="true">Results: nonlinear with EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" aria-controls="tabset-6-2" aria-selected="false">Default plot: nonlinear with EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" aria-controls="tabset-6-3" aria-selected="false">Risk ratio plot: nonlinear with EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" aria-controls="tabset-6-4" aria-selected="false">Excess risk plot: nonlinear, with EMint</a></li><li class="nav-item"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" aria-controls="tabset-6-5" aria-selected="false">Full output: nonlinear with EMint</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1">est5dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est5<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>effect.pe) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cde"</span>,CMA_est2),</span>
<span id="cb36-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnde"</span>,CMA_est), </span>
<span id="cb36-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnde"</span>,CMA_est),</span>
<span id="cb36-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnie"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnie"</span>,CMA_est),</span>
<span id="cb36-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnie"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnie"</span>,CMA_est),</span>
<span id="cb36-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rte"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"te"</span>,CMA_est)</span>
<span id="cb36-8">  )</span>
<span id="cb36-9"></span>
<span id="cb36-10">est5dattab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">full_join</span>(est4dattab, est5dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">join_by</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est2"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nonlin_EM"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est5$effect.pe"</span>,</span>
<span id="cb36-12">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est.x"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est.y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb36-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed(prop)"</span>, </span>
<span id="cb36-15">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb36-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb36-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trad_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(trad_est), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, trad_est), </span>
<span id="cb36-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(CMA_est), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>, CMA_est)</span>
<span id="cb36-19">  )</span>
<span id="cb36-20"></span>
<span id="cb36-21">est5dattab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb36-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMAverse&lt;br&gt;(nonlinear)"</span>), </span>
<span id="cb36-24">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nonlin_noEM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nonlin_EM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMAverse&lt;br&gt;(linear)"</span>), </span>
<span id="cb36-26">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_noEM"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear_EM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Traditional&lt;br&gt;(linear)"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trad_est"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.after =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'estimate'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&amp;emsp;&amp;emsp;&amp;emsp;'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_add</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank2'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CMA_est2'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb36-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blank2'</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'&amp;emsp;&amp;emsp;&amp;emsp;'</span>), </span>
<span id="cb36-32">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trad_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>, </span>
<span id="cb36-33">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>,</span>
<span id="cb36-34">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>,</span>
<span id="cb36-35">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"estimate"</span>,</span>
<span id="cb36-36">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear_noEM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No_EMint&lt;br&gt;estimate"</span>),</span>
<span id="cb36-37">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linear_EM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EMint&lt;br&gt;estimate"</span>),</span>
<span id="cb36-38">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nonlin_noEM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No_EMint&lt;br&gt;estimate"</span>),</span>
<span id="cb36-39">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nonlin_EM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EMint&lt;br&gt;estimate"</span>)</span>
<span id="cb36-40">               )</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="babjvbhiev" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#babjvbhiev table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#babjvbhiev thead, #babjvbhiev tbody, #babjvbhiev tfoot, #babjvbhiev tr, #babjvbhiev td, #babjvbhiev th {
  border-style: none;
}

#babjvbhiev p {
  margin: 0;
  padding: 0;
}

#babjvbhiev .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#babjvbhiev .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#babjvbhiev .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#babjvbhiev .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#babjvbhiev .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#babjvbhiev .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#babjvbhiev .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#babjvbhiev .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#babjvbhiev .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#babjvbhiev .gt_spanner_row {
  border-bottom-style: hidden;
}

#babjvbhiev .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#babjvbhiev .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#babjvbhiev .gt_from_md > :first-child {
  margin-top: 0;
}

#babjvbhiev .gt_from_md > :last-child {
  margin-bottom: 0;
}

#babjvbhiev .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#babjvbhiev .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#babjvbhiev .gt_row_group_first td {
  border-top-width: 2px;
}

#babjvbhiev .gt_row_group_first th {
  border-top-width: 2px;
}

#babjvbhiev .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#babjvbhiev .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#babjvbhiev .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_left {
  text-align: left;
}

#babjvbhiev .gt_center {
  text-align: center;
}

#babjvbhiev .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#babjvbhiev .gt_font_normal {
  font-weight: normal;
}

#babjvbhiev .gt_font_bold {
  font-weight: bold;
}

#babjvbhiev .gt_font_italic {
  font-style: italic;
}

#babjvbhiev .gt_super {
  font-size: 65%;
}

#babjvbhiev .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#babjvbhiev .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#babjvbhiev .gt_indent_1 {
  text-indent: 5px;
}

#babjvbhiev .gt_indent_2 {
  text-indent: 10px;
}

#babjvbhiev .gt_indent_3 {
  text-indent: 15px;
}

#babjvbhiev .gt_indent_4 {
  text-indent: 20px;
}

#babjvbhiev .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Traditional<br>(linear)">
        <span class="gt_column_spanner">Traditional<br>(linear)</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="   ">   </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="CMAverse<br>(linear)">
        <span class="gt_column_spanner">CMAverse<br>(linear)</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="   ">   </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="CMAverse<br>(nonlinear)">
        <span class="gt_column_spanner">CMAverse<br>(nonlinear)</span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No_EMint<br>estimate">No_EMint<br>estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="EMint<br>estimate">EMint<br>estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="No_EMint<br>estimate">No_EMint<br>estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="EMint<br>estimate">EMint<br>estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="trad_est" class="gt_row gt_left">direct</td>
<td headers="estimate" class="gt_row gt_right">-0.33</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">cde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-1.1747</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rcde</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.683</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.6841</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-0.3325</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rpnde</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.683</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.6827</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnde</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.327</td>
<td headers="linear_EM" class="gt_row gt_right">-0.2784</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rtnde</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.683</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.6826</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">indirect</td>
<td headers="estimate" class="gt_row gt_right">-0.10</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">pnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td>
<td headers="linear_EM" class="gt_row gt_right">-0.0864</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rpnie</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.917</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.9174</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">tnie</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.101</td>
<td headers="linear_EM" class="gt_row gt_right">-0.0322</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rtnie</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.917</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.9173</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">total</td>
<td headers="estimate" class="gt_row gt_right">-0.43</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">te</td>
<td headers="linear_noEM" class="gt_row gt_right">-0.428</td>
<td headers="linear_EM" class="gt_row gt_right">-0.3647</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">Rte</td>
<td headers="nonlin_noEM" class="gt_row gt_right">0.626</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.6262</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">intref</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">0.8422</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">--</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td>
<td headers="nonlin_EM" class="gt_row gt_right">NA</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">intmed</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">0.0541</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">--</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td>
<td headers="nonlin_EM" class="gt_row gt_right">NA</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">--</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">NA</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">ERcde</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td>
<td headers="nonlin_EM" class="gt_row gt_right">-1.1268</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">--</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">NA</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">ERintref</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.8094</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">--</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">NA</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">ERintmed</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.0261</td></tr>
    <tr><td headers="trad_est" class="gt_row gt_left">--</td>
<td headers="estimate" class="gt_row gt_right">NA</td>
<td headers="blank" class="gt_row gt_right"></td>
<td headers="CMA_est" class="gt_row gt_left">--</td>
<td headers="linear_noEM" class="gt_row gt_right">NA</td>
<td headers="linear_EM" class="gt_row gt_right">NA</td>
<td headers="blank2" class="gt_row gt_right"></td>
<td headers="CMA_est2" class="gt_row gt_left">ERpnie</td>
<td headers="nonlin_noEM" class="gt_row gt_right">NA</td>
<td headers="nonlin_EM" class="gt_row gt_right">-0.0826</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcmest</span>(est5) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-2">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#save estimates and intervals data</span></span>
<span id="cb38-2">est5dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est5[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb38-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>)</span>
<span id="cb38-4"></span>
<span id="cb38-5"></span>
<span id="cb38-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop proportion estimates</span></span>
<span id="cb38-7">est5dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb38-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref(prop)"</span>,</span>
<span id="cb38-9">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed(prop)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>, </span>
<span id="cb38-10">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb38-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(CMA_est, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rte"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcde"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb38-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reorder the coefficients so that the largest is at the top of the plot</span></span>
<span id="cb38-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mutate(term = fct_reorder(CMA_est, effect.pe)) %&gt;%</span></span>
<span id="cb38-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(effect.pe, CMA_est)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb38-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbarh</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> effect.ci.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> effect.ci.high), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add in a dotted line at zero</span></span>
<span id="cb38-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb38-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb38-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated effects on risk ratio scale"</span>,</span>
<span id="cb38-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb38-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect estimates from causal mediation decomposition (risk ratios)"</span></span>
<span id="cb38-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb38-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop proportion estimates</span></span>
<span id="cb39-2">est5dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb39-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref(prop)"</span>,</span>
<span id="cb39-4">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed(prop)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>, </span>
<span id="cb39-5">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rte"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcde"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb39-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(CMA_est, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb39-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reorder the coefficients so that the largest is at the top of the plot</span></span>
<span id="cb39-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mutate(term = fct_reorder(CMA_est, effect.pe)) %&gt;%</span></span>
<span id="cb39-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(effect.pe, CMA_est)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb39-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbarh</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> effect.ci.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> effect.ci.high), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add in a dotted line at zero</span></span>
<span id="cb39-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb39-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated effects on excess risks scale"</span>,</span>
<span id="cb39-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb39-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect estimates from causal mediation decomposition (excess risks)"</span></span>
<span id="cb39-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb39-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(est5)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Causal Mediation Analysis

# Outcome regression:

Call:
glm(formula = Delinquency ~ ParentSupport + StrgMoralBlfs + ParentSupport * 
    StrgMoralBlfs, family = poisson(), data = getCall(x$reg.output$yreg)$data, 
    weights = getCall(x$reg.output$yreg)$weights)

Coefficients:
                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                  0.989580   0.064119   15.43  &lt; 2e-16 ***
ParentSupport               -0.379579   0.047346   -8.02  1.1e-15 ***
StrgMoralBlfs               -0.418358   0.020744  -20.17  &lt; 2e-16 ***
ParentSupport:StrgMoralBlfs -0.000758   0.016197   -0.05     0.96    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 4367.7  on 2999  degrees of freedom
Residual deviance: 3219.5  on 2996  degrees of freedom
AIC: 6790

Number of Fisher Scoring iterations: 5


# Mediator regressions: 

Call:
glm(formula = StrgMoralBlfs ~ ParentSupport, family = gaussian(), 
    data = getCall(x$reg.output$mreg[[1L]])$data, weights = getCall(x$reg.output$mreg[[1L]])$weights)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     3.2145     0.0164   195.9   &lt;2e-16 ***
ParentSupport   0.2061     0.0165    12.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.807)

    Null deviance: 2546.9  on 2999  degrees of freedom
Residual deviance: 2420.6  on 2998  degrees of freedom
AIC: 7876

Number of Fisher Scoring iterations: 2


# Effect decomposition on the rate ratio scale via the regression-based approach
 
Direct counterfactual imputation estimation with 
 bootstrap standard errors, percentile confidence intervals and p-values 
 
                Estimate Std.error   95% CIL 95% CIU  P.val    
Rcde            0.684149  0.037105  0.598769   0.725 &lt;2e-16 ***
Rpnde           0.682662  0.013715  0.665171   0.712 &lt;2e-16 ***
Rtnde           0.682556  0.014239  0.662567   0.713 &lt;2e-16 ***
Rpnie           0.917396  0.006654  0.906475   0.930 &lt;2e-16 ***
Rtnie           0.917253  0.008195  0.905841   0.935 &lt;2e-16 ***
Rte             0.626174  0.014402  0.605906   0.657 &lt;2e-16 ***
ERcde          -1.126777  0.112203 -1.376355  -1.018 &lt;2e-16 ***
ERintref        0.809439  0.109402  0.698336   1.050 &lt;2e-16 ***
ERintmed        0.026115  0.002870  0.021995   0.031 &lt;2e-16 ***
ERpnie         -0.082604  0.006654 -0.093525  -0.070 &lt;2e-16 ***
ERcde(prop)     3.014176  0.318260  2.663009   3.694 &lt;2e-16 ***
ERintref(prop) -2.165285  0.311553 -2.828061  -1.814 &lt;2e-16 ***
ERintmed(prop) -0.069860  0.007046 -0.080692  -0.060 &lt;2e-16 ***
ERpnie(prop)    0.220968  0.016263  0.195328   0.251 &lt;2e-16 ***
pm              0.151108  0.014391  0.122961   0.174 &lt;2e-16 ***
int            -2.235145  0.316424 -2.901838  -1.875 &lt;2e-16 ***
pe             -2.014176  0.318260 -2.693672  -1.663 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Rcde: controlled direct effect rate ratio; Rpnde: pure natural direct effect rate ratio; Rtnde: total natural direct effect rate ratio; Rpnie: pure natural indirect effect rate ratio; Rtnie: total natural indirect effect rate ratio; Rte: total effect rate ratio; ERcde: excess relative rate due to controlled direct effect; ERintref: excess relative rate due to reference interaction; ERintmed: excess relative rate due to mediated interaction; ERpnie: excess relative rate due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)

Relevant variable values: 
$a
[1] 1

$astar
[1] 0

$mval
$mval[[1]]
[1] 0</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>By this point, we have covered most everything you should need to know to be able to interpret results of this final causal mediation model. I will only make a couple additional points.</p>
<p>First, along with the rate ratio measures (“R” prefix, e.g., Rcde), these results include a new set of estimates with an “ER” prefix (e.g., ERcde), or the “excess rate ratio” (or “excess risk ratio” in logistic regressions) attributable to particular components of a total effect. The <em>sign</em> or <em>direction</em> of an excess relative rate or risk estimate can be helpful for determining the direction of an interaction and, in particular, for inferring which group might be especially affected by an intervention. However, caution is warranted if attempting to interpret the <em>magnitude</em> of estimates on an excess relative rate or risk scale because estimation of excess rates depends upon baseline rates. The issue here is that baseline rates often vary across groups, but the estimates themselves do not communicate those baseline rates. As such, it is easy to misinterpret magnitudes of excess relative risk estimates unless interpretations also specifically reference associated differences in baseline and absolute rates or risks.</p>
<p>This raises a more general issue about relative rate or risk estimates. Though they are widely used to describe effects in nonlinear models, any estimate of <em>relative</em> rates or risks is potentially susceptible to misinterpretation or misleading inferences if not also paired with corresponding information about differences in baseline and <a href="https://academic.oup.com/ndt/article/32/suppl_2/ii13/3056571"><em>absolute</em> rates or risks</a>. This is another reason why I recommend also estimating and plotting marginal effects on the outcome scale, as it can help with identifying, communicating, and visualizing these important differences on an absolute scale. In combination, a thorough understanding of the decomposition of a total effect into its constituent components can help you communicate precisely what information is being conveyed in specific relative effect estimates and may help you better comprehend and communicate about your marginal effect estimates and plots as well.</p>
<p>For more information about relative excess ratio estimates, see <a href="https://www.hsph.harvard.edu/tyler-vanderweele/wp-content/uploads/sites/603/2018/04/AttributingInt_Ep.pdf">VanderWeele and Tchetgen Tchetgen (2014)</a>. Additionally, <a href="https://www.hsph.harvard.edu/wp-content/uploads/sites/603/2018/04/InteractionTutorial_EM.pdf">VanderWeele and Knol’s 2014</a> tutorial on interaction is especially helpful on this topic (see especially p.39 and footnote #1). That manuscript also contains a wealth of information that may be new to readers in our field about estimating and interpreting interactions, including distinctions between concepts such as <em>statistical</em>, <em>mechanistic</em>, and <em>sufficient cause</em> interactions.</p>
<p>As a final point, compare results from the CMAverse nonlinear interaction model with those from the CMAverse linear interaction model. Recall, the linear model suggested the existence of a substantial exposure-mediator interaction, which we were clued into by the notable differences in estimates across the two linear models with and without an EM interaction term. In contrast, the nonlinear model does not appear to show a sizeable exposure mediator interaction; again, we can infer this from an EM interaction coefficient of negligible magnitude and from the fact that the estimates barely changed after including the <em>EMint</em> term.</p>
<p>Recall, the additive interaction in the data is on the outcome scale, or delinquency event rates, which is also the scale of estimation for the linear model. However, this is not the estimation scale for the nonlinear model, which generates estimates on the <em>logged</em> delinquency event rate scale. Put differently, the linear model shows a statistically significant nonzero interaction term because its predictions are on the linear outcome scale, so the interaction term grants the model flexibility to fit conditional exposure effects on delinquency event rates that potentially vary across levels of the mechanism.</p>
<p>Meanwhile, the estimates from a generalized linear model with a Poisson-distributed outcome and log link function (aka, a nonlinear model) already are conditional on covariates. That is, these estimates already build conditional variability across mechanism levels into the model, so they are flexible enough to capture a similar additive interaction on the delinquency event rate outcome scale without the need for an interaction on estimation scale.</p>
<p>If there <em>had</em> been a non-negligible exposure-mediator interaction in the nonlinear model, such that estimates changed when we switched from <code>EMint = FALSE</code> to <code>EMint = TRUE</code>, then this would have signaled the existence of an interaction on the estimation scale, or in <em>logged</em> delinquency rates and differences in relative effects across mechanism levels. Plotting such changes in predicted effects on the outcome scale might have shown, for instance, a growth or a reduction across mechanism levels in the predicted differences in delinquency rates attributed to the exposure’s effect.<sup>11</sup></p>
<p>When simulating the data, I actually included an alternative outcome variable (<em>Delinquency2</em>) to provide an example of such a non-negligible interaction on the logged delinquency rate scale. If you are curious, click the expandable link below to view tabled results and plots from nonlinear models predicting this alternative variable. In particular, the prediction plots (second tab) help visualize how this specific interaction on the estimation scale translates into differences in the relative magnitude of the exposure effect across mechanism levels on the delinquency rate outcome scale.</p>
<details>
<summary>
Example interaction in nonlinear model
</summary>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.2 nonlinear model (alt DV)</span></span>
<span id="cb42-2">glm3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb42-3"></span>
<span id="cb42-4">Ex2tab3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm3) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb42-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb42-6">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Poisson regression predicting delinquency2 event rates"</span>)</span>
<span id="cb42-7"></span>
<span id="cb42-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb42-9">est6 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cmest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> simdat3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rb"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>,</span>
<span id="cb42-10">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mediator =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">EMint =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb42-11">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mreg =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linear"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yreg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb42-12">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">astar =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mval =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb42-13">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imputation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inference =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bootstrap"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nboot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" aria-controls="tabset-7-1" aria-selected="true">GLM: Results</a></li><li class="nav-item"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" aria-controls="tabset-7-2" aria-selected="false">GLM: Prediction plot with data</a></li><li class="nav-item"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" aria-controls="tabset-7-3" aria-selected="false">CMA: Results (nonlinear; EMint; alt DV)</a></li><li class="nav-item"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" aria-controls="tabset-7-4" aria-selected="false">CMA: Default plot (nonlinear; EMint; alt DV)</a></li><li class="nav-item"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" aria-controls="tabset-7-5" aria-selected="false">CMA: Risk ratio plot (nonlinear; EMint; alt DV)</a></li><li class="nav-item"><a class="nav-link" id="tabset-7-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-6" aria-controls="tabset-7-6" aria-selected="false">CMA: Excess risk plot (nonlinear; EMint; alt DV)</a></li><li class="nav-item"><a class="nav-link" id="tabset-7-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-7" aria-controls="tabset-7-7" aria-selected="false">Full output: nonlinear with EMint</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.2 nonlinear model (alt DV)</span></span>
<span id="cb43-2"></span>
<span id="cb43-3">Ex2tab3</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="babjvbhiev" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#babjvbhiev table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#babjvbhiev thead, #babjvbhiev tbody, #babjvbhiev tfoot, #babjvbhiev tr, #babjvbhiev td, #babjvbhiev th {
  border-style: none;
}

#babjvbhiev p {
  margin: 0;
  padding: 0;
}

#babjvbhiev .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#babjvbhiev .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#babjvbhiev .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#babjvbhiev .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#babjvbhiev .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#babjvbhiev .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#babjvbhiev .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#babjvbhiev .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#babjvbhiev .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#babjvbhiev .gt_spanner_row {
  border-bottom-style: hidden;
}

#babjvbhiev .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#babjvbhiev .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#babjvbhiev .gt_from_md > :first-child {
  margin-top: 0;
}

#babjvbhiev .gt_from_md > :last-child {
  margin-bottom: 0;
}

#babjvbhiev .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#babjvbhiev .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#babjvbhiev .gt_row_group_first td {
  border-top-width: 2px;
}

#babjvbhiev .gt_row_group_first th {
  border-top-width: 2px;
}

#babjvbhiev .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#babjvbhiev .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#babjvbhiev .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#babjvbhiev .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#babjvbhiev .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#babjvbhiev .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#babjvbhiev .gt_left {
  text-align: left;
}

#babjvbhiev .gt_center {
  text-align: center;
}

#babjvbhiev .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#babjvbhiev .gt_font_normal {
  font-weight: normal;
}

#babjvbhiev .gt_font_bold {
  font-weight: bold;
}

#babjvbhiev .gt_font_italic {
  font-style: italic;
}

#babjvbhiev .gt_super {
  font-size: 65%;
}

#babjvbhiev .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#babjvbhiev .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#babjvbhiev .gt_indent_1 {
  text-indent: 5px;
}

#babjvbhiev .gt_indent_2 {
  text-indent: 10px;
}

#babjvbhiev .gt_indent_3 {
  text-indent: 15px;
}

#babjvbhiev .gt_indent_4 {
  text-indent: 20px;
}

#babjvbhiev .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Poisson regression predicting delinquency2 event rates</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">0.79***</td>
<td headers="std.error" class="gt_row gt_center">0.065</td>
<td headers="ci" class="gt_row gt_center">0.66, 0.91</td>
<td headers="p.value" class="gt_row gt_center"> 1.57e-33</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-1.1***</td>
<td headers="std.error" class="gt_row gt_center">0.036</td>
<td headers="ci" class="gt_row gt_center">-1.2, -1.0</td>
<td headers="p.value" class="gt_row gt_center">2.15e-209</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.37***</td>
<td headers="std.error" class="gt_row gt_center">0.021</td>
<td headers="ci" class="gt_row gt_center">-0.41, -0.33</td>
<td headers="p.value" class="gt_row gt_center"> 4.87e-69</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">0.20***</td>
<td headers="std.error" class="gt_row gt_center">0.013</td>
<td headers="ci" class="gt_row gt_center">0.17, 0.22</td>
<td headers="p.value" class="gt_row gt_center"> 1.81e-54</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb44-2"></span>
<span id="cb44-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use ggeffects::ggpredict() to save plot_model data for use in ggplot </span></span>
<span id="cb44-4">glm3df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggpredict</span>(glm3, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs [0,2,4]"</span>))</span>
<span id="cb44-5"></span>
<span id="cb44-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#prediction plot with data subset &amp; ggblend</span></span>
<span id="cb44-7">predplot3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat3sub, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>ParentSupport, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency2, </span>
<span id="cb44-8">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb44-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">partition</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(StrgMoralBlfs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">blend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lighten"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb44-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">blend</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"multiply"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb44-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_hline(yintercept=7, linetype="dashed") +</span></span>
<span id="cb44-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>glm3df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted,</span>
<span id="cb44-17">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span>group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>group), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb44-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>glm3df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted, </span>
<span id="cb44-19">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>conf.high, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span>group), </span>
<span id="cb44-20">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb44-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linetype_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb44-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb44-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>,</span>
<span id="cb44-24">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency2"</span>,</span>
<span id="cb44-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Predicted conditional marginal effects of parent support on delinquency2"</span>, </span>
<span id="cb44-26">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Plotted at minimum (0), scale midpoint (2), &amp; maximum (4) strong moral beliefs</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(Poisson regression, n=3k simulated observations)"</span>) </span>
<span id="cb44-27"></span>
<span id="cb44-28">predplot3</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">est6dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est6<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>effect.pe) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb45-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cde"</span>,CMA_est2),</span>
<span id="cb45-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnde"</span>,CMA_est), </span>
<span id="cb45-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnde"</span>,CMA_est),</span>
<span id="cb45-5">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnie"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pnie"</span>,CMA_est),</span>
<span id="cb45-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnie"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tnie"</span>,CMA_est),</span>
<span id="cb45-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(CMA_est2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rte"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"te"</span>,CMA_est)</span>
<span id="cb45-8">  )</span>
<span id="cb45-9"></span>
<span id="cb45-10">est6dattab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> est6dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb45-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nonlin_EM"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"est6$effect.pe"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb45-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb45-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed(prop)"</span>, </span>
<span id="cb45-14">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>)) </span>
<span id="cb45-15"></span>
<span id="cb45-16">est6dattab <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb45-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb45-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMAverse&lt;br&gt;(nonlinear, alt DV)"</span>), </span>
<span id="cb45-19">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nonlin_EM"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb45-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est2 =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"effect"</span>,</span>
<span id="cb45-21">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nonlin_EM =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EMint&lt;br&gt;estimate"</span>)</span>
<span id="cb45-22">               )</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="dsvgaztkvn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dsvgaztkvn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dsvgaztkvn thead, #dsvgaztkvn tbody, #dsvgaztkvn tfoot, #dsvgaztkvn tr, #dsvgaztkvn td, #dsvgaztkvn th {
  border-style: none;
}

#dsvgaztkvn p {
  margin: 0;
  padding: 0;
}

#dsvgaztkvn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dsvgaztkvn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dsvgaztkvn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dsvgaztkvn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dsvgaztkvn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dsvgaztkvn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dsvgaztkvn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dsvgaztkvn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dsvgaztkvn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dsvgaztkvn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dsvgaztkvn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dsvgaztkvn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dsvgaztkvn .gt_spanner_row {
  border-bottom-style: hidden;
}

#dsvgaztkvn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dsvgaztkvn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dsvgaztkvn .gt_from_md > :first-child {
  margin-top: 0;
}

#dsvgaztkvn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dsvgaztkvn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dsvgaztkvn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dsvgaztkvn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dsvgaztkvn .gt_row_group_first td {
  border-top-width: 2px;
}

#dsvgaztkvn .gt_row_group_first th {
  border-top-width: 2px;
}

#dsvgaztkvn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsvgaztkvn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dsvgaztkvn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dsvgaztkvn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dsvgaztkvn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsvgaztkvn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dsvgaztkvn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dsvgaztkvn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dsvgaztkvn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dsvgaztkvn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dsvgaztkvn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsvgaztkvn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dsvgaztkvn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dsvgaztkvn .gt_left {
  text-align: left;
}

#dsvgaztkvn .gt_center {
  text-align: center;
}

#dsvgaztkvn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dsvgaztkvn .gt_font_normal {
  font-weight: normal;
}

#dsvgaztkvn .gt_font_bold {
  font-weight: bold;
}

#dsvgaztkvn .gt_font_italic {
  font-style: italic;
}

#dsvgaztkvn .gt_super {
  font-size: 65%;
}

#dsvgaztkvn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dsvgaztkvn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dsvgaztkvn .gt_indent_1 {
  text-indent: 5px;
}

#dsvgaztkvn .gt_indent_2 {
  text-indent: 10px;
}

#dsvgaztkvn .gt_indent_3 {
  text-indent: 15px;
}

#dsvgaztkvn .gt_indent_4 {
  text-indent: 20px;
}

#dsvgaztkvn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="CMAverse<br>(nonlinear, alt DV)">
        <span class="gt_column_spanner">CMAverse<br>(nonlinear, alt DV)</span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="effect">effect</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="EMint<br>estimate">EMint<br>estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="CMA_est2" class="gt_row gt_left">Rcde</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.3338</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">Rpnde</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.5997</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">Rtnde</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.6244</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">Rpnie</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.9272</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">Rtnie</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.9654</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">Rte</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.5790</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">ERcde</td>
<td headers="nonlin_EM" class="gt_row gt_right">-2.0461</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">ERintref</td>
<td headers="nonlin_EM" class="gt_row gt_right">1.6458</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">ERintmed</td>
<td headers="nonlin_EM" class="gt_row gt_right">0.0520</td></tr>
    <tr><td headers="CMA_est2" class="gt_row gt_left">ERpnie</td>
<td headers="nonlin_EM" class="gt_row gt_right">-0.0728</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggcmest</span>(est6) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb46-2">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>))</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-5" class="tab-pane" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#save estimates and intervals data</span></span>
<span id="cb47-2">est6dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(est5[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb47-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CMA_est"</span>)</span>
<span id="cb47-4"></span>
<span id="cb47-5"></span>
<span id="cb47-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop proportion estimates</span></span>
<span id="cb47-7">est6dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb47-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref(prop)"</span>,</span>
<span id="cb47-9">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed(prop)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>, </span>
<span id="cb47-10">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb47-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(CMA_est, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rte"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcde"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb47-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reorder the coefficients so that the largest is at the top of the plot</span></span>
<span id="cb47-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mutate(term = fct_reorder(CMA_est, effect.pe)) %&gt;%</span></span>
<span id="cb47-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(effect.pe, CMA_est)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb47-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbarh</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> effect.ci.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> effect.ci.high), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add in a dotted line at zero</span></span>
<span id="cb47-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb47-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb47-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated effects on risk ratio scale"</span>,</span>
<span id="cb47-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb47-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect estimates from causal mediation decomposition (risk ratios)"</span></span>
<span id="cb47-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb47-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-6" class="tab-pane" aria-labelledby="tabset-7-6-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop proportion estimates</span></span>
<span id="cb48-2">est6dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb48-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>CMA_est <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pm"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref(prop)"</span>,</span>
<span id="cb48-4">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed(prop)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde(prop)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"int"</span>, </span>
<span id="cb48-5">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rte"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rtnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rpnde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rcde"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb48-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CMA_est =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(CMA_est, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERpnie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintmed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERintref"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ERcde"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb48-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reorder the coefficients so that the largest is at the top of the plot</span></span>
<span id="cb48-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mutate(term = fct_reorder(CMA_est, effect.pe)) %&gt;%</span></span>
<span id="cb48-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(effect.pe, CMA_est)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb48-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbarh</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> effect.ci.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> effect.ci.high), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add in a dotted line at zero</span></span>
<span id="cb48-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb48-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb48-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Estimated effects on excess risks scale"</span>,</span>
<span id="cb48-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb48-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect estimates from causal mediation decomposition (excess risks)"</span></span>
<span id="cb48-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb48-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-7" class="tab-pane" aria-labelledby="tabset-7-7-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(est6)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Causal Mediation Analysis

# Outcome regression:

Call:
glm(formula = Delinquency2 ~ ParentSupport + StrgMoralBlfs + 
    ParentSupport * StrgMoralBlfs, family = poisson(), data = getCall(x$reg.output$yreg)$data, 
    weights = getCall(x$reg.output$yreg)$weights)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                   0.7882     0.0653    12.1   &lt;2e-16 ***
ParentSupport                -1.0971     0.0355   -30.9   &lt;2e-16 ***
StrgMoralBlfs                -0.3666     0.0209   -17.6   &lt;2e-16 ***
ParentSupport:StrgMoralBlfs   0.1958     0.0126    15.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 7750.2  on 2999  degrees of freedom
Residual deviance: 4249.6  on 2996  degrees of freedom
AIC: 7832

Number of Fisher Scoring iterations: 5


# Mediator regressions: 

Call:
glm(formula = StrgMoralBlfs ~ ParentSupport, family = gaussian(), 
    data = getCall(x$reg.output$mreg[[1L]])$data, weights = getCall(x$reg.output$mreg[[1L]])$weights)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     3.2145     0.0164   195.9   &lt;2e-16 ***
ParentSupport   0.2061     0.0165    12.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.807)

    Null deviance: 2546.9  on 2999  degrees of freedom
Residual deviance: 2420.6  on 2998  degrees of freedom
AIC: 7876

Number of Fisher Scoring iterations: 2


# Effect decomposition on the rate ratio scale via the regression-based approach
 
Direct counterfactual imputation estimation with 
 bootstrap standard errors, percentile confidence intervals and p-values 
 
                Estimate Std.error   95% CIL 95% CIU  P.val    
Rcde            0.333837  0.035640  0.276100   0.399 &lt;2e-16 ***
Rpnde           0.599703  0.050694  0.535054   0.683 &lt;2e-16 ***
Rtnde           0.624391  0.053477  0.557103   0.715 &lt;2e-16 ***
Rpnie           0.927231  0.008316  0.916611   0.944 &lt;2e-16 ***
Rtnie           0.965403  0.009502  0.954753   0.984 &lt;2e-16 ***
Rte             0.578955  0.046486  0.520907   0.659 &lt;2e-16 ***
ERcde          -2.046113  0.181242 -2.454288  -1.776 &lt;2e-16 ***
ERintref        1.645817  0.198858  1.336259   2.069 &lt;2e-16 ***
ERintmed        0.052021  0.004102  0.044078   0.058 &lt;2e-16 ***
ERpnie         -0.072769  0.008316 -0.083389  -0.056 &lt;2e-16 ***
ERcde(prop)     4.859609  0.788595  3.891345   6.695 &lt;2e-16 ***
ERintref(prop) -3.908887  0.805974 -5.772869  -2.911 &lt;2e-16 ***
ERintmed(prop) -0.123552  0.019938 -0.167576  -0.098 &lt;2e-16 ***
ERpnie(prop)    0.172829  0.036256  0.119480   0.237 &lt;2e-16 ***
pm              0.049278  0.020259  0.019565   0.084 &lt;2e-16 ***
int            -4.032438  0.821021 -5.929947  -3.017 &lt;2e-16 ***
pe             -3.859609  0.788595 -5.695418  -2.891 &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Rcde: controlled direct effect rate ratio; Rpnde: pure natural direct effect rate ratio; Rtnde: total natural direct effect rate ratio; Rpnie: pure natural indirect effect rate ratio; Rtnie: total natural indirect effect rate ratio; Rte: total effect rate ratio; ERcde: excess relative rate due to controlled direct effect; ERintref: excess relative rate due to reference interaction; ERintmed: excess relative rate due to mediated interaction; ERpnie: excess relative rate due to pure natural indirect effect; ERcde(prop): proportion ERcde; ERintref(prop): proportion ERintref; ERintmed(prop): proportion ERintmed; ERpnie(prop): proportion ERpnie; pm: overall proportion mediated; int: overall proportion attributable to interaction; pe: overall proportion eliminated)

Relevant variable values: 
$a
[1] 1

$astar
[1] 0

$mval
$mval[[1]]
[1] 0</code></pre>
</div>
</div>
</div>
</div>
</div>
</details>
</section>
<section id="sec-curtaincall" class="level2">
<h2 class="anchored" data-anchor-id="sec-curtaincall">Curtain call</h2>
<p>I hope this three-part series has helped you better appreciate the challenges of analyzing moderation processes with criminological data and the importance of checking for exposure-mediator interactions and, where they exist, of decomposing total effects into its constituent interaction and indirect effect components.</p>
<p>In closing, the next time you stub your toe, I hope I have not caused you to think of me. Blame the curtains instead.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[11]/thatsallfolks.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">That’s all folks!</figcaption>
</figure>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Of course, in many situations, a “direct effect” estimate itself may (and likely does) represent an aggregate or composite summary of other indirect effects operating through unmeasured mechanisms.↩︎</p></li>
<li id="fn2"><p>In causal mediation decomposition using potential outcomes, the <em>mediated interaction</em> component is typically attributed variously to quantities representing the direct effect of the exposure or, instead, to quantities representing the indirect effect through the mechanism. The specific estimates that a researcher chooses to report will depend upon one’s focal research questions and estimand of interest. I will try to explain this partitioning of the mediated interaction component (out of “pure” or into “total” effect estimates) in more detail later.↩︎</p></li>
<li id="fn3"><p>Again, traditional and causal mediation approaches both rest upon similar confounding assumptions. In addition to these assumptions, there are lots of other considerations as well when deciding whether a mediation model is appropriate for your situation. Too often, <a href="https://journals.sagepub.com/doi/10.1177/25152459221095827">a mediation model may not be appropriate</a>, but researchers use them anyway. Still, even in situations where the appropriateness of their assumptions are dubious, I think most social scientific research would benefit from careful thinking about and transparent statements of the assumptions required to make causal inferences from data - whether those causal inferences are from mediation models or otherwise. Likewise, reading more about causal mediation methods may help towards these ends, as the explicit and formal statement of assumptions necessary to generate valid causal inferences from mediation models is an important area of emphasis in the causal mediation literature.↩︎</p></li>
<li id="fn4"><p>Given these aims, I also do not address other detailed issues or advanced modeling options here, such as differences between <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10368791/">regression-based</a>, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4214081/">weighting-based</a>, <em>g-formula</em>, or <a href="https://bs1125.github.io/CMAverse/articles/overview.html">other estimation methods</a> available in CMAverse. However, note that some available methods may be better suited for your particular modeling situation, and some choices may be better than others <a href="https://www.tandfonline.com/doi/full/10.1080/10705511.2022.2104287">depending upon your specific causal estimand of interest</a>.↩︎</p></li>
<li id="fn5"><p>Note, too, that the Y(do[A=1],do[M<sub>A=0</sub>]) may be an unobservable counterfactual condition (e.g., in the presence of mediation). We cannot in fact simultaneously observe Y with X set to =1 and M set to equal its expected value when A=0. After all, if we do A=1 and X has an effect on M, then M would also change to its (population average) value at A=1; M would not stay at its expected value when A=0! <a href="https://www.nimhd.nih.gov/docs/hd-workshop/day1/roleWorkInHD-2020_10_kaufman_mediationAnalysesToRacialEthnic.pdf">These slides</a> (especially slide 12) offer a concise description of this issue.↩︎</p></li>
<li id="fn6"><p>If you have not read it yourself, then you might be unaware that <a href="https://psycnet.apa.org/doiLanding?doi=10.1037%2F0022-3514.51.6.1173">Baron &amp; Kenny’s (1986) classic paper</a> was actually about distinguishing between mediation and moderation concepts, with an emphasis on testing indirect and interaction hypotheses <em>in the same analysis</em>. You might also be surprised to learn that <a href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=6c841fdea3122bdbd49570fc2ee0efcd3aad9913">Judd and Kenny’s (1981) classic mediation paper</a> outlined the core causal assumptions necessary for valid mediation analysis and explicitly discussed exposure-mediator interactions. So, in some important ways, this entry is trying help get our field caught up to leading mediation advice published over 40 years ago. Unfortunately, for decades, researchers following the “Baron and Kenny” causal steps approach to mediation largely have ignored Judd and Kenny’s earlier discussions of causal assumptions pertaining to confounding or exposure-mediator interactions. <a href="https://davidakenny.net/cm/mediate.htm#id.3dy6vkm">David Kenny</a> suggests this might be partly due (among other important reasons) to the fact that Baron and Kenny’s highly cited paper “does not even mention confounding as an assumption”; rather, that paper did “discuss reliability and interaction” and it “suggests to the reader to consult Judd and Kenny (1981a) for more information about assumptions.” Sadly, you might <em>not</em> be surprised to learn that, according to Kenny, the “initial submission did discuss confounding, but the editor suggested cutting that section and unfortunately the authors complied.” Let’s focus on improving our analytic approaches to mediation and moderation for now, then work on problematic reviewer, editor, and publisher practices at a later date.↩︎</p></li>
<li id="fn7"><p>Upon close inspection of the full output for the <code>EMint=TRUE</code> model, you might also notice that the outcome model regression coefficients are equivalent to those generated by the linear interaction model used earlier to create prediction plots. This is because essentially the same underlying linear interaction model is used to estimate indirect effects and conduct total effect decomposition.↩︎</p></li>
<li id="fn8"><p>Invalid proportion estimates extending beyond expected bounds of 0 to 1 also can mess up axis scales when plotting; you can see this in some of the CMAverse “default” plots. Additionally, even in situations where proportion estimates are valid, I am skeptical that the proportion of a total effect that is attributable to specific underlying component is likely to be a very useful estimand of interest.↩︎</p></li>
<li id="fn9"><p><a href="https://bs1125.github.io/CMAverse/articles/overview.html">Table 1 here</a> provides descriptions of the various effect estimates generated by CMAverse in linear decomposition models.↩︎</p></li>
<li id="fn10"><p><a href="https://bs1125.github.io/CMAverse/articles/overview.html">See Table 2 here</a> for descriptions of the various causal estimates on the ratio scale that are output by CMAverse, and see the <a href="https://bs1125.github.io/CMAverse/reference/cmest.html"><code>cmest</code> documentation</a> for descriptions of which causal estimates are generated under different modeling specifications.↩︎</p></li>
<li id="fn11"><p>To echo my recommendation from Part 1, <a href="https://sociologicalscience.com/download/vol-6/february/SocSci_v6_81to117.pdf">Trenton Mize’s (2019) paper</a> is an excellent resource for better understanding interactions in nonlinear models.↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer2024,
  author = {Brauer, Jon},
  title = {Moderator {Madness,} {Part} 3},
  date = {2024-02-26},
  url = {https://reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer2024" class="csl-entry quarto-appendix-citeas">
Brauer, Jon. 2024. <span>“Moderator Madness, Part 3.”</span> February
26, 2024. <a href="https://reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3.html">https://reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <category>rstats</category>
  <category>causality</category>
  <category>moderation</category>
  <category>mediation</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[11]/modmadness-pt3.html</guid>
  <pubDate>Mon, 26 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[11]/med-or-mod-cartoon2.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Moderator Madness, Part 2</title>
  <dc:creator>Jon Brauer</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/decomp-cartoon2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Lemmings puzzled by 4-way total effect decomposition (with help from DALL-E)</figcaption>
</figure>
</div>
<p>This is the second of a three-part blog series on modeling moderators in criminological data. <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1">Part 1</a> addressed issues related to the estimation and interpretation of interaction effects in generalized linear regression models with nonlinear link functions (e.g., logistic, Poisson, and negative binomial regression). In this Part 2 entry, I use a simple example to introduce a 4-way decomposition procedure for separating a total effect into direct, indirect, and interaction components in the presence of a potential exposure-mediator interaction. <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a> will then use more realistic simulated data to illustrate “causal mediation” analysis with the <code>CMAverse</code> software package in R, which relies on this 4-way potential outcomes decomposition approach to disentangle indirect and interaction effects in the presence of a potential exposure-mediator interaction.</p>
<p>My primary goals in this second post are to introduce counterfactual causality, exposure-mediator interactions, and a potential outcomes framework for conducting a four-way decomposition of a total effect into four distinct components: a <em>controlled direct effect</em> (<em>CDE</em>); a <em>pure indirect effect</em> (<em>PIE</em>); a <em>reference interaction</em> (<em>INT<sub>ref</sub></em>); and a <em>mediated interaction</em> (<em>INT<sub>med</sub></em>).</p>
<p>Ready to dip your toes into the deep end?</p>
<section id="sec-counterfac" class="level2">
<h2 class="anchored" data-anchor-id="sec-counterfac">Comprehending counterfactuals</h2>
<p>Have you ever stubbed your toe in the dark? Think back to one of those times. Did you say “ouch” or some other four letter word? What do you think <strong>caused</strong> you to stub your toe?</p>
<p>Let’s add some details to this example: Imagine that you are in an unfamiliar room, at night, with blackout curtains drawn closed over a single window. With the curtains closed, the room lacks sufficient light to help you see obstacles in your path. You are tip-toing across the room in search of a light switch when suddenly - “OUCH!” - you stub your toe on what feels like the leg of a chair. Your mind suddenly and angrily turns to the curtains: “If I had just left those #&amp;%@! curtains open, I never would have stubbed my toe!”</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/counterfac1.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Your thoughts communicate a causal claim about the world - that the closed window curtain caused your pain.</figcaption>
</figure>
</div>
<p>There are two important things to note about this imaginary angry thought. First, it communicates a causal belief or claim. Specifically, your momentary thought communicates a belief that the closed window curtains are (at least partly) responsible for you stubbing your toe. Put differently, you view the closed curtains as a <em>cause</em> of the undesired outcome - perhaps not the only cause, but a noteworthy cause nonetheless.</p>
<p>Second, the structure of this angry thought conveys an implicit view of causal claims as dependent upon contrasts between plausible “potential outcomes” across observed and “counterfactual” conditions. That is, your momentary thought contrasts an observed or factual initial condition (the closed curtain) with a <em>counterfactual</em> initial condition (an open curtain), and then implies a different potential outcome (i.e, a stubbed versus an unstubbed toe) might have occurred if the observed initial condition would have been changed to the counterfactual condition instead.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/counterfac2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Causal claims depend upon contrasts between “potential outcomes” across observed and counterfactual conditions.</figcaption>
</figure>
</div>
<p>Many social scientific questions and claims reflect a similar counterfactual logic or, at least, can be recast in counterfactual terms:</p>
<ul>
<li><em>If politicians had not campaigned on these platforms or had not signed those policies into law, then US incarceration rates would not have increased exponentially…</em></li>
<li><em>If we intervene in those neighborhoods in these ways, then crime rates in those neighborhoods will reduce…</em></li>
<li><em>If that group had those different characteristics, then they would have received better (worse) criminal justice outcomes…</em><br>
</li>
<li><em>If those adults had not experienced adverse childhood experiences, then they might not have participated in violent criminal behaviors…</em></li>
</ul>
<p>In our <a href="https://reluctantcriminologists.com/blog-posts/%5B4%5D/causation-no-corr">earlier post on causation without correlation</a>, we also noted that counterfactual reasoning is central to statistical tests of causal claims and even underlies justifications for randomized controlled trials themselves:</p>
<blockquote class="blockquote">
<p>“We seem to engage in counterfactual thinking naturally, as it appears central to <a href="https://plato.stanford.edu/entries/counterfactuals/">imagination and rational agency</a>. Pearl and Mackenzie go so far as to claim that the ability to use counterfactual thinking to make “explanation-seeking inferences reliably and repeatably” is what “most distinguishes human from animal intelligence, as well as from model-blind versions of AI and machine learning” (<a href="https://www.basicbooks.com/titles/judea-pearl/the-book-of-why/9780465097616/">2018</a>, p.33). Moreover, the belief that randomization in controlled experiments offers a valid mechanism for making causal inferences relies upon counterfactual reasoning about potential outcomes; these counterfactual justifications underlying classical statistics were proposed by pioneers Jersey Neyman and Sir Ronald Fisher <a href="https://www.cambridge.org/core/books/abs/causal-inference-for-statistics-social-and-biomedical-sciences/brief-history-of-the-potential-outcomes-approach-to-causal-inference/B8CEDDC08F0E0D6C577847F0CBE4E6A3">a century ago</a>! Meanwhile, principled counterfactual frameworks using potential outcomes to make causal inferences with observational data have been in use <a href="https://en.wikipedia.org/wiki/Rubin_causal_model">since the 1970s</a> and represent arguably <a href="https://jech.bmj.com/content/76/11/960">the best approach to causal identification with observational data today</a>.”</p>
</blockquote>
</section>
<section id="sec-potentialoutcomes" class="level2">
<h2 class="anchored" data-anchor-id="sec-potentialoutcomes">Prepare for potential outcomes notation</h2>
<p>With that said, let’s recast our hypothetical toe-stubbing example into the language of counterfactuals and potential outcomes.</p>
<p>In this simple example, we have two initial “exposure” or “treatment” conditions: <em>curtains closed</em> and <em>curtains open</em>. We will denote <em>curtains open</em> as X=0 and <em>curtains closed</em> as X=1. Likewise, we have two “potential outcome” conditions: <em>unstubbed toe</em>, denoted as Y=0, and <em>stubbed toe</em>, denoted as Y=1.</p>
<p>Given these and our causal expectations, we can write two potential outcomes equations, Y(0)=0 (or Y0=0) and Y(1)=1 (or Y1=1), that respectively represent our expectation of a <em>stubbed toe</em> when curtains are closed and our expectation of an <em>unstubbed toe</em> when curtains are open. Here, I am (loosely) adopting <a href="http://causality.cs.ucla.edu/blog/index.php/2013/10/26/comments-on-kennys-summary-of-causal-mediation/">Pearl’s <em>do-calculus</em> notation</a>, where these two equations are abbreviations of longer structural equations for outcome probability expectations under different initial conditions where we <em>do</em> X=0 or X=1. The first equation, Y(0), is shorthand for Y(do[x=0])=0, which means that we expect the value of Y to equal “0” (i.e., we expect an unstubbed toe) when we <em>do</em> X=0 (i.e., when we open the curtains). Similarly, the second equation, Y(1), is shorthand for Y(do[x=1])=1, which means that we expect the value of Y to be “1” (i.e., we expect a stubbed toe) when we <em>do</em> X=1 (i.e., when we close the curtains). Technically, we expect the probability to be closer to zero or one when we do X=0 or X=1, respectively, but just bear with me here.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/counterfac3.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">We can recast our thought experiment into the language of potential outcomes.</figcaption>
</figure>
</div>
<p>Additionally, <a href="https://reluctantcriminologists.com/blog-posts/%5B5%5D/colliders#sec-dagsaber">as we have explained before</a>, it is usually helpful to communicate our causal assumptions transparently using a causal diagram or a DAG. In the DAG below, we collapse our exposure conditions and potential outcomes into two variables connected by an arrow to represent our expectation of a causal relationship between curtains (open versus closed) and uttering a four-letter word (unstubbed versus stubbed toe).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dagitty)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdag)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggraph)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">ouchDAG <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb2-2">  Ouch <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Curtains,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curtains"</span>,</span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ouch"</span>,</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb2-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains =</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-8">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-9">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">focal =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curtains"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb2-10"></span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#function to shorten arrows (edges)</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://stackoverflow.com/questions/65420136/how-do-you-adjust-the-arrows-in-a-ggplot-of-a-ggdag</span></span>
<span id="cb2-14">shorten_dag_arrows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(tidy_dag, proportion){</span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update underlying ggdag object</span></span>
<span id="cb2-16">tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, </span>
<span id="cb2-17">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(xend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x, </span>
<span id="cb2-18">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(yend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y,</span>
<span id="cb2-19">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xstart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> xend,</span>
<span id="cb2-20">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ystart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>yend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> yend)</span>
<span id="cb2-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(tidy_dag)</span>
<span id="cb2-22">}</span>
<span id="cb2-23"></span>
<span id="cb2-24">ouchDAG1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(ouchDAG, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb2-25"></span>
<span id="cb2-26"></span>
<span id="cb2-27">ouchDAG1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ouchDAG1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> focal)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb2-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DAG1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb2-37"></span>
<span id="cb2-38">ouchDAG1</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2_files/figure-html/DAG1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 1. Simple DAG representing causal effect of window curtains on stubbed toes (ouch!)</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-medandmod" class="level2">
<h2 class="anchored" data-anchor-id="sec-medandmod">Is your mechanism a mediator, a moderator, or both?</h2>
<p>Now, let’s step back and revisit our causal assumptions. Do we <em>really</em> think the closed curtains directly caused us to stub our toes? When interrogating a causal claim, it is usually a good idea to ask “how” and “why” questions, as doing so might illuminate mechanisms that can help us better identify, predict, and explain causal relationships. For instance, <em>why</em> do we think the closed curtains caused us to stub our toe? <em>How</em> might the closed curtains have caused such an outcome to occur?</p>
<p>In this case, you probably do not think that the closed window curtains <em>directly</em> caused toe stubbing. Rather, you likely expect that closed curtains <em>indirectly</em> caused this painful outcome by blocking light from entering the room through the window. In contrast, had the window curtains been open, then there might have been more ambient light in the room and, with sufficient light, you might have been better able to see and to avoid colliding with hazardous objects.</p>
<p>Let’s recast these more precise mechanistic beliefs as potential outcomes and communicate them graphically with a new DAG.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/counterfac4.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Specifying mechanisms can help us identify, predict, and explain causal relationships.</figcaption>
</figure>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">ouchDAG2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb3-2">  Ouch <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Light ,</span>
<span id="cb3-3">  Light <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Curtains, </span>
<span id="cb3-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curtains"</span>,</span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ouch"</span>,</span>
<span id="cb3-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Light=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains =</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Light=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-9">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-10">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">focal =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curtains"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb3-11"></span>
<span id="cb3-12"></span>
<span id="cb3-13">ouchDAG2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(ouchDAG2, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb3-14"></span>
<span id="cb3-15"></span>
<span id="cb3-16">ouchDAG2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ouchDAG2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> focal)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DAG2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb3-26"></span>
<span id="cb3-27">ouchDAG2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2_files/figure-html/DAG2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 2. DAG of indirect causal effect of window curtains through light on stubbed toes</figcaption>
</figure>
</div>
</div>
</div>
<p>After examining this DAG, many of you might immediately assume it that it displays a classic indirect causal effect or mediating relationship. However, it is worth taking a moment to ponder whether you think light really is a mediator, or instead whether it is a moderator, or perhaps both? For example, consider that opening the curtains might reduce the chances of stubbing your toes when it is light outside and, hence, when doing so lets sufficient light in the room for you to see obstacles in your path. In contrast, when it is not light outside, opening the curtains might not let sufficient light in and, in those situations, opening the curtains (i.e., <em>doing</em> X=0) might not reduce (i.e., cause) the probability of stubbing toes.</p>
<p>Put differently, we might posit a heterogeneous causal effect of opening the curtains on the probability of toe stubbing, where the causal effect is strongest when accompanied by sufficient light but weakest or nonexistent when not accompanied by sufficient light.</p>
<p>If you are a social scientist, you might also be accustomed to seeing an intersecting arrow in a causal diagram to depict this type of conditional effect or moderating relationship, like below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">ouchDAG2b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb4-2">  Ouch <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Curtains ,</span>
<span id="cb4-3">  holder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Light, </span>
<span id="cb4-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curtains"</span>,</span>
<span id="cb4-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ouch"</span>,</span>
<span id="cb4-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Light=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holder=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains =</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Light=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holder=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-9">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-10">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">focal =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Window"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb4-11"></span>
<span id="cb4-12"></span>
<span id="cb4-13">ouchDAG2b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(ouchDAG2b, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb4-14"></span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#create factor variable to isolate edge of interest, permits specifying edge color</span></span>
<span id="cb4-17">ouchDAG2b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ouchDAG2b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">myedge1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(ouchDAG2b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Light"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> ouchDAG2b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>to <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"holder"</span>,</span>
<span id="cb4-19">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no"</span>), </span>
<span id="cb4-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">modlinetype =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(myedge1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>)</span>
<span id="cb4-21">  ) </span>
<span id="cb4-22"></span>
<span id="cb4-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot dag</span></span>
<span id="cb4-24">fig3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ouchDAG2b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xstart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ystart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color=</span>myedge1, </span>
<span id="cb4-26">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_linetype =</span> modlinetype), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(x, name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"holder"</span>), </span>
<span id="cb4-28">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb4-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_edge_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maroon"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change second color to highlight focal myedge1 </span></span>
<span id="cb4-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggtitle("DAG w/mediation &amp; interaction") + </span></span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Classic Moderation Diagram"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb4-35"></span>
<span id="cb4-36">fig3 </span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2_files/figure-html/Moderation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 3. Causal graph of light moderating the effect of window curtains on stubbed toes</figcaption>
</figure>
</div>
</div>
</div>
<p>So, is light a mediator, or a moderator, or is it both? Well, it turns out that mediation and moderation are <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4220271/">not always as distinguishable</a> as one might think.</p>
<p>In fact, this potential overlap is communicated by a proper DAG of mediating and moderating relationships. As we noted <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1#two-papers-walk-into-a-bar">in Part 1</a>, a traditional DAG does not use intersecting arrows to depict moderation. Rather, arrows indicate information flow, while heterogeneous (moderation) effects are captured in the functional forms of the mathematical equations used to model causal relationships. Likewise, below is a DAG that illustrates the possibility of (heterogeneous) direct and indirect effects of closed curtains on stubbing toes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">ouchDAG3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb5-2">  Ouch <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Curtains <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Light ,</span>
<span id="cb5-3">  Light <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Curtains, </span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curtains"</span>,</span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ouch"</span>,</span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb5-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Light=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb5-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Curtains =</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Light=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Ouch=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-9">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-10">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">focal =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Curtains"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb5-11"></span>
<span id="cb5-12"></span>
<span id="cb5-13">ouchDAG3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(ouchDAG3, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb5-14"></span>
<span id="cb5-15"></span>
<span id="cb5-16">ouchDAG3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ouchDAG3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> focal)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb5-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DAG3"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb5-26"></span>
<span id="cb5-27">ouchDAG3</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2_files/figure-html/DAG3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 4. DAG of direct and indirect causal effects of window curtains through light on stubbed toes</figcaption>
</figure>
</div>
</div>
</div>
<p>An important takeaway message is that when we are examining causal systems that we think might involve a mediating mechanism, it is important to formally assess whether there is evidence of a non-negligible <strong>exposure-mediator interaction</strong>. An exposure-mediator interaction is a situation where the effect of the focal cause or exposure (opening or closing the curtains) on an outcome (toe stubbing) varies across the range of values of the posited mediating mechanism (ambient light levels in the room).</p>
<p>Often, when testing mediation hypotheses, assessing this possibility will entail the inclusion of a multiplicative interaction term representing a potential exposure-mediator interaction (X*M) into your model, estimating marginal effects, and plotting model predictions on the outcome scale across levels of the exposure and mechanism.<sup>1</sup> In the presence of an additive interaction, your modeling approach should account for the joint possibility of mediation and moderation. In this situation, the “causal mediation” or potential outcomes decomposition approach can help you disentangle indirect and interaction effects.<sup>2</sup></p>
</section>
<section id="sec-fourwaydecomp" class="level2">
<h2 class="anchored" data-anchor-id="sec-fourwaydecomp">Four-way decomposition with toy example</h2>
<p>The first thing to note about causal mediation effect decomposition is that it generates population-average inferences about counterfactual conditions. Recall, we cannot observe counterfactual causality among individual units because we can only observe one of two (or more) possible conditions for any individual unit. In our example, either the curtains were closed or open, and either we did or did not stub our toe. If the curtains were closed and we stubbed our toe, then we cannot observe the counterfactual condition in which the curtains instead would have been open to see what might have happened to our toes. However, we <em>can</em> make causal inferences about potential outcomes across counterfactual conditions with sufficient data from populations, a careful research design, and a proper causal (theoretical) model. In our example, that would require many observations of mechanism states (ambient light levels in the room) and outcome occurrences (stubbed toes) in the room under both exposure and non-exposure conditions (when the curtains were open and when curtains were closed) along with some assumptions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/counterfac5.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Given some key assumptions, we can estimate counterfactual causal effects as population-average differences in potential outcomes.</figcaption>
</figure>
</div>
<p>In <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a> of this series, I will work through an example of effect decomposition in R using simulated crime-relevant data. First, though, I hope to build upon your intuitions about how this decomposition procedure works in this entry using some toy data based on our toe stubbing example. The goal of this example is to introduce you to key terminology and the conceptual basis for potential outcomes effect decomposition before getting into a more realistic applied example in which we will use software to perform the decomposition for us.</p>
<p>Note that this first toy example is intended as a simple application of <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4220271/#S2title">VanderWeele’s initial 4-way effect decomposition example</a> in which exposure and mediator values are set at specific counterfactual values (setting M to 0 or 1). Later, I will briefly introduce more <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4220271/#S1title">complex counterfactual logic</a> (e.g., setting M at its expected value when X=0 or X=1), which will be required for estimating and interpreting “natural” direct and indirect effects found in <code>CMAverse</code> output in <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a>. For more and better resources on this topic, I recommend reading VanderWeele’s 2014 paper itself, as well as his tutorials and short video course on causal mediation, all of which are available <a href="https://www.hsph.harvard.edu/tyler-vanderweele/tools-and-tutorials/">on his website</a>.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">ouchdat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tribble</span>(</span>
<span id="cb6-2"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>CurtainClosed, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>AmpleLight, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>StubToe,</span>
<span id="cb6-3"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-4"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-5"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-6"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-7"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-8"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-9"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-10"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-11"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-12"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-13"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-14"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-15"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-16"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-17"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-18"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-19"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-20"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-21"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-22"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb6-23"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-24">)</span>
<span id="cb6-25"></span>
<span id="cb6-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ouchdat,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span>
<span id="cb6-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span>(ouchdat,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>()</span></code></pre></div>
</details>
<div id="tbl-anonymous-3488286" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Toy toe-stubbing data</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-anonymous-3488286-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-anonymous-3488286" style="flex-basis: 50.0%;justify-content: center;">

<div id="upmcaersso" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#upmcaersso table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#upmcaersso thead, #upmcaersso tbody, #upmcaersso tfoot, #upmcaersso tr, #upmcaersso td, #upmcaersso th {
  border-style: none;
}

#upmcaersso p {
  margin: 0;
  padding: 0;
}

#upmcaersso .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#upmcaersso .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#upmcaersso .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#upmcaersso .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#upmcaersso .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#upmcaersso .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upmcaersso .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#upmcaersso .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#upmcaersso .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#upmcaersso .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#upmcaersso .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#upmcaersso .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#upmcaersso .gt_spanner_row {
  border-bottom-style: hidden;
}

#upmcaersso .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#upmcaersso .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#upmcaersso .gt_from_md > :first-child {
  margin-top: 0;
}

#upmcaersso .gt_from_md > :last-child {
  margin-bottom: 0;
}

#upmcaersso .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#upmcaersso .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#upmcaersso .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#upmcaersso .gt_row_group_first td {
  border-top-width: 2px;
}

#upmcaersso .gt_row_group_first th {
  border-top-width: 2px;
}

#upmcaersso .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#upmcaersso .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#upmcaersso .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#upmcaersso .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upmcaersso .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#upmcaersso .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#upmcaersso .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#upmcaersso .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#upmcaersso .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#upmcaersso .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#upmcaersso .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#upmcaersso .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#upmcaersso .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#upmcaersso .gt_left {
  text-align: left;
}

#upmcaersso .gt_center {
  text-align: center;
}

#upmcaersso .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#upmcaersso .gt_font_normal {
  font-weight: normal;
}

#upmcaersso .gt_font_bold {
  font-weight: bold;
}

#upmcaersso .gt_font_italic {
  font-style: italic;
}

#upmcaersso .gt_super {
  font-size: 65%;
}

#upmcaersso .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#upmcaersso .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#upmcaersso .gt_indent_1 {
  text-indent: 5px;
}

#upmcaersso .gt_indent_2 {
  text-indent: 10px;
}

#upmcaersso .gt_indent_3 {
  text-indent: 15px;
}

#upmcaersso .gt_indent_4 {
  text-indent: 20px;
}

#upmcaersso .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption><p>X=1</p> </caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="CurtainClosed">CurtainClosed</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AmpleLight">AmpleLight</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="StubToe">StubToe</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">1</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="tbl-anonymous-3488286-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-anonymous-3488286" style="flex-basis: 50.0%;justify-content: center;">

<div id="gvvydsugpf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gvvydsugpf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gvvydsugpf thead, #gvvydsugpf tbody, #gvvydsugpf tfoot, #gvvydsugpf tr, #gvvydsugpf td, #gvvydsugpf th {
  border-style: none;
}

#gvvydsugpf p {
  margin: 0;
  padding: 0;
}

#gvvydsugpf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gvvydsugpf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gvvydsugpf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gvvydsugpf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gvvydsugpf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gvvydsugpf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gvvydsugpf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gvvydsugpf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gvvydsugpf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gvvydsugpf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gvvydsugpf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gvvydsugpf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gvvydsugpf .gt_spanner_row {
  border-bottom-style: hidden;
}

#gvvydsugpf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gvvydsugpf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gvvydsugpf .gt_from_md > :first-child {
  margin-top: 0;
}

#gvvydsugpf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gvvydsugpf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gvvydsugpf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gvvydsugpf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gvvydsugpf .gt_row_group_first td {
  border-top-width: 2px;
}

#gvvydsugpf .gt_row_group_first th {
  border-top-width: 2px;
}

#gvvydsugpf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvvydsugpf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gvvydsugpf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gvvydsugpf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gvvydsugpf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvvydsugpf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gvvydsugpf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gvvydsugpf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gvvydsugpf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gvvydsugpf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gvvydsugpf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvvydsugpf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gvvydsugpf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvvydsugpf .gt_left {
  text-align: left;
}

#gvvydsugpf .gt_center {
  text-align: center;
}

#gvvydsugpf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gvvydsugpf .gt_font_normal {
  font-weight: normal;
}

#gvvydsugpf .gt_font_bold {
  font-weight: bold;
}

#gvvydsugpf .gt_font_italic {
  font-style: italic;
}

#gvvydsugpf .gt_super {
  font-size: 65%;
}

#gvvydsugpf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gvvydsugpf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gvvydsugpf .gt_indent_1 {
  text-indent: 5px;
}

#gvvydsugpf .gt_indent_2 {
  text-indent: 10px;
}

#gvvydsugpf .gt_indent_3 {
  text-indent: 15px;
}

#gvvydsugpf .gt_indent_4 {
  text-indent: 20px;
}

#gvvydsugpf .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"><caption><p>X=0</p> </caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="CurtainClosed">CurtainClosed</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AmpleLight">AmpleLight</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="StubToe">StubToe</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">1</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CurtainClosed" class="gt_row gt_right">0</td>
<td headers="AmpleLight" class="gt_row gt_right">0</td>
<td headers="StubToe" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</div>
<p>These data represent n = 21 curtains, light, and toe stubbing observations. In approximately half of the cases, the curtains were closed (<em>CurtainClosed</em> = 1; n = 11); in the other cases, the curtains were open (<em>CurtainClosed</em> = 0; n = 10). The overall probability of stubbing toes, or P(Y), is 0.33 (<em>StubToe</em> = 1; n = 7/21). We will use these hypothetical “observed” probabilities to represent (counterfactual) expectations.</p>
<p>Y0 and Y1<br>
The probability of stubbing toes varies across exposure conditions. The probability of stubbing toes given the curtains were open, denoted by P(Y|<em>do</em>[X=0]) or abbreviated to Y0, is 0.2. That is, we stubbed our toes in 2 out of 10 cases in which curtains were open. In contrast, we stubbed our toes in 5 out of 11 cases in which curtains were closed, which means that P(Y|<em>do</em>[X=1]), or Y1, is equal to 0.45.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/Y0Y1-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Y0 and Y1</figcaption>
</figure>
</div>
<section id="sec-TE" class="level3">
<h3 class="anchored" data-anchor-id="sec-TE">Total effect (<em>TE</em>)</h3>
<p>In this example, we can calculate the <em>total effect</em> (<em>TE</em>) simply as the difference between the outcome probabilities across exposed and unexposed conditions. The estimated total effect of closing curtains on toe stubbing is Y1 - Y0, or 0.455 - 0.2, which equals 0.255. Put differently, opening curtains reduces the predicted probability of toe stubbing by about 26 percentage points (from ~45.5% to 20%).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/TE-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Total effect (<em>TE</em>) = Y1 - Y0</figcaption>
</figure>
</div>
<p>M0 and M1<br>
What about our mechanism? The probability of experiencing sufficient ambient light in the room to be able to see obstacles is P(M) = 0.43, since 9 out of 21 cases had a <em>AmpleLight</em> value = 1. Like stubbing our toes, the probability of experiencing sufficient light also varied across exposure conditions. The probability of sufficient light given the curtains were open, denoted by P(M|<em>do</em>[X=0]) or abbreviated to M0, is 0.80 (i.e., 8/10). In contrast, there was sufficient light in the room in only 1 out of 11 cases in which the curtains were closed, which means that P(M|<em>do</em>[X=1]) or M1 = 0.09.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/M0M1-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">M0 and M1</figcaption>
</figure>
</div>
<p>Now, let’s consider jointly how the probability of stubbing our toes changes given different combinations of exposure and mediator conditions, or given that we open or close curtains and simultaneously observe the presence or absence of sufficient ambient light in the room.</p>
<p>Y00<br>
Let’s start with the probability of stubbing toes given open curtains and the absence of sufficient light, which we will denote as P(Y|<em>do</em>[X=0],<em>do</em>[M=0]) and abbreviate to Y00. Given some assumptions, this quantity represents the expected probability of stubbing our toes if we <em>do</em> X=0 (i.e., if we open the curtains) and if we were able to set the mechanism to absent, or M=0. In other words, we are setting the room to insufficient light, or <em>AmpleLight</em> = 0, with the curtains open. There were 2 observed cases in which X=0 and M=0. Perhaps these cases represented especially dark nights during which the open window curtains were not effective in increasing the amount of ambient light in the room. In half of these cases (1/2), we stubbed our toes, meaning <strong>Y00 = 0.5</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/Y00-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Y00</figcaption>
</figure>
</div>
<p>Y10<br>
Now, imagine we <em>do</em> X=1 instead (i.e., we close the curtains) and we continue hold the mechanism constant at the value of “0”. That is, we set the room to insufficient light, or <em>AmpleLight</em> = 0, with the curtains closed. There are ten observed cases in which the curtains were closed and there was insufficient ambient light in the room. We stubbed our toes in five of these ten cases, meaning P(Y|<em>do</em>[X=1],<em>do</em>[M=0]) or <strong>Y10 = 0.5</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/Y10-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Y10</figcaption>
</figure>
</div>
</section>
<section id="sec-CDE" class="level3">
<h3 class="anchored" data-anchor-id="sec-CDE">Controlled direct effect (<em>CDE</em>)</h3>
<p>With the quantities above, we now have enough information to calculate the <em>controlled direct effect</em>, or <em>CDE</em>, of X on Y. Conceptually, the <em>CDE</em> of an exposure is the expected effect that an exposure would have on the outcome if the mechanism (M) were fixed at a specific value (m). Here is the potential outcomes equation for the <em>CDE</em>:</p>
<p><em>CDE</em> = Y1m - Y0m, where we set M to a specific value “m”</p>
<p>Commonly, we might wish to estimate the controlled direct effect when the mediator is equal to zero. In this case, the <em>CDE</em> of an exposure is the expected effect that an exposure would have on the outcome if the mechanism were removed or fixed at M=0. Here, when we set M to m=0, the <em>CDE</em> is equivalent to the difference between Y10 and Y00, or the estimated effect on Y of <em>doing</em> X in the absence of the mechanism:</p>
<p><em>CDE</em>(M=0) = Y10 - Y00<br>
= 0.5 - 0.5<br>
= 0.0</p>
<p>In essence, this value of 0.0 indicates that <em>doing</em> X = 1 (i.e., closing the curtains) instead of <em>doing</em> X = 0 is expected to have no effect on the probability of toe stubbing once we remove from the equation the effect that opening curtains has on the mechanism (ie., letting sufficient ambient light into the room). Put differently, closing the window curtains is not expected to have a direct effect on stubbing toes above and beyond any indirect effects it has on the ambient light levels in the room.</p>
<p>Think of it this way: You are in a dark room with curtains closed (<em>do</em>[X=1],<em>do</em>[M=0]) and, after opening the curtains, the room remained just as dark as it was before (<em>do</em>[X=0],<em>do</em>[M=0]). A <em>CDE</em> = 0 indicates that the probability of stubbing your toes would remain unchanged in that situation, where opening or closing the curtains does not add any ambient light into the dark room (Y10 - Y00 = 0). Either way, it is dark, and you are predicted to have a coinflip’s chance (Y10 = Y00 = .50) of stubbing your toes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/CDE-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Controlled direct effect (<em>CDE</em>) = Y1m - Y0m</figcaption>
</figure>
</div>
<p>Y01<br>
In addition to Y10 and Y00, there are additional quantities we can estimate that will help us further decompose the total effect into other meaningful components like the <em>CDE</em>. For instance, what if we were to open the curtains (<em>do</em>[X=0]) while also holding constant a sufficient amount of ambient light in the room (<em>do</em>[M=1])? In our toy data, there were eight observations in which the curtains were open and we experienced sufficient ambient light in the room that allowed us to see. We stubbed our toe in only one of these eight cases (1/8), so P(Y|<em>do</em>[X=0],<em>do</em>[M=1]) or <strong>Y01 = 0.125</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/Y01-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Y01</figcaption>
</figure>
</div>
<p>Y11<br>
Now, imagine instead we close the curtains (<em>do</em>[X=1]) and continue holding a sufficient amount of ambient light in the room constant (<em>do</em>[M=1]). There is only one observation in these toy data with X=1 and M=1. Perhaps a hall light was on, or perhaps we used our cell phone backlight to provide ambient light when the curtains were closed. In any case, we did not stub our toe in this one instance (0/1), so P(Y|<em>do</em>[X=1],<em>do</em>[M=1]) or <strong>Y11 = 0.0</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/Y11-pic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Y11</figcaption>
</figure>
</div>
</section>
<section id="sec-TEequation" class="level3">
<h3 class="anchored" data-anchor-id="sec-TEequation">TE = <em>CDE</em> + <em>INT<sub>ref</sub></em> + <em>INT<sub>med</sub></em> + <em>PIE</em></h3>
<p>With the various quantities calculated above (e.g., M0; M1; Y00; Y10; Y01; Y11), now we have enough information to decompose the total effect of X on Y into four different components. Specifically, the total effect, or TE, is a composite value representing the sum of the controlled direct effect (<em>CDE</em>); reference interaction (<em>INT<sub>ref</sub></em>); mediated interaction (<em>INT<sub>med</sub></em>); and the pure indirect effect (<em>PIE</em>). I already covered the <em>CDE</em> above. Below, I will describe the remaining three components: <em>INT<sub>ref</sub></em>, <em>INT<sub>med</sub></em>, and <em>PIE</em>.</p>
</section>
<section id="sec-INTref" class="level3">
<h3 class="anchored" data-anchor-id="sec-INTref">Reference interaction (<em>INT<sub>ref</sub></em>)</h3>
<p>When we observe a nonzero total effect of an exposure on an outcome, a common thing to do is to test whether the exposure operates indirectly through a posited mediating mechanism(s). However, an observed total effect might wholly (or partly) reflect the operation of an additive interaction between the exposure and a mechanism <em>rather than</em> (or in addition to) a mediation process as is often assumed.</p>
<p>Yes, you read that right. An observed total effect of an exposure on an outcome might (only) reflect the presence of an interaction effect, and failure to account for this when testing indirect effect hypotheses using traditional mediation tests might result in erroneously attributing moderation to mediation, or vice versa. Moderator madness indeed! If you cannot recall learning about this in your graduate stats courses, then you are not alone.</p>
<p>At this point, you can probably guess that we account for this possibility by decomposing the total effect into its various possible constituent parts. As implied here, one of the components that may comprise a total effect is the <em>reference interaction</em> (<em>INT<sub>ref</sub></em>), which is an additive interaction that operates only if mediator is present in the absence of the exposure. As <a href="https://www.hsph.harvard.edu/wp-content/uploads/sites/603/2018/04/MedInt_Ep.pdf">VanderWeele explains (p.750)</a>, the reference interaction component is nonzero when “the effect on the outcome of setting both the exposure and the mediator to present differs from the sum of the effect of having only the exposure present and the effect of having only the mediator present.”</p>
<p>Though that might sound confusing, this is essentially a classic interaction effect. Do you find yourself preferring our probability notation yet? Either way, let’s use it to calculate <em>INT<sub>ref</sub></em>.</p>
<p>The <em>INT<sub>ref</sub></em> component is nonzero when [P(Y|<em>do</em>[X=1],<em>do</em>[M=1]) - P(Y|<em>do</em>[X=0],<em>do</em>[M=0])] is not equal to [(P(Y|<em>do</em>[X=1]) - P(Y|<em>do</em>[X=0])] + [(P(Y|<em>do</em>[M=1]) - P(Y|<em>do</em>[M=0])]. Let’s check this with our toy data, using our abbreviated notation for quantities that we have already calculated:</p>
<p>Y11 - Y00<br>
= 0.0 - 0.5<br>
= -0.5</p>
<p>[Y1 - Y0] + [(P(Y|<em>do</em>[M=1]) - P(Y|<em>do</em>[M=0])]<br>
= [0.45 - 0.2] + [.11 - 0.5]<br>
= -0.25 + -0.39<br>
= -0.64</p>
<p>Since -0.5 is not equal to -0.64, we would expect a nonzero <em>INT<sub>ref</sub></em> estimate.</p>
<p>We can use the quantities calculated earlier to estimate the reference interaction using the equations provided in <a href="https://www.hsph.harvard.edu/wp-content/uploads/sites/603/2018/04/MedInt_Ep.pdf">VanderWeele’s Table 1 on p.751</a>:</p>
<p><em>INT<sub>ref</sub></em> = (Y11 - Y10 - Y01 + Y00)(M0)<br>
= (0.0 - 0.5 - 0.125 + 0.5)(0.8)<br>
= (-.125)(0.8)<br>
= -0.1</p>
<p>Here, our toy data show a small reference interaction. What does this mean and where did it come from? Well, first remember that a reference interaction is an additive interaction that operates only if mediator is present in the absence of the exposure. Likewise, we observed the mechanism (sufficient ambient light) when the curtains were open and when they were closed, so a nonzero reference interaction estimate is possible. The logic here, which mirrors that of a classic interaction, is that we must be able to assess the effect of <em>doing</em> X=1 (versus X=0) both in the absence and in the presence of the mechanism. Then, if the estimated effect of <em>doing</em> X=1 differs across those conditions (or across levels of the mechanism), we would have a nonzero exposure-mediator “reference interaction.”</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/DALL-E-INTref.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">A reference interaction is not what it sounds like. Well, maybe it is, if it sounds like an additive interaction effect that operates only if mediator is present in the absence of the exposure. (DALL-E)</figcaption>
</figure>
</div>
<p>Now, recall that we did not stub our toes in that one time we observed closed curtains and the mechanism present (Y11 = 0/1 = 0.0). However, we did stub our toe in one of the eight instances with open curtains and the mechanism present (Y01 = 1/8 = 0.125). Meanwhile, the probability of stubbing our toes was equal across exposure conditions in the absence of the mediator (Y10 = 5/10 = 0.5; Y00 = 1/2 = 0.5).</p>
<p>From these comparisons, it appears that <em>doing</em> X=1 instead of X=0 (closing curtains) slightly reduced the probability of toe stubbing with the mechanism present (Y11 - Y01 = 0.0 - 0.125 = -.125), whereas <em>doing</em> X=1 instead of X=0 had no effect on the probability of toe stubbing with the mechanism absent (Y10 - Y00 = 0.5 - 0.5 = 0). In the equation above, we essentially used these same comparisons and then weighted the resulting difference-in-differences value by the expectation of observing the mediator in the absence of exposure (i.e., M0 = probability of observing M=1 given we <em>do</em>[X=0]).<sup>3</sup></p>
<p>Strong caveat: If these were real data, I would strongly recommend against making any inferences from this <em>INT<sub>ref</sub></em> estimate given it was generated using a very small sample (e.g., only n=1 observation for one of the cells). Unfortunately, such <a href="https://journals.sagepub.com/doi/full/10.1177/0049124119826158">noisy and unreliable inferences</a> are all too common in criminology. But, that is an entry for another day.</p>
<p>One final point about the <em>INT<sub>ref</sub></em> component: As <a href="https://www.hsph.harvard.edu/wp-content/uploads/sites/603/2018/04/MedInt_Ep.pdf">VanderWeele explains (p.755)</a>, the <em>INT<sub>ref</sub></em> “requires the mediator to operate, but the effect does not come about by the exposure changing the mediator — it simply requires that the mediator is present even when the exposure is absent; the effect is ‘unmediated,’ in the sense that it does not operate by the exposure changing the mediator, but it requires the presence of the mediator nonetheless.” In contrast, the remaining two components (<em>PIE</em> and <em>INT<sub>med</sub></em>) both involve mediation such that <em>doing</em> X (i.e., the exposure) affects the outcome at least partly by changing the mediator. Now, let’s move to the next component.</p>
</section>
<section id="sec-PIE" class="level3">
<h3 class="anchored" data-anchor-id="sec-PIE">Pure indirect effect (<em>PIE</em>)</h3>
<p>As noted above, when we observe a total effect of an exposure on an outcome, that total effect might also reflect an indirect effect of the exposure operating through a specific mediating mechanism(s). In this four-way decomposition, the “pure indirect effect” (<em>PIE</em>) component is the analogue of this classic indirect effect. Formally, the <em>PIE</em> component represents the effect of the mediator in the absence of the exposure, and it is non-zero only if: (1) the exposure itself affects mediator and (2) the mediator affects the outcome when the exposure is absent.</p>
<p>Here, closing curtains decreases light in the room, and light reduces the chances of stubbing toes when the curtains are open. Using the equations in <a href="https://www.hsph.harvard.edu/wp-content/uploads/sites/603/2018/04/MedInt_Ep.pdf">VanderWeele’s Table 1</a>, we can estimate the <em>PIE</em> component using the quantities calculated earlier by estimating the effect of <em>doing</em> M in the absence of X (Y01 - Y00) and then weighting this contrast by the effect of <em>doing</em> X on the mediator (M1-M0):</p>
<p><em>PIE</em> = (Y01 - Y00)(M1 - M0)<br>
= (0.125 - 0.5)(0.09 - 0.8)<br>
= (-0.375)(-0.71)<br>
= 0.266</p>
<p>Recall, the total effect of closing the curtains on toe stubbing was 0.255. Closing curtains primarily increases our chances of stubbed toes indirectly by blocking light out of the room. In this case, the indirect effect estimate is quite close to the total effect estimate (0.266 versus 0.255). However, it does not always work out this way. In fact, as we will see, the only reason it worked out this way in our toy example is because the other two nonzero components, <em>INT<sub>ref</sub></em> and <em>INT<sub>med</sub></em>, were of approximately equal magnitude with opposite signs, so they cancel each other out when summing for the total effect.</p>
<p>This is an important point. If we had relied strictly on the total effect, or on traditional mediation test procedures, to make inferences about the exposure’s effect on the outcome via the primary mediating mechanism, then we would have been close to accurately estimating the indirect effect. However, we would have done so only by luck or accident, and we would have missed completely the other two nonzero interaction components.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/DALL-E-surreal-pie.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Pure indirect effects: As American as apple <em>PIE</em>? (DALL-E)</figcaption>
</figure>
</div>
<p>Speaking of those other two interaction components, we already discussed <em>INT<sub>ref</sub></em>; now, let’s move on to <em>INT<sub>med</sub></em>, our fourth component.</p>
</section>
<section id="sec-INTmed" class="level3">
<h3 class="anchored" data-anchor-id="sec-INTmed">Mediated interaction (<em>INT<sub>med</sub></em>)</h3>
<p>So far, we have discussed controlled direct effects, reference interaction effects, and pure indirect effects. Each of these is analogous (in certain situations) to well-known direct effects, interaction effects (moderation), and indirect effects (mediation), though their empirical connections as distinct components of a total effect may be less widely appreciated or understood.</p>
<p>This is good time to introduce the most important use cases for decomposition: When there is no exposure-mediator interaction (and strong causal assumptions hold), then traditional approaches to detecting interaction effects or testing indirect effects are often reliable and decomposition procedures may be unnecessary. However, <strong>when there is a nonzero exposure-mediator interaction, then traditional approaches become problematic, decomposition is essential, and the constituent components comprising a total effect become more complex - and potentially more numerous</strong>. For instance, in such situations, we may find a fourth nonzero component also contributes to the total effect - the “mediated interaction” or <em>INT<sub>med</sub></em>.</p>
<p>The “mediated interaction” or <em>INT<sub>med</sub></em> component represents an additive interaction that operates only if the exposure has an effect on the mechanism. As <a href="https://www.hsph.harvard.edu/wp-content/uploads/sites/603/2018/04/MedInt_Ep.pdf">VanderWeele explains (p.750)</a>, when the <em>INT<sub>med</sub></em> component is nonzero, this means that “the exposure causes the mediator, and the presence of the mediator is itself necessary for the exposure to have an effect on the outcome.”</p>
<p>In our toy example, the probability of stubbing our toes varies across values of X (i.e., whether curtains are open or closed); that is, P(Y|<em>do</em>[X=x],<em>do</em>[M=1]) varies across <em>do</em>[X=0] and <em>do</em>[X=1]. Given the presence of the mechanism (sufficient ambient light), the probability of stubbing toes is higher when the exposure is “absent” (X=0, or curtains open) than it is when the exposure is present (X=1, or curtains closed). We can check this with our data:</p>
<p>Curtains open: P(Y|<em>do</em>[X=0],<em>do</em>[M=1]) = Y01 = 1/8 = 0.125<br>
Curtains closed: P(Y|<em>do</em>[X=1],<em>do</em>[M=1]) = Y11 = 0/1 = 0.0</p>
<p>We can also use the quantities estimated earlier to calculate the <em>INT<sub>med</sub></em> component. Like the <em>INT<sub>ref</sub></em> component, we are essentially generating a weighted difference-in-difference contrast. Like the <em>PIE</em> component, we are weighting that contrast by the effect of <em>doing</em> X on the mediator (M1 - M0):</p>
<p><em>INT<sub>med</sub></em> = (Y11 - Y10 - Y01 + Y00)(M1 - M0)<br>
= (0.0 - 0.5 - 0.125 + 0.5)(0.09 - 0.8)<br>
= (-0.125)(-0.71)<br>
= 0.089</p>
<p>Recall, when the mechanism was present in this toy example (i.e., <em>AmpleLight</em>=1), toe stubbing was less likely when the curtains were closed (Y11 = 0.0) than when they were open (Y01 = 0.125). In other words, closing the curtains (<em>do</em>[X=1]) reduced the probability of toe stubbing in the presence of the mechanism. However, this effect was only observed in the presence of the mechanism; when <em>AmpleLight</em>=0, the probability of toe stubbing was the same whether the curtains were open (Y00 = 0.5) or closed (Y10 = 0.5). Moreover, closing the curtain reduced the probability of observing the mechanism (M1 - M0 = 0.09 - 0.80 = -0.71). So, the exposure causes this conditional effect, meaning it is a mediated interaction (<em>INT<sub>med</sub></em>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/DALL-E-INTmed.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">A mediated interaction is not what it sounds like either. Unless it sounds like an additive interaction that operates only if the exposure has an effect on the mechanism. (DALL-E)</figcaption>
</figure>
</div>
<p>Put differently, since <em>opening</em> the curtains increases light in the room, and opening the curtains appears to increase toe stubbing when light is present, then the exposure actually increases risks of toe stubbing by increasing the conditions (light) under which it amplifies the risks of the outcome occurring. Again, this is a mediated interaction.</p>
<p>Another caveat: I strongly caution against such real world inferences when data are so sparse; like our <em>INT<sub>ref</sub></em>, this mediated interaction is based on a comparison generated from n=1 observation in one of the cells! If we had more (and real) data, I highly doubt we would observe a negative effect of closing curtains on toe stubbing in the presence of the mechanism. Still, despite the implausibility of this toy example, I hope it helps you better understand the components that comprise a total effect.</p>
</section>
<section id="sec-revisitTE" class="level3">
<h3 class="anchored" data-anchor-id="sec-revisitTE">Revisiting <em>TE</em></h3>
<p>Before moving on to a simulated example, I want to revisit the <em>total effect</em> (TE) that we just decomposed into four component parts. Recall earlier how we calculated the total effect of X on Y as the difference between the outcome probabilities across exposed and unexposed conditions (Y1 - Y0)?</p>
<p>TE = Y1 - Y0<br>
= 0.455 - .20<br>
= 0.255</p>
<p>Well, after decomposing these four constituent components of the total effect, we can also calculate the total effect by summing these four components. This is a good way to check that our calculations were correct!</p>
<p>TE = <em>CDE</em> + <em>INT<sub>ref</sub></em> + <em>INT<sub>med</sub></em> + <em>PIE</em><br>
= 0 + (-0.1) + 0.089 + 0.266<br>
= 0.255</p>
<p>It worked! Whew.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[7]/sherlock-worried.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">You were worried. I wasn’t worried.</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-intermission2" class="level2">
<h2 class="anchored" data-anchor-id="sec-intermission2">Second intermission</h2>
<p>At this point, I am hoping the toy example above helped build your intuitions about the 4-way total effect decomposition and that you feel ready to move on to a somewhat more realistic use case with simulated data.</p>
<p>In the next post (<a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a>), I will illustrate how to use the <a href="https://bs1125.github.io/CMAverse/"><code>CMAverse</code> package</a> in R to conduct <a href="https://www.hsph.harvard.edu/tyler-vanderweele/tools-and-tutorials/">causal mediation</a> analysis, which relies on potential outcomes decomposition to disentangle indirect and interaction effects in the presence of a potential exposure-mediator interaction. <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a> will also introduce the important assumptions required to interpret results as estimates of causal effects.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In a linear model, if the multiplicative interaction coefficient departs from zero, then you should typically acccount for the possibility of an exposure-mediator interaction. However, do NOT rely on statistical significance of the interaction coefficient to make this determination as those tests are notoriously underpowered. Things get more complicated with nonlinear models, as a substantial additive exposure-mediator interaction on the outcome scale might exist even if the interaction coefficient is near-zero in magnitude on the estimation scale. Recall, this is because nonlinear models are fundamentally interactive: A linear effect of the exposure on the model estimation scale quite often implies a heterogeneous effect of the exposure on the outcome scale across covariate (e.g., mechanism) levels irrespective of the magnitude or significance of the interaction term on the linear estimation scale. <a href="https://reluctantcriminologists.com/blog-posts/%5B6%5D/modmadness-pt1#example-1">I discussed this issue in Part 1 of this series</a>, and I will provide another example of a substantial exposure-mediator interaction accompanied by a near-zero interaction coefficient in <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3, the next post in the series</a>.↩︎</p></li>
<li id="fn2"><p>At this point, you might be wondering: “Do I really need to do this? The [insert] theory I am testing does not predict such an interaction!” Well, failure to examine and adjust for the possibility of an exposure-mediator interaction is equivalent to forcing your model of the data generating process to conform to a strong and potentially incorrect theoretical assumption about underlying data generating processes. In SEM parlance, it is equivalent to “fixing” the effect of X on Y through M to be the same at all values of M. In situations where the effect of X on Y indeed varies across strata of M, failure to account for it could result in biased or incomplete inferences. In contrast, allowing for and decomposing a potential exposure-mediator interaction is, in SEM terms, akin to “freeing” that parameter, thus permitting a test of that strong theoretical assumption. In situations where no such interaction exists, the magnitude of the interaction will approach zero, and traditional and “causal” mediation approaches (e.g., “controlled” and “natural” effect estimates) will converge to the same values. In those situations, decomposition would be unnecessary yet nonetheless informative. In short, there is substantial upside and little downside apart from learning the skills to testing and accounting for exposure-mediator interactions whether or not one exists, yet there are potentially substantial inferential risks to <em>not</em> doing so when one exists. So, just how <em>a priori</em> confident are you in that likely imprecise and discursive theory of yours?↩︎</p></li>
<li id="fn3"><p>Are you wondering what the (Y11 - Y10 - Y01 + Y00) term represents? Well, you can think of it as contrasting the effect of X (i.e., <em>doing</em> X=1 - <em>doing</em> X=0) in the mechanism’s presence (M=1) versus its absence (M=0). Alternatively, you can also think of it as contrasting the effect of M (i.e,. <em>doing</em> M=1 - <em>doing</em> M=0) in the exposure’s presence (X=1) versus its absence (X=0). Let’s use the latter to show our work:<br>
(Effect of M | X=1) - (Effect of M | X=0)<br>
= (Y11 - Y10) - (Y01 - Y00)<br>
From here, we just do a bit of basic algebra:<br>
= Y11 - Y10 + (-1)(Y01 - Y00)<br>
= Y11 - Y10 - Y01 + Y00↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer2024,
  author = {Brauer, Jon},
  title = {Moderator {Madness,} {Part} 2},
  date = {2024-02-23},
  url = {https://reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer2024" class="csl-entry quarto-appendix-citeas">
Brauer, Jon. 2024. <span>“Moderator Madness, Part 2.”</span> February
23, 2024. <a href="https://reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2.html">https://reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <category>rstats</category>
  <category>causality</category>
  <category>moderation</category>
  <category>mediation</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[7]/modmadness-pt2.html</guid>
  <pubDate>Fri, 23 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[7]/decomp-cartoon2.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Near Duplicates in Survey Data Series</title>
  <dc:creator>Jake Day</dc:creator>
  <dc:creator>Jon Brauer</dc:creator>
  <dc:creator>Maja Kotlaja</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[8]/dup-index.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[8]/shining2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">You thought <a href="https://www.imdb.com/title/tt0081505/">The Shining</a> was scary? Have you looked under your data for near duplicates?</figcaption>
</figure>
</div>
<p>You have reached the landing page for our “Near Duplicates in Survey Data” series. Click below to read the posts in this series:</p>
<section id="trust-issues" class="level2">
<h2 class="anchored" data-anchor-id="trust-issues">Trust Issues</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="fig-duplicates" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="dup-series/duplicates.html"><img src="https://www.reluctantcriminologists.com/blog-posts/[8]/multiplicity.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<figcaption class="figure-caption">Post&nbsp;1: Near duplicates in survey data: Like “Multiplicity” but without the humor. (Image from <a href="https://www.imdb.com/title/tt0117108/">Multiplicity</a>)</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:60%;">
<section id="trust-issues-examining-near-duplicates-in-survey-data" class="level3">
<h3 class="anchored" data-anchor-id="trust-issues-examining-near-duplicates-in-survey-data"><a href="dup-series/duplicates.html">Trust Issues: Examining Near Duplicates in Survey Data</a></h3>
<p>Do you know how to detect exact or near duplicate rows in your data? Read on to learn more!</p>
</section>
</div>
</div>
</section>
<section id="stumbling-in-the-dark" class="level2">
<h2 class="anchored" data-anchor-id="stumbling-in-the-dark">Stumbling in the Dark</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="fig-pctmatchR" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="dup-series/pctmatchR.html"><img src="https://www.reluctantcriminologists.com/blog-posts/[8]/coding-dall-e.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<figcaption class="figure-caption">Post&nbsp;2: For this non-programmer, iterating on a percentmatch function in R was not entirely unlike stumbling in the dark. (Image created using <a href="https://openai.com/dall-e-2">DALL-E</a>)</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:60%;">
<section id="stumbling-in-the-dark-buildingiterating-an-r-function-to-match-statas-percentmatch" class="level3">
<h3 class="anchored" data-anchor-id="stumbling-in-the-dark-buildingiterating-an-r-function-to-match-statas-percentmatch"><a href="dup-series/pctmatchR.html">Stumbling in the Dark: Building/Iterating an R Function to Match Stata’s percentmatch</a></h3>
<p>If you are looking for more information about the modified R function we used to detect near duplicates, then you have come to the right place. (Code shared; detailed write-up forthcoming)</p>
</section>
</div>
</div>
</section>
<section id="trust-issues-part-2" class="level2">
<h2 class="anchored" data-anchor-id="trust-issues-part-2">Trust Issues, Part 2</h2>
<div class="columns">
<div class="column" style="width:35%;">
<div id="fig-duplicates-pt2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="dup-series/duplicates-pt2.html"><img src="https://www.reluctantcriminologists.com/blog-posts/[8]/matrix-sequel.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<figcaption class="figure-caption">Post&nbsp;3: Investigating near duplicates in different data: Will the sequel live up to the original? (Image from <a href="https://www.imdb.com/title/tt0234215/">Matrix: Reloaded</a>)</figcaption>
</figure>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:60%;">
<section id="trust-issues-part-2-investigating-near-duplicates-in-different-data" class="level3">
<h3 class="anchored" data-anchor-id="trust-issues-part-2-investigating-near-duplicates-in-different-data"><a href="dup-series/duplicates-pt2.html">Trust Issues, Part 2: Investigating Near Duplicates in Different Data</a></h3>
<p>This follow-up to our first entry on near duplication in survey data analyzes near duplicates in three more international survey data sets. (Forthcoming)</p>
</section>
</div>
</div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{day2023,
  author = {Day, Jake and Brauer, Jon and Kotlaja, Maja},
  title = {Near {Duplicates} in {Survey} {Data} {Series}},
  date = {2023-10-10},
  url = {https://www.reluctantcriminologists.com/blog-posts/[8]/dup-index.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-day2023" class="csl-entry quarto-appendix-citeas">
Day, Jake, Jon Brauer, and Maja Kotlaja. 2023. <span>“Near Duplicates in
Survey Data Series.”</span> October 10, 2023. <a href="https://www.reluctantcriminologists.com/blog-posts/[8]/dup-index.html">https://www.reluctantcriminologists.com/blog-posts/[8]/dup-index.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <category>rstats</category>
  <category>survey research</category>
  <category>duplication</category>
  <category>fraud</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[8]/dup-index.html</guid>
  <pubDate>Tue, 10 Oct 2023 04:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[8]/shining2.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Moderator Madness, Part 1</title>
  <dc:creator>Jon Brauer</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/interact-cartoon2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Two lemmings confused by nonlinear interactions (with help from DALL-E)</figcaption>
</figure>
</div>
<section id="preamble" class="level2">
<h2 class="anchored" data-anchor-id="preamble">Preamble</h2>
<p>This is the first of a three-part blog series on modeling moderators in criminological data.<sup>1</sup> I started writing this series as a single entry designed introduce the need and a method for disentangling indirect and interaction effects in the presence of a potential exposure-mediator interaction. That topic is now the focus of <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a> and <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a> in this series.</p>
<p>Along the way, I intended to briefly cover issues I routinely find myself raising in manuscript reviews in criminology related to the estimation and interpretation of interaction effects with binary or skewed count outcome variables. First, estimating interactions with such data using linear regression methods can generate misleading interaction terms that are data artifacts of a poorly fitting model. Second, generalized linear regression models with nonlinear link functions (e.g., logistic, Poisson, and negative binomial regression) may generate coefficients that more accurately summarize the underlying data generating process, but these coefficients - and especially the interaction terms - often are misinterpreted.</p>
<p>We touched upon this topic in our <a href="https://reluctantcriminologists.com/blog-posts/%5B5%5D/colliders#sec-detour">previous post on collider bias</a> but, as an issue I encounter repeatedly when reviewing manuscripts, I felt it needed a more detailed treatment before digging into exposure-mediator interactions. Well, this important aside ultimately was not brief at all, so it seemed more appropriate to write it as a standalone post. So, this topic is now the focus of Part 1.</p>
<p>Now, let’s get started with an “imaginary” story about an imaginary author before moving on to illustrate these issues using imaginary (ok, simulated) data.</p>
</section>
<section id="sec-twopapers" class="level2">
<h2 class="anchored" data-anchor-id="sec-twopapers">Two papers walk into a bar…</h2>
<p>Imagine the following: In one study, a researcher hypothesizes the existence of a causal mediation process, such that <em>parental support</em> causes <em>delinquency</em> both directly and indirectly through its mediated effect on <em>strong moral beliefs</em>. Then, with this theoretical assumption at work, they build linear regression models to test for and then find evidence of an indirect effect, which leads to a published paper describing support for this hypothesized causal process. That assumed causal process can be simply depicted in the following causal diagram or directed acyclic graph (DAG):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># devtools::install_github("BS1125/CMAverse")</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Load libraries </span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(here) #start by loading here package for self-referential file directory structure</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(groundhog) #load groundhog package for reproducible date-specified library loading</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # here() #check here() working directory</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # get.groundhog.folder() # check default groundhog working directory - may be diff than here()</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set.groundhog.folder(here()) #set groundhog working directory to same as here()</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># groundhog.day="2023-06-15" #assign date as object (at least two days before today)</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pkgs &lt;- c("tidyverse", "simstudy", "ggplot2", "patchwork", "truncnorm", "see",</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           "dagitty", "ggdag", "sjPlot", "ggthemes", "margins", </span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           "ggraph", "gt", "gtsummary")</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># groundhog.library("github::BS1125/CMAverse", groundhog.day)</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># groundhog.library(pkgs, groundhog.day)</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(simstudy)</span>
<span id="cb1-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html</span></span>
<span id="cb1-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://kgoldfeld.github.io/simstudy/articles/simstudy.html</span></span>
<span id="cb1-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(truncnorm)</span>
<span id="cb1-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(see)</span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dagitty)</span>
<span id="cb1-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdag)</span>
<span id="cb1-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sjPlot)</span>
<span id="cb1-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggthemes)</span>
<span id="cb1-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(margins)</span>
<span id="cb1-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(CMAverse)</span>
<span id="cb1-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggraph)</span>
<span id="cb1-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb1-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtsummary)</span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#function to shorten arrows (edges)</span></span>
<span id="cb1-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://stackoverflow.com/questions/65420136/how-do-you-adjust-the-arrows-in-a-ggplot-of-a-ggdag</span></span>
<span id="cb1-42">shorten_dag_arrows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(tidy_dag, proportion){</span>
<span id="cb1-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update underlying ggdag object</span></span>
<span id="cb1-44">tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, </span>
<span id="cb1-45">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(xend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x, </span>
<span id="cb1-46">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(yend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y,</span>
<span id="cb1-47">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xstart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> xend,</span>
<span id="cb1-48">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ystart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>yend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> yend)</span>
<span id="cb1-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(tidy_dag)</span>
<span id="cb1-50">}</span>
<span id="cb1-51"></span>
<span id="cb1-52"></span>
<span id="cb1-53"></span>
<span id="cb1-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#build dag</span></span>
<span id="cb1-55">nointDAG <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb1-56">  Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> StrgMoralBlfs,</span>
<span id="cb1-57">  StrgMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport, </span>
<span id="cb1-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>,</span>
<span id="cb1-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb1-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb1-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ParentSupport=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrgMoralBlfs=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ParentSupport=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrgMoralBlfs=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-63">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() </span>
<span id="cb1-64"></span>
<span id="cb1-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#shorten edges</span></span>
<span id="cb1-66">nointDAGp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(nointDAG, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb1-67"></span>
<span id="cb1-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot dag</span></span>
<span id="cb1-69">fig1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nointDAGp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Support"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Moral</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Beliefs"</span>), </span>
<span id="cb1-72">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb1-77">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggtitle("DAG w/mediation &amp; no interaction") + </span></span>
<span id="cb1-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb1-79"></span>
<span id="cb1-80"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fig1.png"</span>)</span></code></pre></div>
</details>
</div>
<div class="columns">
<div class="column" style="width:58%&quot;;">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/DAG1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 1. <a href="fig1.png">DAG</a> for mediation (&amp; moderation) paper</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:37%;">
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="fake_paper1.jpg"><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/fake_paper1.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><a href="fake_paper1.jpg">Imaginary Paper #1</a></p>
</div>
</div>
</div>
<p>After submitting the mediation paper for review and potential publication, imagine the researcher then considers the possibility that parental support and strong moral beliefs might also interact in predicting delinquency. For instance, perhaps they now posit that moral beliefs have a more pronounced negative effect on delinquency among youth who perceive low parental support, yet moral beliefs might have a weak or null effect (e.g., it might be a redundant cause) among youth who perceive high parental support.</p>
<p>Though the causal processes for both “paper 1” and “paper 2” could be represented by the same structural DAG depicted in Figure 1 above,<sup>2</sup> it is common for criminologists to explicitly depict moderating relationships in causal diagrams. So, for the sake of familiarity, I also present a modified causal diagram depicting the posited moderation (interaction effect) for “paper 2” in Figure 2 below. The moderation indicator is a red dashed arrow to signify its departure from traditional DAG rules.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">intDAG <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb2-2">  Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> StrgMoralBlfs,</span>
<span id="cb2-3">  StrgMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport, </span>
<span id="cb2-4">  holder <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport, </span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>,</span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ParentSupport=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrgMoralBlfs=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holder=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb2-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ParentSupport=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">StrgMoralBlfs=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holder=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-10">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() </span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#shorten edges</span></span>
<span id="cb2-13">intDAGp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(intDAG, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#create factor variable to isolate edge of interest, permits specifying edge color</span></span>
<span id="cb2-16">intDAGp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> intDAGp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">myedge1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(intDAGp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> intDAGp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>to <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"holder"</span>,</span>
<span id="cb2-18">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no"</span>), </span>
<span id="cb2-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">modlinetype =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(myedge1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"solid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>)</span>
<span id="cb2-20">  ) </span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot dag</span></span>
<span id="cb2-23">fig2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> intDAGp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xstart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ystart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color=</span>myedge1, </span>
<span id="cb2-25">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_linetype =</span> modlinetype), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(x, name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"holder"</span>), </span>
<span id="cb2-27">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Support"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Moral</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Beliefs"</span>), </span>
<span id="cb2-28">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-30">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># guides(fill = 'none', color = 'none', edge_color = 'none') +</span></span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_edge_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maroon"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change second color to highlight focal myedge1 </span></span>
<span id="cb2-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggtitle("DAG w/mediation &amp; interaction") + </span></span>
<span id="cb2-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb2-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fig2.png"</span>)</span></code></pre></div>
</details>
</div>
<div class="columns">
<div class="column" style="width:58%&quot;;">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/DAG2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 2. <a href="fig2.png">Modified causal diagram</a> depicting moderation</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:37%;">
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="fake_paper2.jpg"><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/fake_paper2.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p><a href="fake_paper2.jpg">Imaginary Paper #2</a></p>
</div>
</div>
</div>
<p>No problem! We know what to do - just build another regression model, throw in an interaction term, and test for the interaction, right? Another paper, another brick in the wall of (<a href="https://www.significancemagazine.com/science/593-cargo-cult-statistics-and-scientific-crisis">cargo cult</a>) science.</p>
<p>Please, don’t leave just yet. I promise this is not another blog entry about piecemeal or <a href="https://publicationethics.org/search?t=salami">salami sliced</a> publications.<sup>3</sup> While on the subject of what this blog is <em>not</em> about, I will also refrain from discussing the <a href="https://ukrio.org/wp-content/uploads/PerverseIncentives_SJR.pdf">perverse structural incentives</a> that motivate piecemeal publishing.<sup>4</sup></p>
<p>Those are topics for another day. In this blog series, my main focus is to introduce some common issues criminologists face, often unknowingly, when modeling moderating relationships. Ultimately, my aim in <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a> and <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a> will be to build upon the examples in Part 1 to introduce a statistical issue that might be wreaking havoc behind the scenes in many situations like the one described above: the <em>the inability to distinguish mediation from moderation</em> in commonly used regression-based tests of indirect or interaction effects in the presence of an <em>exposure-mediator interaction</em>. In doing so, I will make the case that both studies should really be combined into a single study in which the researcher explicitly models both the mediating and moderating relationships and then uses a potential outcomes approach to decompose the overlapping indirect and interaction effects. But, before we get there, I want to point out a couple other interaction-related pitfalls that threaten to snare researchers on the road to testing interaction effects.</p>
<section id="sec-nonnormal" class="level3">
<h3 class="anchored" data-anchor-id="sec-nonnormal">When data are normally non-normal, it’s interactions all the way down</h3>
<p>Before attempting to tackle the problem of distinguishing mediation from moderation (in Parts 2 and 3), let’s first consider that the outcome variable in the imaginary papers discussed above - delinquent behaviors - is a relatively rare event. As such, delinquency measures tend to be quite positively skewed, resembling rare Poisson or negative binomial event count distributions.</p>
<p>Why does this matter? Well, <a href="https://www.jstor.org/stable/23366756">as some criminologists have warned</a>, testing a moderation hypothesis using a multiplicative interaction term in a linear regression model fit to a highly skewed outcome variable like delinquency can generate significant interaction effect estimates that are statistical artifacts caused by improper model specification. Meanwhile, if these outcomes are modeled using generalized linear equations with nonlinear link functions (e.g., logistic; Poisson; negative binomial), then the interpretation of <a href="https://www.sciencedirect.com/science/article/abs/pii/S0165176503000326">interaction terms</a> changes drastically and, technically, all model coefficients are conditional - essentially, it is interactions all the way down.</p>
<p>Put simply, conceptualizing, estimating, and interpreting interaction effects is much harder than many people realize when their outcome variable is binary, rare event, and/or highly skewed, as is often the case when studying crime. In these situations, I will illustrate why it is advisable to specify the proper functional form, to use caution or restraint when interpreting coefficients, and to visualize interactions by plotting them, preferably on the (predicted probability or event rate) outcome scale.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/not-norm.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">“It’s not you, it’s me.” Nonlinear interactions are statistical heartbreakers.</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-outline" class="level2">
<h2 class="anchored" data-anchor-id="sec-outline">Outline of the post</h2>
<p>In Part 1, I will illustrate some of these issues with two examples using simulated data.</p>
<section id="sec-Example1" class="level3">
<h3 class="anchored" data-anchor-id="sec-Example1">Example 1</h3>
<p>In the first example, I assume the causal process from the first imaginary paper (“paper 1”) is the true underlying data generating process by simulating data that include a direct effect of <em>parental support</em> on <em>delinquency</em> and an indirect effect through <em>strong moral beliefs</em>. Importantly, in this first example, I do not include a multiplicative interaction term (i.e., an exposure-mediator interaction) in the linear equation predicting logged delinquency event rates when simulating the data. So, if a linear model estimates a non-negligible and statistically significant interaction coefficient, then the result might be due to random sampling variation, or it could be an artifact from inappropriate model specification (e.g., applying a linear model to a skewed outcome variable).</p>
<p>The central aim of this first example is to demonstrate such an interaction artifact in a linear model. Along the way, I hope to reinforce some important intuitions about generalized linear models with nonlinear link functions (e.g., logistic; Poisson; negative binomial): (1) that these models are fundamentally interactive in the outcome <a href="https://deepblue.lib.umich.edu/bitstream/handle/2027.42/90179/hesr1314.pdf%3Fsequence%3D1">scale of interest</a>; and (2) that you should <a href="https://sociologicalscience.com/articles-v6-4-81/">ignore the sign and statistical significance of interaction coefficients</a> and, instead, improve inferences through plotting potential interactions in the outcome scale of interest.</p>
</section>
<section id="sec-Example2" class="level3">
<h3 class="anchored" data-anchor-id="sec-Example2">Example 2</h3>
<p>In the second example, I assume that the true data generating process underlying both imaginary papers (i.e., “paper 1” and “paper 2” in our example above) is an integrated causal model in which moral beliefs is both a mediating and moderating mechanism. That is, in the simulated data for the second example, there is a true indirect effect of <em>parental support</em> on delinquency through <em>strong moral beliefs</em> as well as a direct effect of <em>parental support</em> on <em>delinquency</em> that varies systematically across levels of (i.e., “interacts with”) <em>strong moral beliefs</em>.</p>
<p>In Part 1, I will simply illustrate how adding a small multiplicative (exposure-mediator) interaction term on the estimation scale might further change predicted counts on natural outcome scale. In doing so, I will use this example again to reinforce the lesson that you should ignore the sign and statistical significance of interaction coefficients from nonlinear models.</p>
<p>In Parts 2 and 3 of the blog series, I will illustrate how an exposure-mediator interaction entangles indirect and interaction effects in a way that requires decomposition of these effects. Part 3 will also pick up here using similar simulated data from this example to illustrate how one can accomplish effect decomposition in R with a <a href="https://www.hsph.harvard.edu/tyler-vanderweele/tools-and-tutorials/">causal mediation approach</a> that involves clever estimation of potential outcomes and transparent acknowledgement of strong causal assumptions underlying those estimates.</p>
</section>
</section>
<section id="sec-Ex1" class="level2">
<h2 class="anchored" data-anchor-id="sec-Ex1">Example 1: No interaction on linear estimation scale</h2>
<p>Let’s simulate some data.<sup>5</sup> <em>Parental support</em> is a continuous, normally distributed, mean-centered variable. <em>Strong moral beliefs</em> is a negatively skewed ordinal variable ranging from 0 to 5, created by reverse-scoring a truncated Poisson-distributed <em>weak moral beliefs</em> variable. <em>Delinquency</em> is a positively skewed, Poisson-distributed event count variable ranging from 0 to a truncated theoretical maximum of 7 (observed max = 6 in first simulation).</p>
<p>In the first simulation, <em>parental support</em> causes <em>strong moral beliefs</em> (positive association), whereas both <em>parental support</em> and <em>strong moral beliefs</em> cause delinquency (negative associations). There is no multiplicative interaction between <em>parental support</em> and <em>strong moral beliefs</em> in the linear equation predicting logged delinquency event rates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data (Sim.1)</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb3-6">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">850</span> </span>
<span id="cb3-7"></span>
<span id="cb3-8">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb3-9">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-10">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb3-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.3 + (-.5)*ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb3-12">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb3-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + (-.25)*ParentSupport + .4*WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb3-14">simdat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(n, def)</span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap LowMoral at 5 (0-5 item) if necessary - randomly replace any oob values with values in bounds </span></span>
<span id="cb3-17">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb3-18">simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-19">simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs</span>
<span id="cb3-20"></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap Delinquency at 7 (0-7 item) if necessary - randomly replace any oob values with in bounds values</span></span>
<span id="cb3-22">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb3-23">simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-24"></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot variable distributions</span></span>
<span id="cb3-26"></span>
<span id="cb3-27">ParSupplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>ParentSupport, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb3-29">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, </span>
<span id="cb3-30">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb3-33">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb3-34">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental Support"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb3-36"></span>
<span id="cb3-37">StrgMoralplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb3-39">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb3-42">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb3-43">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong moral beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb3-45"></span>
<span id="cb3-46">Delqplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Delinquency, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb3-48">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb3-51">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb3-52">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb3-54"></span>
<span id="cb3-55"></span>
<span id="cb3-56">ParSupplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> StrgMoralplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Delqplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_area</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/Sim1vars-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 3. Simulated variable distributions</figcaption>
</figure>
</div>
</div>
</div>
<section id="sec-Ex1mod" class="level3">
<h3 class="anchored" data-anchor-id="sec-Ex1mod">Model &amp; plot interaction artifact</h3>
<p>Now, let’s build a model for our hypothetical “paper 2” in which we test the hypothesis that <em>parental support</em> and <em>strong moral beliefs</em> interact to predict delinquency.</p>
<p>Recall, I included an indirect effect but did not explicitly include an interaction when simulating the data, so some readers might not expect to observe a statistically significant interaction coefficient if we include a multiplicative interaction term. Yet, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3447245/">nonlinear models complicate things</a>, as such models generate conditional effect estimates that might still be interactive on particular scales (e.g., on probability or event count scale versus linear scale of estimation).</p>
<p>To illustrate, I will present results of a linear model regressing <em>delinquency</em> on <em>parental support</em>, <em>strong moral beliefs</em>, and their interaction, as well as a comparable generalized linear (aka, “nonlinear”) model specifying a Poisson distribution for delinquency with a log link. Though I will present the key coefficients from regression models, I will not get into <a href="https://www.r-bloggers.com/2021/07/easystats-quickly-investigate-model-performance/">model performance or checks</a>, and I will rely primarily on examining marginal effects plots at low (-2SD) and high (+2SD) parental support values in the outcome scale (predicted delinquency event counts) using <a href="https://strengejacke.github.io/sjPlot/articles/plot_marginal_effects.html"><code>sjPlot::plot_model()</code> function</a> to interpret results and determine the existence of interactions.</p>
<p>Additionally - and this is important - in building the “imaginary paper 2” model, I conceptualize moral beliefs as the focal cause and parental support as the moderator in this Part 1 entry, despite the fact that parental support was the focal cause and moral beliefs was the mediating mechanism in imaginary paper 1. Why would I switch things up like this? Because I can. It is inconsequential to the statistical issues I want to illustrate here. However, doing so permits me to reinforce a key theme found throughout our blog: Correlations - including indirect and conditional (interaction) estimates - are statistically symmetric and can be modeled in a variety of correct and incorrect ways. Here, I want you to imagine how easy it would be for an author to write a paper using the tables and plots below, all while knowing that it might not accurately depict the underlying causal processes used to motivate and generate the simulated data. As we have discussed in previous posts on <a href="https://reluctantcriminologists.com/blog-posts/%5B4%5D/causation-no-corr#sec-trap">causation without correlation</a> and on <a href="https://reluctantcriminologists.com/blog-posts/%5B5%5D/colliders#sec-ex2">colliders</a>, data analysis alone cannot tell us that our models are incorrectly specified; only theory (and our theory-based DAG) can do that for us.<sup>6</sup></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/datacantspeak2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Data cannot speak meme</figcaption>
</figure>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.1 linear model</span></span>
<span id="cb4-4">lm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat)</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.1 nonlinear model</span></span>
<span id="cb4-7">glm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set table theme</span></span>
<span id="cb4-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gtsummary_compact</span>()</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function for custom p-values</span></span>
<span id="cb4-13">roundp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb4-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(</span>
<span id="cb4-15">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x), </span>
<span id="cb4-16">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>,</span>
<span id="cb4-17">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scientific =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scientific =</span> F))</span>
<span id="cb4-18">    )</span>
<span id="cb4-19">  } </span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function for reg output w/custom p-values</span></span>
<span id="cb4-22">regsum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(mymod) {</span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(mymod, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb4-24">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pvalue_fun =</span> roundp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_significance_stars</span>(</span>
<span id="cb4-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_p =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-29">      )</span>
<span id="cb4-30">}</span>
<span id="cb4-31"></span>
<span id="cb4-32">Ex1tab1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(lm1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-34">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Simulation 1"</span>) </span>
<span id="cb4-35"></span>
<span id="cb4-36">Ex1tab2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-38">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear Poisson model, Simulation 1"</span>) </span></code></pre></div>
</details>
</div>
<section id="sec-Ex1results" class="level4">
<h4 class="anchored" data-anchor-id="sec-Ex1results">Results (Simulation 1)</h4>
<p><em>Note: Click on the tabs to switch between models.</em></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Linear model</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Nonlinear Poisson model</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">Ex1tab1</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="fzwtfmozjv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fzwtfmozjv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fzwtfmozjv thead, #fzwtfmozjv tbody, #fzwtfmozjv tfoot, #fzwtfmozjv tr, #fzwtfmozjv td, #fzwtfmozjv th {
  border-style: none;
}

#fzwtfmozjv p {
  margin: 0;
  padding: 0;
}

#fzwtfmozjv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fzwtfmozjv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fzwtfmozjv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fzwtfmozjv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fzwtfmozjv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fzwtfmozjv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzwtfmozjv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fzwtfmozjv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fzwtfmozjv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fzwtfmozjv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fzwtfmozjv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fzwtfmozjv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fzwtfmozjv .gt_spanner_row {
  border-bottom-style: hidden;
}

#fzwtfmozjv .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fzwtfmozjv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fzwtfmozjv .gt_from_md > :first-child {
  margin-top: 0;
}

#fzwtfmozjv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fzwtfmozjv .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fzwtfmozjv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fzwtfmozjv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fzwtfmozjv .gt_row_group_first td {
  border-top-width: 2px;
}

#fzwtfmozjv .gt_row_group_first th {
  border-top-width: 2px;
}

#fzwtfmozjv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzwtfmozjv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fzwtfmozjv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fzwtfmozjv .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzwtfmozjv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzwtfmozjv .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fzwtfmozjv .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fzwtfmozjv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fzwtfmozjv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzwtfmozjv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fzwtfmozjv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzwtfmozjv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fzwtfmozjv .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzwtfmozjv .gt_left {
  text-align: left;
}

#fzwtfmozjv .gt_center {
  text-align: center;
}

#fzwtfmozjv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fzwtfmozjv .gt_font_normal {
  font-weight: normal;
}

#fzwtfmozjv .gt_font_bold {
  font-weight: bold;
}

#fzwtfmozjv .gt_font_italic {
  font-style: italic;
}

#fzwtfmozjv .gt_super {
  font-size: 65%;
}

#fzwtfmozjv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fzwtfmozjv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fzwtfmozjv .gt_indent_1 {
  text-indent: 5px;
}

#fzwtfmozjv .gt_indent_2 {
  text-indent: 10px;
}

#fzwtfmozjv .gt_indent_3 {
  text-indent: 15px;
}

#fzwtfmozjv .gt_indent_4 {
  text-indent: 20px;
}

#fzwtfmozjv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Linear model, Simulation 1</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Beta</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Beta</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">2.3***</td>
<td headers="std.error" class="gt_row gt_center">0.177</td>
<td headers="ci" class="gt_row gt_center">1.9, 2.6</td>
<td headers="p.value" class="gt_row gt_center">4.03e-35</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-0.78***</td>
<td headers="std.error" class="gt_row gt_center">0.159</td>
<td headers="ci" class="gt_row gt_center">-1.1, -0.46</td>
<td headers="p.value" class="gt_row gt_center">1.24e-06</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.36***</td>
<td headers="std.error" class="gt_row gt_center">0.040</td>
<td headers="ci" class="gt_row gt_center">-0.44, -0.28</td>
<td headers="p.value" class="gt_row gt_center">6.34e-19</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">0.14***</td>
<td headers="std.error" class="gt_row gt_center">0.036</td>
<td headers="ci" class="gt_row gt_center">0.07, 0.21</td>
<td headers="p.value" class="gt_row gt_center">1.30e-04</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">Ex1tab2</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="agwjqpqxqp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#agwjqpqxqp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#agwjqpqxqp thead, #agwjqpqxqp tbody, #agwjqpqxqp tfoot, #agwjqpqxqp tr, #agwjqpqxqp td, #agwjqpqxqp th {
  border-style: none;
}

#agwjqpqxqp p {
  margin: 0;
  padding: 0;
}

#agwjqpqxqp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#agwjqpqxqp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#agwjqpqxqp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#agwjqpqxqp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#agwjqpqxqp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agwjqpqxqp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agwjqpqxqp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#agwjqpqxqp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#agwjqpqxqp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#agwjqpqxqp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#agwjqpqxqp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#agwjqpqxqp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#agwjqpqxqp .gt_spanner_row {
  border-bottom-style: hidden;
}

#agwjqpqxqp .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#agwjqpqxqp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#agwjqpqxqp .gt_from_md > :first-child {
  margin-top: 0;
}

#agwjqpqxqp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#agwjqpqxqp .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#agwjqpqxqp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#agwjqpqxqp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#agwjqpqxqp .gt_row_group_first td {
  border-top-width: 2px;
}

#agwjqpqxqp .gt_row_group_first th {
  border-top-width: 2px;
}

#agwjqpqxqp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#agwjqpqxqp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#agwjqpqxqp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#agwjqpqxqp .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agwjqpqxqp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#agwjqpqxqp .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#agwjqpqxqp .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#agwjqpqxqp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#agwjqpqxqp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#agwjqpqxqp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agwjqpqxqp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#agwjqpqxqp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#agwjqpqxqp .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#agwjqpqxqp .gt_left {
  text-align: left;
}

#agwjqpqxqp .gt_center {
  text-align: center;
}

#agwjqpqxqp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#agwjqpqxqp .gt_font_normal {
  font-weight: normal;
}

#agwjqpqxqp .gt_font_bold {
  font-weight: bold;
}

#agwjqpqxqp .gt_font_italic {
  font-style: italic;
}

#agwjqpqxqp .gt_super {
  font-size: 65%;
}

#agwjqpqxqp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#agwjqpqxqp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#agwjqpqxqp .gt_indent_1 {
  text-indent: 5px;
}

#agwjqpqxqp .gt_indent_2 {
  text-indent: 10px;
}

#agwjqpqxqp .gt_indent_3 {
  text-indent: 15px;
}

#agwjqpqxqp .gt_indent_4 {
  text-indent: 20px;
}

#agwjqpqxqp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Nonlinear Poisson model, Simulation 1</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">1.3***</td>
<td headers="std.error" class="gt_row gt_center">0.178</td>
<td headers="ci" class="gt_row gt_center">0.94, 1.6</td>
<td headers="p.value" class="gt_row gt_center">2.91e-13</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-0.13</td>
<td headers="std.error" class="gt_row gt_center">0.140</td>
<td headers="ci" class="gt_row gt_center">-0.41, 0.14</td>
<td headers="p.value" class="gt_row gt_center">0.340</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.39***</td>
<td headers="std.error" class="gt_row gt_center">0.042</td>
<td headers="ci" class="gt_row gt_center">-0.47, -0.31</td>
<td headers="p.value" class="gt_row gt_center">2.52e-20</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.03</td>
<td headers="std.error" class="gt_row gt_center">0.035</td>
<td headers="ci" class="gt_row gt_center">-0.10, 0.04</td>
<td headers="p.value" class="gt_row gt_center">0.372</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Note there is a statistically significant multiplicative interaction term in the linear model (<em>b</em> = 0.14, <em>p</em> &lt; 0.001). Though the interaction term is not significant in the nonlinear Poisson model, remember that we cannot interpret these <em>beta</em> coefficients the same way as we do linear regression coefficients. As noted earlier, models with nonlinear link functions are fundamentally conditional and potentially interactive on different scales of interest; relying on the significance and sign or direction of coefficients alone can lead to serious misinterpretation of results from regression models with nonlinear link functions. Instead, I prefer to rely on plots of predicted delinquency event rates to interpret model results, which lend themselves to more natural interpretations in the original outcome metric.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot interaction in outcome scale</span></span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use -2SD &amp; +2SD for low &amp; high parental support, respectively, to plot interaction  </span></span>
<span id="cb7-6">LowParSup <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ParentSupport) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs)</span>
<span id="cb7-7"></span>
<span id="cb7-8">HiParSup <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ParentSupport) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs)</span>
<span id="cb7-9"></span>
<span id="cb7-10"></span>
<span id="cb7-11">plot_lm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(lm1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  </span>
<span id="cb7-12">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.1"</span>)  </span>
<span id="cb7-15"></span>
<span id="cb7-16">plot_glm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  </span>
<span id="cb7-17">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.1"</span>)  </span>
<span id="cb7-20"></span>
<span id="cb7-21"></span>
<span id="cb7-22">plot_lm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb7-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,</span>
<span id="cb7-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horizontal'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A comparison of the effects plotted in the predicted event rate metric suggests there is an interaction in the linear model (i.e., the predicted event rate lines are not parallel) but no interaction in the nonlinear model (i.e., lines are nearly parallel). Recall, the data were simulated from a mediation model without any interactions between these two causes in the linear estimation scale, so we suspect <strong>the observed interaction in the linear model outcome scale is likely a data artifact created by applying a linear model to a skewed outcome variable</strong>.</p>
</section>
</section>
<section id="sec-nonlinear" class="level3">
<h3 class="anchored" data-anchor-id="sec-nonlinear">In nonlinear models, it’s interactions all the way down</h3>
<p>You might be thinking that we can solve this interaction artifact problem by simply specifying a Poisson distribution rather than a linear model. After all, the nonlinear Poisson model is a better match to the underlying data generating process and, as desired, that model does not show an interaction in the outcome scale. That is certainly important since, as I noted earlier, applying a linear model to skewed outcome data indeed can generate interaction artifacts. Unfortunately, things are not so simple. When we use nonlinear link functions, <em>all</em> our model coefficients are conditional, and our model-based predictions are inherently scale-dependent.</p>
<p>What does this mean? Well, imagine I were to adjust for another covariate in model - say, a normally distributed control variable with a mean = 0. The focal coefficients and predicted event rate plots may change substantially after adjusting for this new covariate - even if the covariate is only correlated with the outcome and uncorrelated with either of the focal predictors! (I will illustrate this later in Example 1c.) Again, this scale-dependence is due to the nonlinear transformation in generalized linear models; traditional linear regression coefficients do not share this conditional property because the outcome scale is constant.</p>
<p>Much has been written about this topic; I recommend <a href="https://stats.oarc.ucla.edu/stata/seminars/deciphering-interactions-in-logistic-regression/">this post</a> for a brief primer and accessible examples using logistic regression. I particularly appreciate their “Quote of the day”:</p>
<blockquote class="blockquote">
<p>Departures from additivity imply the presence of interaction types, but additivity does not imply the absence of interaction types. (Greenland &amp; Rothman, 1998)</p>
</blockquote>
<p>I will try to further strengthen this intuition by slightly modifying the first example.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/zach-interact.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Greenland &amp; Rothman (1998) said it with the best words. But reading is so hard… ;)</figcaption>
</figure>
</div>
</section>
<section id="sec-Ex1b" class="level3">
<h3 class="anchored" data-anchor-id="sec-Ex1b">Example 1b: Slight modification to simulated data</h3>
<p>In the code below, I made only one slight modification to the data simulation in Example 1: I specified a stronger linear effect of <em>moral beliefs</em> on <em>delinquency</em> by increasing from <em>b</em> = 0.4 to <em>b</em> = 0.6. I did not add a multiplicative interaction term, nor did I explicitly change the functional form or nature of the relationships in our simulation. Rather, I simply increased the strength of the linear correlation between the mediator and the outcome. Let’s see what happens.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data (Sim.1b)</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb8-8">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">850</span> </span>
<span id="cb8-9"></span>
<span id="cb8-10">def1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb8-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-12">def1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb8-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.3 + (-.5)*ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb8-14">def1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + (-.25)*ParentSupport + .6*WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb8-16">simdat1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(n, def1b)</span>
<span id="cb8-17"></span>
<span id="cb8-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap LowMoral at 5 (0-5 item) - randomly replace oob values with values in bounds </span></span>
<span id="cb8-19">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat1b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb8-20">simdat1b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb8-21">simdat1b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> simdat1b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs</span>
<span id="cb8-22"></span>
<span id="cb8-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap Delinquency at 7 (0-7 item) - randomly replace oob values with in bounds values</span></span>
<span id="cb8-24">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat1b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb8-25">simdat1b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb8-26"></span>
<span id="cb8-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.1b linear model</span></span>
<span id="cb8-28">lm1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat1b)</span>
<span id="cb8-29"></span>
<span id="cb8-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sime.1b nonlinear model</span></span>
<span id="cb8-31">glm1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb8-32"></span>
<span id="cb8-33">Ex1tab1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(lm1b) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-35">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.1b"</span>) </span>
<span id="cb8-36"></span>
<span id="cb8-37">Ex1tab2b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm1b) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-39">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.1b"</span>) </span>
<span id="cb8-40"></span>
<span id="cb8-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot interaction</span></span>
<span id="cb8-42"></span>
<span id="cb8-43">plot_lm1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(lm1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  </span>
<span id="cb8-44">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.1b"</span>)  </span>
<span id="cb8-47"></span>
<span id="cb8-48">plot_glm1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,</span>
<span id="cb8-49">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, </span>
<span id="cb8-50">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, </span>
<span id="cb8-55">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.1b"</span>)  </span></code></pre></div>
</details>
</div>
<section id="sec-Ex1bresults" class="level4">
<h4 class="anchored" data-anchor-id="sec-Ex1bresults">Results (Sim.1b, Stronger covariate effect)</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Linear model</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Nonlinear Poisson model</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" aria-controls="tabset-2-3" aria-selected="false">Prediction Plots</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">Ex1tab1b</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="dtzwoizpym" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dtzwoizpym table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dtzwoizpym thead, #dtzwoizpym tbody, #dtzwoizpym tfoot, #dtzwoizpym tr, #dtzwoizpym td, #dtzwoizpym th {
  border-style: none;
}

#dtzwoizpym p {
  margin: 0;
  padding: 0;
}

#dtzwoizpym .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dtzwoizpym .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dtzwoizpym .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dtzwoizpym .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dtzwoizpym .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dtzwoizpym .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dtzwoizpym .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dtzwoizpym .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dtzwoizpym .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dtzwoizpym .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dtzwoizpym .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dtzwoizpym .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dtzwoizpym .gt_spanner_row {
  border-bottom-style: hidden;
}

#dtzwoizpym .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dtzwoizpym .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dtzwoizpym .gt_from_md > :first-child {
  margin-top: 0;
}

#dtzwoizpym .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dtzwoizpym .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dtzwoizpym .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dtzwoizpym .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dtzwoizpym .gt_row_group_first td {
  border-top-width: 2px;
}

#dtzwoizpym .gt_row_group_first th {
  border-top-width: 2px;
}

#dtzwoizpym .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtzwoizpym .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dtzwoizpym .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dtzwoizpym .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dtzwoizpym .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtzwoizpym .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dtzwoizpym .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dtzwoizpym .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dtzwoizpym .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dtzwoizpym .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dtzwoizpym .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtzwoizpym .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dtzwoizpym .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#dtzwoizpym .gt_left {
  text-align: left;
}

#dtzwoizpym .gt_center {
  text-align: center;
}

#dtzwoizpym .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dtzwoizpym .gt_font_normal {
  font-weight: normal;
}

#dtzwoizpym .gt_font_bold {
  font-weight: bold;
}

#dtzwoizpym .gt_font_italic {
  font-style: italic;
}

#dtzwoizpym .gt_super {
  font-size: 65%;
}

#dtzwoizpym .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dtzwoizpym .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dtzwoizpym .gt_indent_1 {
  text-indent: 5px;
}

#dtzwoizpym .gt_indent_2 {
  text-indent: 10px;
}

#dtzwoizpym .gt_indent_3 {
  text-indent: 15px;
}

#dtzwoizpym .gt_indent_4 {
  text-indent: 20px;
}

#dtzwoizpym .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Linear model, Sim.1b</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Beta</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Beta</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">3.7***</td>
<td headers="std.error" class="gt_row gt_center">0.202</td>
<td headers="ci" class="gt_row gt_center">3.3, 4.1</td>
<td headers="p.value" class="gt_row gt_center">1.50e-63</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-1.2***</td>
<td headers="std.error" class="gt_row gt_center">0.181</td>
<td headers="ci" class="gt_row gt_center">-1.5, -0.80</td>
<td headers="p.value" class="gt_row gt_center">3.24e-10</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.64***</td>
<td headers="std.error" class="gt_row gt_center">0.045</td>
<td headers="ci" class="gt_row gt_center">-0.73, -0.56</td>
<td headers="p.value" class="gt_row gt_center">4.72e-41</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">0.21***</td>
<td headers="std.error" class="gt_row gt_center">0.041</td>
<td headers="ci" class="gt_row gt_center">0.13, 0.29</td>
<td headers="p.value" class="gt_row gt_center">5.56e-07</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">Ex1tab2b</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="izfdcbhwrr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#izfdcbhwrr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#izfdcbhwrr thead, #izfdcbhwrr tbody, #izfdcbhwrr tfoot, #izfdcbhwrr tr, #izfdcbhwrr td, #izfdcbhwrr th {
  border-style: none;
}

#izfdcbhwrr p {
  margin: 0;
  padding: 0;
}

#izfdcbhwrr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#izfdcbhwrr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#izfdcbhwrr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#izfdcbhwrr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#izfdcbhwrr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#izfdcbhwrr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#izfdcbhwrr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#izfdcbhwrr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#izfdcbhwrr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#izfdcbhwrr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#izfdcbhwrr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#izfdcbhwrr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#izfdcbhwrr .gt_spanner_row {
  border-bottom-style: hidden;
}

#izfdcbhwrr .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#izfdcbhwrr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#izfdcbhwrr .gt_from_md > :first-child {
  margin-top: 0;
}

#izfdcbhwrr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#izfdcbhwrr .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#izfdcbhwrr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#izfdcbhwrr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#izfdcbhwrr .gt_row_group_first td {
  border-top-width: 2px;
}

#izfdcbhwrr .gt_row_group_first th {
  border-top-width: 2px;
}

#izfdcbhwrr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#izfdcbhwrr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#izfdcbhwrr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#izfdcbhwrr .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#izfdcbhwrr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#izfdcbhwrr .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#izfdcbhwrr .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#izfdcbhwrr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#izfdcbhwrr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#izfdcbhwrr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#izfdcbhwrr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#izfdcbhwrr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#izfdcbhwrr .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#izfdcbhwrr .gt_left {
  text-align: left;
}

#izfdcbhwrr .gt_center {
  text-align: center;
}

#izfdcbhwrr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#izfdcbhwrr .gt_font_normal {
  font-weight: normal;
}

#izfdcbhwrr .gt_font_bold {
  font-weight: bold;
}

#izfdcbhwrr .gt_font_italic {
  font-style: italic;
}

#izfdcbhwrr .gt_super {
  font-size: 65%;
}

#izfdcbhwrr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#izfdcbhwrr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#izfdcbhwrr .gt_indent_1 {
  text-indent: 5px;
}

#izfdcbhwrr .gt_indent_2 {
  text-indent: 10px;
}

#izfdcbhwrr .gt_indent_3 {
  text-indent: 15px;
}

#izfdcbhwrr .gt_indent_4 {
  text-indent: 20px;
}

#izfdcbhwrr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Nonlinear model, Sim.1b</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">2.0***</td>
<td headers="std.error" class="gt_row gt_center">0.147</td>
<td headers="ci" class="gt_row gt_center">1.8, 2.3</td>
<td headers="p.value" class="gt_row gt_center">5.58e-44</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">0.03</td>
<td headers="std.error" class="gt_row gt_center">0.118</td>
<td headers="ci" class="gt_row gt_center">-0.20, 0.27</td>
<td headers="p.value" class="gt_row gt_center">0.779</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.52***</td>
<td headers="std.error" class="gt_row gt_center">0.036</td>
<td headers="ci" class="gt_row gt_center">-0.59, -0.45</td>
<td headers="p.value" class="gt_row gt_center">1.00e-47</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.09**</td>
<td headers="std.error" class="gt_row gt_center">0.030</td>
<td headers="ci" class="gt_row gt_center">-0.15, -0.03</td>
<td headers="p.value" class="gt_row gt_center">0.004</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">(plot_lm1b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_lm1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (plot_glm1b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,</span>
<span id="cb11-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horizontal'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>As before, I specified a mediating relationship but did not specify an interaction in the equation used to generate the data. However, now both the linear and nonlinear models show statistically significant interaction terms. Moreover, the prediction plots also suggest the existence of an interaction in both the linear and nonlinear models in the outcome scale (i.e., the lines are not parallel).</p>
<p>Again, this has occurred despite the fact that the data were generated from a mediation model without a multiplicative interaction term in the equation, so what is happening? Well, the simulated relationships are linear and non-interactive (parallel) <strong>in the estimation scale</strong> - in this case, when predicting logged delinquency event rates. However, remember how I said that <em>all</em> model coefficients in generalized linear models with nonlinear link functions are conditional and model-based predictions are inherently scale-dependent? This is an example of what I meant. I did not add an interaction in the linear model - I only increased the strength of the relationship between a predictor and the outcome. Yet, this change affected the outcome scale and, likewise, the model coefficients generated to describe predictor-outcome relationships changed as well. Moreover, the nonlinear transformation used to plot our results on the scale of interest - in this case, exponentiating the linear equation to plot predicted delinquency event counts - causes an interaction (i.e., nonparallel lines) <strong>in the outcome scale of interest</strong>.</p>
</section>
</section>
<section id="sec-Ex1c" class="level3">
<h3 class="anchored" data-anchor-id="sec-Ex1c">Example 1c: A different slight modification to simulated data</h3>
<p>Still not convinced? Let’s go back to the first simulation (Sim.1), then add an exogenous covariate that is related to delinquency but unrelated to either parental support or moral beliefs to the data and our regression models and see what happens. This time, we will focus solely on the nonlinear model, and we will present the coefficients and plots for both this Sim.1c and the original Sim.1 to permit comparisons of the focal interaction term on the log event rate scale and on the predicted event rate scale.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data (Sim.1c)</span></span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb12-8">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">850</span> </span>
<span id="cb12-9"></span>
<span id="cb12-10">def1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ExogenousCovariate"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb12-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) </span>
<span id="cb12-12">def1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def1c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb12-13">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-14">def1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def1c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb12-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.3 + (-.5)*ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb12-16">def1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def1c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb12-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + .5*ExogenousCovariate + (-.25)*ParentSupport + .4*WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb12-18">simdat1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(n, def1c)</span>
<span id="cb12-19"></span>
<span id="cb12-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap LowMoral at 5 (0-5 item) - randomly replace oob values with values in bounds </span></span>
<span id="cb12-21">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb12-22">simdat1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb12-23">simdat1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> simdat1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs</span>
<span id="cb12-24"></span>
<span id="cb12-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap Delinquency at 7 (0-7 item) - randomly replace oob values with in bounds values</span></span>
<span id="cb12-26">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb12-27">simdat1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb12-28"></span>
<span id="cb12-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sime.1c nonlinear model</span></span>
<span id="cb12-30">glm1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ExogenousCovariate <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat1c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb12-31"></span>
<span id="cb12-32">Ex1tab2c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm1c) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-34">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.1c"</span>) </span>
<span id="cb12-35"></span>
<span id="cb12-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot interaction</span></span>
<span id="cb12-37">plot_glm1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,</span>
<span id="cb12-38">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, </span>
<span id="cb12-39">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, </span>
<span id="cb12-44">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.1c"</span>)  </span></code></pre></div>
</details>
</div>
<section id="sec-Ex1cresults" class="level4">
<h4 class="anchored" data-anchor-id="sec-Ex1cresults">Results (Sim.1c, Exogenous covariate)</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">Model coefficients</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false">Prediction Plots</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">Ex1tab2c </span>
<span id="cb13-2">Ex1tab2</span></code></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">

<div id="plmsftbwnz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#plmsftbwnz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#plmsftbwnz thead, #plmsftbwnz tbody, #plmsftbwnz tfoot, #plmsftbwnz tr, #plmsftbwnz td, #plmsftbwnz th {
  border-style: none;
}

#plmsftbwnz p {
  margin: 0;
  padding: 0;
}

#plmsftbwnz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#plmsftbwnz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#plmsftbwnz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#plmsftbwnz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#plmsftbwnz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#plmsftbwnz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plmsftbwnz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#plmsftbwnz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#plmsftbwnz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#plmsftbwnz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#plmsftbwnz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#plmsftbwnz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#plmsftbwnz .gt_spanner_row {
  border-bottom-style: hidden;
}

#plmsftbwnz .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#plmsftbwnz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#plmsftbwnz .gt_from_md > :first-child {
  margin-top: 0;
}

#plmsftbwnz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#plmsftbwnz .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#plmsftbwnz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#plmsftbwnz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#plmsftbwnz .gt_row_group_first td {
  border-top-width: 2px;
}

#plmsftbwnz .gt_row_group_first th {
  border-top-width: 2px;
}

#plmsftbwnz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#plmsftbwnz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#plmsftbwnz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#plmsftbwnz .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plmsftbwnz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#plmsftbwnz .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#plmsftbwnz .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#plmsftbwnz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#plmsftbwnz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plmsftbwnz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#plmsftbwnz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#plmsftbwnz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#plmsftbwnz .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#plmsftbwnz .gt_left {
  text-align: left;
}

#plmsftbwnz .gt_center {
  text-align: center;
}

#plmsftbwnz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#plmsftbwnz .gt_font_normal {
  font-weight: normal;
}

#plmsftbwnz .gt_font_bold {
  font-weight: bold;
}

#plmsftbwnz .gt_font_italic {
  font-style: italic;
}

#plmsftbwnz .gt_super {
  font-size: 65%;
}

#plmsftbwnz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#plmsftbwnz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#plmsftbwnz .gt_indent_1 {
  text-indent: 5px;
}

#plmsftbwnz .gt_indent_2 {
  text-indent: 10px;
}

#plmsftbwnz .gt_indent_3 {
  text-indent: 15px;
}

#plmsftbwnz .gt_indent_4 {
  text-indent: 20px;
}

#plmsftbwnz .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Nonlinear model, Sim.1c</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">1.4***</td>
<td headers="std.error" class="gt_row gt_center">0.155</td>
<td headers="ci" class="gt_row gt_center">1.0, 1.7</td>
<td headers="p.value" class="gt_row gt_center">1.84e-18</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ExogenousCovariate</td>
<td headers="estimate" class="gt_row gt_center">0.45***</td>
<td headers="std.error" class="gt_row gt_center">0.037</td>
<td headers="ci" class="gt_row gt_center">0.38, 0.52</td>
<td headers="p.value" class="gt_row gt_center">1.17e-34</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">0.07</td>
<td headers="std.error" class="gt_row gt_center">0.107</td>
<td headers="ci" class="gt_row gt_center">-0.14, 0.28</td>
<td headers="p.value" class="gt_row gt_center">0.541</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.39***</td>
<td headers="std.error" class="gt_row gt_center">0.038</td>
<td headers="ci" class="gt_row gt_center">-0.47, -0.32</td>
<td headers="p.value" class="gt_row gt_center">1.55e-25</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.08**</td>
<td headers="std.error" class="gt_row gt_center">0.027</td>
<td headers="ci" class="gt_row gt_center">-0.13, -0.03</td>
<td headers="p.value" class="gt_row gt_center">0.003</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">

<div id="gsxidlgdye" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gsxidlgdye table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gsxidlgdye thead, #gsxidlgdye tbody, #gsxidlgdye tfoot, #gsxidlgdye tr, #gsxidlgdye td, #gsxidlgdye th {
  border-style: none;
}

#gsxidlgdye p {
  margin: 0;
  padding: 0;
}

#gsxidlgdye .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gsxidlgdye .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gsxidlgdye .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gsxidlgdye .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gsxidlgdye .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gsxidlgdye .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gsxidlgdye .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gsxidlgdye .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gsxidlgdye .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gsxidlgdye .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gsxidlgdye .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gsxidlgdye .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gsxidlgdye .gt_spanner_row {
  border-bottom-style: hidden;
}

#gsxidlgdye .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gsxidlgdye .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gsxidlgdye .gt_from_md > :first-child {
  margin-top: 0;
}

#gsxidlgdye .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gsxidlgdye .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gsxidlgdye .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gsxidlgdye .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gsxidlgdye .gt_row_group_first td {
  border-top-width: 2px;
}

#gsxidlgdye .gt_row_group_first th {
  border-top-width: 2px;
}

#gsxidlgdye .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsxidlgdye .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gsxidlgdye .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gsxidlgdye .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gsxidlgdye .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsxidlgdye .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gsxidlgdye .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gsxidlgdye .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gsxidlgdye .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gsxidlgdye .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gsxidlgdye .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsxidlgdye .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gsxidlgdye .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsxidlgdye .gt_left {
  text-align: left;
}

#gsxidlgdye .gt_center {
  text-align: center;
}

#gsxidlgdye .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gsxidlgdye .gt_font_normal {
  font-weight: normal;
}

#gsxidlgdye .gt_font_bold {
  font-weight: bold;
}

#gsxidlgdye .gt_font_italic {
  font-style: italic;
}

#gsxidlgdye .gt_super {
  font-size: 65%;
}

#gsxidlgdye .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gsxidlgdye .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gsxidlgdye .gt_indent_1 {
  text-indent: 5px;
}

#gsxidlgdye .gt_indent_2 {
  text-indent: 10px;
}

#gsxidlgdye .gt_indent_3 {
  text-indent: 15px;
}

#gsxidlgdye .gt_indent_4 {
  text-indent: 20px;
}

#gsxidlgdye .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Nonlinear Poisson model, Simulation 1</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">1.3***</td>
<td headers="std.error" class="gt_row gt_center">0.178</td>
<td headers="ci" class="gt_row gt_center">0.94, 1.6</td>
<td headers="p.value" class="gt_row gt_center">2.91e-13</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-0.13</td>
<td headers="std.error" class="gt_row gt_center">0.140</td>
<td headers="ci" class="gt_row gt_center">-0.41, 0.14</td>
<td headers="p.value" class="gt_row gt_center">0.340</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.39***</td>
<td headers="std.error" class="gt_row gt_center">0.042</td>
<td headers="ci" class="gt_row gt_center">-0.47, -0.31</td>
<td headers="p.value" class="gt_row gt_center">2.52e-20</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.03</td>
<td headers="std.error" class="gt_row gt_center">0.035</td>
<td headers="ci" class="gt_row gt_center">-0.10, 0.04</td>
<td headers="p.value" class="gt_row gt_center">0.372</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">plot_glm1c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,</span>
<span id="cb14-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horizontal'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Again, the only change here from Sim.1 to Sim.1c is the addition of an exogenous covariate. Those familiar with linear regression models might expect the addition of a control variable that is unrelated to other predictors in the model will have little to no impact on the coefficients for those other variables. Yet, this is not the case in generalized linear models with nonlinear link functions, where any change that affects the outcome scale will also change the coefficients describing predictor-outcome relationships. In this case, after including the exogenous covariate, our nonlinear model now shows a significant linear focal interaction coefficient on the log event rate scale, while our plots show nonparallel lines implying a substantial interaction between moral beliefs and parental support on the predicted delinquency event rate scale.</p>
<p>Hopefully, you have seen enough to be convinced that one should never rely simply upon the direction and magnitude of an interaction term to make inferences about interactions in a nonlinear model.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/pooh-nonlin.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Don’t hate nonlinear interactions. But do treat them more like bees than honey.</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-Ex1fit" class="level3">
<h3 class="anchored" data-anchor-id="sec-Ex1fit">Example 1: Fit between model predictions &amp; simulation function</h3>
<p>Now, let’s return to the initial simulated data (Sim.1) and overlay a plot of an idealized function that closely represents the causal equation used to generate the simulated the data (dashed line) with plots of the predicted event counts from the linear and nonlinear models. This should give us a good sense of how well our model-based predictions fit or accurately describe the underlying data-generating process.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a sequence of strong moral beliefs values from 0 to 6</span></span>
<span id="cb15-4">moralblfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb15-5"></span>
<span id="cb15-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate delq values at low parental support (-2) </span></span>
<span id="cb15-7">delq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>moralblfs))</span>
<span id="cb15-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#cap delq values at max=7 &amp; round to integer to match sim</span></span>
<span id="cb15-9">delq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(delq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, delq), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb15-10">group_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-2"</span></span>
<span id="cb15-11">sim1eqlow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(moralblfs, delq, group_col)</span>
<span id="cb15-12"></span>
<span id="cb15-13"></span>
<span id="cb15-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate delq values at high parental support (2) </span></span>
<span id="cb15-15">delq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>moralblfs))</span>
<span id="cb15-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#cap delq values at max=7 &amp; round to integer to match sim</span></span>
<span id="cb15-17">delq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(delq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, delq), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb15-18">group_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span></span>
<span id="cb15-19">sim1eqhi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(moralblfs, delq, group_col)</span>
<span id="cb15-20"></span>
<span id="cb15-21">sim1eq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(sim1eqlow, sim1eqhi)</span>
<span id="cb15-22"></span>
<span id="cb15-23"></span>
<span id="cb15-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the function</span></span>
<span id="cb15-25">plot_glm1eq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim1eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb15-27">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb15-28">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq,</span>
<span id="cb15-29">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb15-30">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong moral beliefs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data-generating functions used to simulate Sim.1 data"</span>)</span>
<span id="cb15-36"></span>
<span id="cb15-37"></span>
<span id="cb15-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Overlap function with linear &amp; nonlinear models</span></span>
<span id="cb15-39"></span>
<span id="cb15-40">plot_lm1fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_lm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim1eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb15-42">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb15-43">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq,</span>
<span id="cb15-44">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb15-45">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model fit to sim function"</span>)</span>
<span id="cb15-47"></span>
<span id="cb15-48"></span>
<span id="cb15-49">plot_glm1fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_glm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim1eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb15-51">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb15-52">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq,</span>
<span id="cb15-53">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb15-54">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model fit to sim function"</span>)</span>
<span id="cb15-56"></span>
<span id="cb15-57">plot_lm1fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb15-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,</span>
<span id="cb15-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horizontal'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>At this point, it should be unsurprising that the nonlinear model provides a better fit to the underlying data-generating function. Still, sometimes visualizations simply help reaffirm what we already know. Now, let’s simulate the data again with a sample size of <em>n</em>=8,500 instead of <em>n</em>=850 and recreate these fit plots to see how sample size affects precision.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE</span></span>
<span id="cb16-2"></span>
<span id="cb16-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data</span></span>
<span id="cb16-4"></span>
<span id="cb16-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb16-6">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8500</span></span>
<span id="cb16-7"></span>
<span id="cb16-8">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb16-9">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb16-10">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb16-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.3 + (-.5)*ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb16-12">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb16-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + (-.25)*ParentSupport + .4*WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb16-14">simdat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(n, def)</span>
<span id="cb16-15"></span>
<span id="cb16-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap LowMoral at 5 (0-5 item) if necessary - randomly replace any oob values with values in bounds </span></span>
<span id="cb16-17">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb16-18">simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb16-19">simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs</span>
<span id="cb16-20"></span>
<span id="cb16-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap Delinquency at 7 (0-7 item) if necessary - randomly replace any oob values with in bounds values</span></span>
<span id="cb16-22">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb16-23">simdat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb16-24"></span>
<span id="cb16-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.1 linear model</span></span>
<span id="cb16-26">lm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat)</span>
<span id="cb16-27"></span>
<span id="cb16-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.1 nonlinear model</span></span>
<span id="cb16-29">glm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb16-30"></span>
<span id="cb16-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot interaction</span></span>
<span id="cb16-32"></span>
<span id="cb16-33">plot_lm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(lm1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  </span>
<span id="cb16-34">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.1"</span>)  </span>
<span id="cb16-37"></span>
<span id="cb16-38">plot_glm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  </span>
<span id="cb16-39">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.1"</span>)  </span>
<span id="cb16-42"></span>
<span id="cb16-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Overlap function with linear &amp; nonlinear models</span></span>
<span id="cb16-44"></span>
<span id="cb16-45">plot_lm1fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_lm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim1eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb16-47">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb16-48">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq,</span>
<span id="cb16-49">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb16-50">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n=8,500"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()) </span>
<span id="cb16-52"></span>
<span id="cb16-53">plot_glm1fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_glm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim1eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb16-55">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb16-56">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq,</span>
<span id="cb16-57">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb16-58">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n=8,500"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()) </span>
<span id="cb16-60"></span>
<span id="cb16-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># modify titles + axes</span></span>
<span id="cb16-62"></span>
<span id="cb16-63">plot_lm1fitb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_lm1fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n=850"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model"</span>)  </span>
<span id="cb16-65"></span>
<span id="cb16-66">plot_glm1fitb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_glm1fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n=850"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model"</span>) </span>
<span id="cb16-68"></span>
<span id="cb16-69"></span>
<span id="cb16-70">(plot_lm1fitb <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1fitb) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>  (plot_lm1fit2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1fit2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb16-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,</span>
<span id="cb16-72">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horizontal'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Again, the nonlinear model is a better fit to the idealized function than the linear model. Additionally, the one exception where the nonlinear model predictions diverge from the idealized data-generating function is not unexpected. First, there is increased sampling variability in the prediction space where data are especially sparse (i.e., low parental support &amp; extremely weak moral beliefs, or top left section of each plot). Second, I resampled out-of-bounds Poisson-generated observations in this sparse sampling space (e.g., strong moral beliefs &lt; 0; delinquency &gt; 7) to better match truncated ordinal measures found in real-world data, and the simple idealized function (i.e., the dashed line) does not perfectly capture this more complex mixture process used to generate the simulated data.</p>
</section>
<section id="sec-plotscale" class="level3">
<h3 class="anchored" data-anchor-id="sec-plotscale">Pair introverted coefficients with extroverted plots on the outcome scale</h3>
<p>I hope it is clear by now that using a generalized linear model with a nonlinear link function to describe a set of relationships between variables complicates things, as these models are fundamentally interactive. Moreover, the nature of the interactions in these models varies across scales of estimation or interest (e.g., log odds/event rate; predicted probability/event count; odds/event rate ratio) in ways that often are too difficult to grasp from model coefficients alone.</p>
<p>This does not mean that we should avoid such models and substitute linear models instead “for the sake of interpretation” - I see this one regularly when reviewing manuscripts - since, as illustrated above, a nonlinear model may be a much better fit to the underlying data generating process than a classic linear model. It also does not mean that the coefficients are somehow <em>wrong</em> or fundamentally uninterpretable.</p>
<p>Rather, you might think of your regression coefficients as panelists at a conference that is organized to describe hidden signals in your data. With a properly applied model, coefficients from these “nonlinear” models are the eccentric and introverted panelist using an overhead projector to show complex equations without any graphs. They are efficiently delivering astute and precise descriptions in a concise way - well below the presentation time allotted - but their combination of complexity, concision, and aloofness tend to lose their audience, who routinely misinterpret their results.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/DALL-E-overhead2-sm.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Don’t be that guy. Plot those introverted interaction coefficients.</figcaption>
</figure>
</div>
<p>So, instead of ditching these coefficients, we should instead aim to be extremely cautious with modeling and interpreting findings and, likewise, we should educate ourselves about and commit to adopting good practices when using such models. For instance, we can pair our introverted nonlinear coefficients with plots in the outcome scale of interest for meaningful interpretations. Such visualizations are the flashy, tech savvy, extroverted panelist that has learned there is substantial social value in translating Professor Introvert’s equations into visualizations that maintain their descriptive accuracy while delivering them in an aesthetically pleasing package that is intellectually accessible to the audience.</p>
<p>Now, we should be ready to move on to Example 2, where I will introduce an exposure-mediator interaction to the simulated data. Recall, in Parts 2 and 3 of this blog series, I will use similar simulated data from Example 2 to learn about decomposing indirect and interaction effects with a potential outcomes approach. In the conference organized to describe hidden signals in your data, potential outcomes estimates are the venerable keynote speakers that inspire us to do more while also secretly stoking our insecurities by making us question things that we thought were well understood. For now, I will simply illustrate how the regression coefficients and outcome scale plots change with the addition of a small exposure-mediator interaction.</p>
</section>
</section>
<section id="sec-Ex2" class="level2">
<h2 class="anchored" data-anchor-id="sec-Ex2">Example 2: Multiplicative interaction on linear estimation scale</h2>
<p>In simulating data for Example 2 (Simulation 2), I modified the first simulated dataset (Sim.1) by adding a small multiplicative interaction term to the linear equation predicting delinquency (<em>b</em> = -0.12 x ParentSupport x WeakMoralBlfs). Then, after making this small change and simulating the data, I once again tabled results from linear and nonlinear Poisson regression models, plotted the predicted delinquency event rates for both models, and overlayed the idealized data generating function (dashed lines) to help visualize model fit.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb17-2"></span>
<span id="cb17-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb17-4"></span>
<span id="cb17-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate data (Sim.2)</span></span>
<span id="cb17-6"></span>
<span id="cb17-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb17-8">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">850</span></span>
<span id="cb17-9"></span>
<span id="cb17-10">def2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>, </span>
<span id="cb17-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb17-12">def2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb17-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.3 + (-.5)*ParentSupport"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb17-14">def2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb17-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + (-.25)*ParentSupport + .4*WeakMoralBlfs + </span></span>
<span id="cb17-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    (-.12)*ParentSupport*WeakMoralBlfs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb17-17">simdat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(n, def2)</span>
<span id="cb17-18"></span>
<span id="cb17-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;% sjPlot::view_df()</span></span>
<span id="cb17-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;% </span></span>
<span id="cb17-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(aes(x=WeakMoralBlfs, y=Delinquency)) +</span></span>
<span id="cb17-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_point()</span></span>
<span id="cb17-23"></span>
<span id="cb17-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap LowMoral at 5 (0-5 item) - randomly replace oob values with values in bounds </span></span>
<span id="cb17-25">inds2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb17-26">simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs[inds2] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-27">simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>StrgMoralBlfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>WeakMoralBlfs</span>
<span id="cb17-28"></span>
<span id="cb17-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap Delinquency at 7 (0-7 item) - randomly replace oob values with in bounds values</span></span>
<span id="cb17-30">inds2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb17-31">simdat2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency[inds2] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-32"></span>
<span id="cb17-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;% sjPlot::view_df()</span></span>
<span id="cb17-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simdat2 %&gt;%</span></span>
<span id="cb17-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(aes(x=WeakMoralBlfs, y=Delinquency)) +</span></span>
<span id="cb17-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_point()</span></span>
<span id="cb17-37"></span>
<span id="cb17-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.2 linear model</span></span>
<span id="cb17-39">lm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat2)</span>
<span id="cb17-40"></span>
<span id="cb17-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sim.2 nonlinear model</span></span>
<span id="cb17-42">glm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ParentSupport <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> StrgMoralBlfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdat2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb17-43"></span>
<span id="cb17-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Regression output</span></span>
<span id="cb17-45"></span>
<span id="cb17-46">Ex2tab1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(lm2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-48">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.2"</span>) </span>
<span id="cb17-49"></span>
<span id="cb17-50">Ex2tab2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-52">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.2"</span>) </span>
<span id="cb17-53"></span>
<span id="cb17-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Plot interactions </span></span>
<span id="cb17-55"></span>
<span id="cb17-56">plot_lm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(lm2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  </span>
<span id="cb17-57">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.2"</span>)</span>
<span id="cb17-60"></span>
<span id="cb17-61">plot_glm2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  </span>
<span id="cb17-62">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.2"</span>)</span>
<span id="cb17-65"></span>
<span id="cb17-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data generating functions</span></span>
<span id="cb17-67"></span>
<span id="cb17-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a sequence of strong moral beliefs values from 0 to 6</span></span>
<span id="cb17-69">moralblfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb17-70"></span>
<span id="cb17-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate delq values at low parental support (-2) </span></span>
<span id="cb17-72">delq2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>moralblfs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>moralblfs))</span>
<span id="cb17-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#cap delq values at max=7 &amp; round to integer to match sim</span></span>
<span id="cb17-74">delq2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(delq2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, delq2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb17-75">group_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-2"</span></span>
<span id="cb17-76">sim2eqlow <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(moralblfs, delq2, group_col)</span>
<span id="cb17-77"></span>
<span id="cb17-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate delq values at high parental support (2) </span></span>
<span id="cb17-79">delq2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>moralblfs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>moralblfs))</span>
<span id="cb17-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#cap delq values at max=7 &amp; round to integer to match sim</span></span>
<span id="cb17-81">delq2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(delq2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, delq2), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb17-82">group_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span></span>
<span id="cb17-83">sim2eqhi <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(moralblfs, delq2, group_col)</span>
<span id="cb17-84"></span>
<span id="cb17-85">sim2eq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(sim2eqlow, sim2eqhi)</span>
<span id="cb17-86"></span>
<span id="cb17-87"></span>
<span id="cb17-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the function</span></span>
<span id="cb17-89">plot_glm2eq <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim2eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb17-91">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb17-92">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq2,</span>
<span id="cb17-93">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb17-94">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-97">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong moral beliefs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data-generating functions used to simulate Sim.2 data"</span>)</span>
<span id="cb17-100"></span>
<span id="cb17-101"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Overlap function with linear &amp; nonlinear models</span></span>
<span id="cb17-102"></span>
<span id="cb17-103">plot_lm2fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_lm2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim2eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb17-105">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb17-106">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq2,</span>
<span id="cb17-107">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb17-108">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.2"</span>)</span>
<span id="cb17-110"></span>
<span id="cb17-111"></span>
<span id="cb17-112">plot_glm2fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_glm2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>sim2eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb17-114">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method.args =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>), </span>
<span id="cb17-115">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>moralblfs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>delq2,</span>
<span id="cb17-116">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group=</span>group_col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span>group_col), </span>
<span id="cb17-117">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.2"</span>)</span></code></pre></div>
</details>
</div>
<section id="sec-Ex2results" class="level4">
<h4 class="anchored" data-anchor-id="sec-Ex2results">Results (Simulation 2)</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" aria-controls="tabset-4-1" aria-selected="true">Linear model</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" aria-controls="tabset-4-2" aria-selected="false">Nonlinear Poisson model</a></li><li class="nav-item"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" aria-controls="tabset-4-3" aria-selected="false">Prediction Plots</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">Ex2tab1</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="cdtzwoizpy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cdtzwoizpy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cdtzwoizpy thead, #cdtzwoizpy tbody, #cdtzwoizpy tfoot, #cdtzwoizpy tr, #cdtzwoizpy td, #cdtzwoizpy th {
  border-style: none;
}

#cdtzwoizpy p {
  margin: 0;
  padding: 0;
}

#cdtzwoizpy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cdtzwoizpy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cdtzwoizpy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cdtzwoizpy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cdtzwoizpy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cdtzwoizpy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cdtzwoizpy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cdtzwoizpy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cdtzwoizpy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cdtzwoizpy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cdtzwoizpy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cdtzwoizpy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cdtzwoizpy .gt_spanner_row {
  border-bottom-style: hidden;
}

#cdtzwoizpy .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cdtzwoizpy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cdtzwoizpy .gt_from_md > :first-child {
  margin-top: 0;
}

#cdtzwoizpy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cdtzwoizpy .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cdtzwoizpy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cdtzwoizpy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cdtzwoizpy .gt_row_group_first td {
  border-top-width: 2px;
}

#cdtzwoizpy .gt_row_group_first th {
  border-top-width: 2px;
}

#cdtzwoizpy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cdtzwoizpy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cdtzwoizpy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cdtzwoizpy .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cdtzwoizpy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cdtzwoizpy .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cdtzwoizpy .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cdtzwoizpy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cdtzwoizpy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cdtzwoizpy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cdtzwoizpy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cdtzwoizpy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cdtzwoizpy .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cdtzwoizpy .gt_left {
  text-align: left;
}

#cdtzwoizpy .gt_center {
  text-align: center;
}

#cdtzwoizpy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cdtzwoizpy .gt_font_normal {
  font-weight: normal;
}

#cdtzwoizpy .gt_font_bold {
  font-weight: bold;
}

#cdtzwoizpy .gt_font_italic {
  font-style: italic;
}

#cdtzwoizpy .gt_super {
  font-size: 65%;
}

#cdtzwoizpy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cdtzwoizpy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cdtzwoizpy .gt_indent_1 {
  text-indent: 5px;
}

#cdtzwoizpy .gt_indent_2 {
  text-indent: 10px;
}

#cdtzwoizpy .gt_indent_3 {
  text-indent: 15px;
}

#cdtzwoizpy .gt_indent_4 {
  text-indent: 20px;
}

#cdtzwoizpy .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Linear model, Sim.2</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Beta</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Beta</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">2.5***</td>
<td headers="std.error" class="gt_row gt_center">0.185</td>
<td headers="ci" class="gt_row gt_center">2.1, 2.8</td>
<td headers="p.value" class="gt_row gt_center">2.14e-37</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-1.6***</td>
<td headers="std.error" class="gt_row gt_center">0.166</td>
<td headers="ci" class="gt_row gt_center">-1.9, -1.3</td>
<td headers="p.value" class="gt_row gt_center">8.69e-21</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.40***</td>
<td headers="std.error" class="gt_row gt_center">0.042</td>
<td headers="ci" class="gt_row gt_center">-0.48, -0.32</td>
<td headers="p.value" class="gt_row gt_center">1.19e-20</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">0.30***</td>
<td headers="std.error" class="gt_row gt_center">0.037</td>
<td headers="ci" class="gt_row gt_center">0.23, 0.37</td>
<td headers="p.value" class="gt_row gt_center">3.09e-15</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">Ex2tab2</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="mbizfdcbhw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mbizfdcbhw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mbizfdcbhw thead, #mbizfdcbhw tbody, #mbizfdcbhw tfoot, #mbizfdcbhw tr, #mbizfdcbhw td, #mbizfdcbhw th {
  border-style: none;
}

#mbizfdcbhw p {
  margin: 0;
  padding: 0;
}

#mbizfdcbhw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mbizfdcbhw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mbizfdcbhw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mbizfdcbhw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mbizfdcbhw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mbizfdcbhw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbizfdcbhw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mbizfdcbhw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mbizfdcbhw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mbizfdcbhw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mbizfdcbhw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mbizfdcbhw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mbizfdcbhw .gt_spanner_row {
  border-bottom-style: hidden;
}

#mbizfdcbhw .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mbizfdcbhw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mbizfdcbhw .gt_from_md > :first-child {
  margin-top: 0;
}

#mbizfdcbhw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mbizfdcbhw .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mbizfdcbhw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mbizfdcbhw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mbizfdcbhw .gt_row_group_first td {
  border-top-width: 2px;
}

#mbizfdcbhw .gt_row_group_first th {
  border-top-width: 2px;
}

#mbizfdcbhw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbizfdcbhw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mbizfdcbhw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mbizfdcbhw .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbizfdcbhw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbizfdcbhw .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mbizfdcbhw .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mbizfdcbhw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mbizfdcbhw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbizfdcbhw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mbizfdcbhw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbizfdcbhw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mbizfdcbhw .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbizfdcbhw .gt_left {
  text-align: left;
}

#mbizfdcbhw .gt_center {
  text-align: center;
}

#mbizfdcbhw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mbizfdcbhw .gt_font_normal {
  font-weight: normal;
}

#mbizfdcbhw .gt_font_bold {
  font-weight: bold;
}

#mbizfdcbhw .gt_font_italic {
  font-style: italic;
}

#mbizfdcbhw .gt_super {
  font-size: 65%;
}

#mbizfdcbhw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mbizfdcbhw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mbizfdcbhw .gt_indent_1 {
  text-indent: 5px;
}

#mbizfdcbhw .gt_indent_2 {
  text-indent: 10px;
}

#mbizfdcbhw .gt_indent_3 {
  text-indent: 15px;
}

#mbizfdcbhw .gt_indent_4 {
  text-indent: 20px;
}

#mbizfdcbhw .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Nonlinear model, Sim.2</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">1.3***</td>
<td headers="std.error" class="gt_row gt_center">0.171</td>
<td headers="ci" class="gt_row gt_center">0.99, 1.7</td>
<td headers="p.value" class="gt_row gt_center">8.34e-15</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport</td>
<td headers="estimate" class="gt_row gt_center">-0.37**</td>
<td headers="std.error" class="gt_row gt_center">0.126</td>
<td headers="ci" class="gt_row gt_center">-0.61, -0.12</td>
<td headers="p.value" class="gt_row gt_center">0.003</td></tr>
    <tr><td headers="label" class="gt_row gt_left">StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">-0.39***</td>
<td headers="std.error" class="gt_row gt_center">0.041</td>
<td headers="ci" class="gt_row gt_center">-0.47, -0.31</td>
<td headers="p.value" class="gt_row gt_center">1.93e-21</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ParentSupport * StrgMoralBlfs</td>
<td headers="estimate" class="gt_row gt_center">0.00</td>
<td headers="std.error" class="gt_row gt_center">0.031</td>
<td headers="ci" class="gt_row gt_center">-0.06, 0.06</td>
<td headers="p.value" class="gt_row gt_center">0.980</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb20-2"></span>
<span id="cb20-3">plot_lm2fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm2fit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,</span>
<span id="cb20-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horizontal'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>As before, there is a statistically significant interaction coefficient in the linear regression model. In comparison, the interaction coefficient is essentially zero (<em>b</em> = 0.00) in the nonlinear model. Some might mistakenly consider this a win for the linear model, as we specified an interaction on the linear estimation scale when simulating the data. Yet, by now, you know better than to rely on the sign and magnitude of that coefficient to make inferences about interactions in nonlinear models.</p>
<p>In the linear model, the significant interaction term implies that freeing the regression parameter estimates to permit non-parallel slopes improves the model’s linear predictive fit to the nonlinear data. The linear regression model does its best to reflect the conditional mean structure of the nonlinear relationship, but there is no mechanism to ensure the linear predictions are a <em>good</em> fit to the data. In Example 2, a quick visual comparison of the solid prediction lines to the dashed lines reveals that the linear model’s fit to the idealized data-generating function is quite poor. In fact, this model would lead to understating the effect of moral beliefs at low levels of parental support (solid black prediction line). Even worse, the linear model’s results might lead to the problematic inference that moral beliefs has a <em>positive</em> effect on delinquency at high levels of parental support (solid orange prediction line) - rather than the correct and opposite inference of a negligible to weak negative effect.</p>
<p>In contrast, the fit of the nonlinear model is quite good yet again, as expected. Additionally, the non-parallel prediction lines imply the existence of a small interaction between parental support and moral beliefs on the predicted delinquency event rate scale.</p>
<p>The plots below are intended to help you visualize how the inclusion of this small interaction term on the linear estimation scale when simulating the data affected predicted delinquency event rates on the outcome’s natural interpretation scale. In those plots, I removed the idealized function (dashed line) and instead added predicted delinquency event rates from models in Example 1 instead. Recall, the only difference between the simulated datasets in Examples 1 and 2 is the omission (in Sim.1) or inclusion (in Sim.2) of a small interaction term (<em>b</em> = -0.12). So, differences between the predicted delinquency event rates across Sim.2 (solid lines) and Sim.1 (dotted lines) are due to the interaction.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#|message=FALSE </span></span>
<span id="cb21-2"></span>
<span id="cb21-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get model data</span></span>
<span id="cb21-4">plot_lm1_dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_model_data</span>(lm1,</span>
<span id="cb21-5">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,</span>
<span id="cb21-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>),</span>
<span id="cb21-7">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci.lvl =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)</span>
<span id="cb21-8"></span>
<span id="cb21-9">plot_glm1_dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_model_data</span>(glm1,</span>
<span id="cb21-10">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,</span>
<span id="cb21-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StrgMoralBlfs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ParentSupport [-2,2]"</span>),</span>
<span id="cb21-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci.lvl =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)</span>
<span id="cb21-13"></span>
<span id="cb21-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reverse-engineer ggplot call into code for reference</span></span>
<span id="cb21-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://coolbutuseless.github.io/2019/04/26/introducing-the-ggreverse-package-for-turning-ggplots-back-in-to-code/</span></span>
<span id="cb21-16"></span>
<span id="cb21-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot_lm2_code &lt;- ggreverse::convert_to_code(plot_lm2)</span></span>
<span id="cb21-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot_lm2_code</span></span>
<span id="cb21-19"></span>
<span id="cb21-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overlay plot_lm1 (with intervals) on plot_lm2  </span></span>
<span id="cb21-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot_lm2 + </span></span>
<span id="cb21-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggdist::geom_lineribbon(data=plot_lm1_dat, </span></span>
<span id="cb21-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#               mapping = aes(y = predicted,</span></span>
<span id="cb21-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                             x = x, </span></span>
<span id="cb21-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                             ymin = conf.low, </span></span>
<span id="cb21-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                             ymax = conf.high, </span></span>
<span id="cb21-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                             group = group, </span></span>
<span id="cb21-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                             color = group),</span></span>
<span id="cb21-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#               alpha = 0.85, </span></span>
<span id="cb21-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#               position = position_identity(), </span></span>
<span id="cb21-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#               stat = "identity") + </span></span>
<span id="cb21-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     scale_colour_colorblind(labels = c("Low", "High")) </span></span>
<span id="cb21-33"></span>
<span id="cb21-34"></span>
<span id="cb21-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overlay plot_lm1 (simple line, no intervals) on plot_lm2  </span></span>
<span id="cb21-36">plot_lm2xlm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_lm2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>plot_lm1_dat,</span>
<span id="cb21-38">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> predicted, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group),</span>
<span id="cb21-39">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dotted"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb21-40">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_identity</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb21-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear model, Sim.2 vs. Sim.1"</span>)</span>
<span id="cb21-44"></span>
<span id="cb21-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overlay plot_glm1 (simple line, no intervals) on plot_glm2  </span></span>
<span id="cb21-46">plot_glm2xglm1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_glm2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>plot_glm1_dat,</span>
<span id="cb21-48">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> predicted, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group),</span>
<span id="cb21-49">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dotted"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb21-50">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_identity</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb21-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nonlinear model, Sim.2 vs. Sim.1"</span>)</span>
<span id="cb21-54"></span>
<span id="cb21-55"></span>
<span id="cb21-56">plot_lm2xlm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm2xglm1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb21-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bottom'</span>,</span>
<span id="cb21-58">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'horizontal'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>See how the addition of a small interaction on the linear estimation scale changed the slopes of the predicted delinquency event rates? Note, too, that this occurs even in the nonlinear model, despite the fact that the interaction coefficient was essentially zero magnitude (<em>b</em> = 0.00)!</p>
<p>In addition to examining changes in predicted delinquency event rates, we could discuss this interaction in terms of introducing “excess risks” of delinquency. But, how might we interpret the interaction and precisely estimate those excess risks in light of the co-occurring mediation process that we also know exists in these data? This will be the focus of <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a> and <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a> of this series.</p>
</section>
</section>
<section id="sec-intermission" class="level2">
<h2 class="anchored" data-anchor-id="sec-intermission">Intermission</h2>
<p>Ok, that’s enough of the from me on this topic. There are a lot of great resources out there but, to wrap up this first example, I will echo some great advice from <a href="https://sociologicalscience.com/articles-v6-4-81/">Trenton Mize’s (2019, p.112-3) insightful primer on the topic</a>:</p>
<blockquote class="blockquote">
<p>“Estimating, interpreting, and presenting nonlinear interaction effects requires more effort and consideration than doing the same for linear interaction effects. However, the current methodological literature and statistical software provide the guidance and ability to fully investigate these types of effects. In an effort to summarize the key things to consider:</p>
</blockquote>
<blockquote class="blockquote">
<ol type="1">
<li>Include a product (interaction) term in the model if you want to investigate whether the effect of one independent variable is contingent on the level of a second independent variable.</li>
<li>Ignore the coefficient of the product term: It does not necessarily provide accurate information about the significance, magnitude, or even the direction of the underlying interaction effect on the predictions.</li>
<li>Plot the predictions to determine the nature of the underlying interaction effect on the metric of interest.</li>
<li>Determine the size and significance of the effects of interest using marginal effects, not regression coefficients.</li>
<li>Use tests of second differences (whether two marginal effects are equal) to determine whether an interaction effect is significant for specific values of interest of your independent variables</li>
<li>Absent substantive or theoretically interesting values of the focal independent or control variables to test the interaction effect, use average marginal effects to summarize whether there is an interaction effect present on average in the data.”</li>
</ol>
</blockquote>
<p>In this post, I have tried to build or strengthen your intuition about the importance of the first four points. The last two points (#5 &amp; #6) about testing interactions with marginal effects are also extremely important, but I will need to wait to tackle these in greater detail in a different post. Or, better yet, read Andrew Heiss’ excellent <a href="https://www.andrewheiss.com/blog/2022/05/20/marginalia/">“Marginalia” blog post on the topic</a>, followed by his post on <a href="https://www.andrewheiss.com/blog/2022/11/29/conditional-marginal-marginaleffects/">marginal effects in generalized linear mixed models</a>.</p>
<p>As the curtains close on Part 1 and the stage is being reset, go stretch your limbs and grab refreshments, then return to check out <a href="https://reluctantcriminologists.com/blog-posts/%5B7%5D/modmadness-pt2.html">Part 2</a> and <a href="https://reluctantcriminologists.com/blog-posts/%5B11%5D/modmadness-pt3.html">Part 3</a> of this series. In that post, you will learn why our moderator madness work is not yet done: There is an interaction between the focal cause or exposure (parental support) and the mediator (moral beliefs) in the Example 2 data (Sim.2), which means mediation and moderation are statistically entangled! Return to your seats for the second act to learn how to conduct a 4-way decomposition of a total effect in the presence of an exposure-mediator interaction using a potential outcomes approach.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[6]/still-waiting.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Parts 2 and 3 have finally arrived! Hope you did not hold your breath as you waited.</figcaption>
</figure>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Initially, I anticipated writing a two-part series. However, the second post ended up being too long for a single entry, so I split it into Parts 2 and 3. Upon realizing this, I revisited Part 1 to make several minor edits to reference Parts 2 and/or 3 (instead of a singular Part 2) throughout.↩︎</p></li>
<li id="fn2"><p>This is because effect heterogeneity (interactions) are assumed in DAGs, so the statistical flow of relational information remains the same and only the mathematical functional form of the relationships change across the two proposed processes. Relatedly, we cannot know from the data alone whether that dashed red line should be drawn as it is or, instead, whether the dashed red line should originate at moral beliefs and intersect the causal path between parental support and delinquency.↩︎</p></li>
<li id="fn3"><p>This hot topic riled up criminologists’ feathers about a decade ago (cf.&nbsp;<a href="https://asc41.org/wp-content/uploads/ASC-Criminologist-2012-09.pdf">p.23 here</a>, <a href="https://asc41.org/wp-content/uploads/ASC-Criminologist-2013-03.pdf">p.21 here</a>, and <a href="https://editorscornerseptoct2012.activeboard.com/t50802393/thoughts-on-piecemeal-publication/">additional discussion here</a>). Yet, this <a href="https://www.science.org/doi/10.1126/science.7008199">old problematic practice</a> continues to be disturbingly commonplace in our field, as well as <a href="https://www.apa.org/pubs/authors/openletter.pdf">in neighboring disciplines</a> <a href="https://link.springer.com/article/10.1007/s10459-014-9494-8">and beyond</a>. To be crystal clear, I am NOT encouraging it here.↩︎</p></li>
<li id="fn4"><p>Perverse structural incentives, which are deeply embedded in <a href="https://www.liebertpub.com/doi/10.1089/ees.2016.0223">modern academic publishing</a>, motivate all sorts of career-oriented pragmatic forays through the <a href="http://www.stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf">garden of forking paths</a> on the way to piecemeal publication. You know, the ones that compel scholars to increase CV lines and citation counts by carving up their measures, switching outcomes, adding new subgroups, swapping analytic methods, variably positing <a href="https://journals.sagepub.com/doi/full/10.1177/25152459221095827">different “process” models</a> (e.g., main effects; indirect effects; interaction effects; and other combinations of mediation and moderation), and even to commit fraud in pursuit of career advancement.↩︎</p></li>
<li id="fn5"><p>The three focal variables, sample size, and blog post itself are loosely inspired by research using the <a href="https://www.tandfonline.com/doi/abs/10.1080/1478601X.2023.2182778">Pocono Bullying Study data</a>.↩︎</p></li>
<li id="fn6"><p>This raises an even bigger issue - that modeling mediation and moderation to test or make inferences about causal processes <a href="https://journals.sagepub.com/doi/full/10.1177/25152459221095827">requires very strong assumptions, some of which often are irrevocably violated when applied to observational and cross-sectional data</a>. At risk of stating the obvious, I am not implying that one could conduct a convincing study akin to “paper 1” or “paper 2” using real-world data akin to the simulated data in these examples. Rather, to conduct convincing studies on these imaginary topics, a researcher would need to do much more than properly model, plot, interpret, and even decompose their interactions; they would also need to spend serious time, energy, and resources on improving the precision of the research questions, constructing defensible causal diagrams to guide carefully planned research, and identifying potential threats to causal inferences (e.g., confounders; colliders; sampling, response, measurement, and analytic limitations; alternative interpretations).↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer2023,
  author = {Brauer, Jon},
  title = {Moderator {Madness,} {Part} 1},
  date = {2023-07-18},
  url = {https://reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer2023" class="csl-entry quarto-appendix-citeas">
Brauer, Jon. 2023. <span>“Moderator Madness, Part 1.”</span> July 18,
2023. <a href="https://reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1.html">https://reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <category>rstats</category>
  <category>moderation</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[6]/modmadness-pt1.html</guid>
  <pubDate>Tue, 18 Jul 2023 04:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[6]/interact-cartoon2.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Are you afraid of colliders?</title>
  <dc:creator>Jon Brauer and Jake Day</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[5]/colliders.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/rancor.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Collider: The rancor in your regression</figcaption>
</figure>
</div>
<section id="sec-afraid" class="level2">
<h2 class="anchored" data-anchor-id="sec-afraid">Are you afraid of colliders? You will be… <em>You will be</em>.</h2>
<p>In our previous post on <a href="https://reluctantcriminologists.com/blog-posts/%5B4%5D/causation-no-corr">causation without correlation</a>, we concluded with a brief caution about how an otherwise fun fishing trip for indirect effects might be spoiled by the collider monster in your modeling closet. We referenced Julia Rohrer’s blog entry on <a href="https://www.the100.ci/2019/10/03/indirect-effect-ex-machina/">hunting for indirect effects</a>, then noted the following:</p>
<blockquote class="blockquote">
<p>Her example beautifully, or frighteningly, illustrates how a collider can produce an erroneous inference about an indirect effect. You might be wondering to yourself: <em>what the heck is a collider</em>? Great question. To us, it is the scary monster in our statistical modeling closet that keeps us up at night; neither of us have ever really seen the monster, but we’ve read enough stories about it to be convinced that it is there. We’ll try tackling that one another time…</p>
</blockquote>
<p>If you’d prefer a crime-relevant analogy, colliders also have been referred to as the <a href="https://twitter.com/MaartenvSmeden/status/1504422704484696072?s=20">mass murderer of interpretable statistical analyses</a>. Rohrer has <a href="https://www.the100.ci/2017/03/14/that-one-weird-third-variable-problem-nobody-ever-mentions-conditioning-on-a-collider/">another excellent post</a> introducing these modeling monsters. However, the first time we can remember encountering a systematic discussion of colliders and the problems they pose for our statistical models was in our initial reading of Richard McElreath’s <a href="https://xcelab.net/rm/statistical-rethinking/"><em>Statistical Rethinking</em></a> book. In keeping with the theme here, McElreath discusses colliders in chapter six of the current edition, which he titled <em>The Haunted DAG and the Causal Terror</em>.</p>
<p>We think such fear-inspired collider analogies are apt as, once you understand them, it is hard not to fear, loathe, and respect them. In fact, after our initial reading of McElreath’s book (and watching his <a href="https://youtu.be/uanZZLlzKHw">lectures</a>), we came away pretty terrified that all our prior analyses were potentially misspecified. Yet, after that first encounter, we had not gotten a full glimpse of the villain - we lacked a full understanding and appreciation of how much they may be affecting the criminological literature (and our own previous work). Now that we have seen them, we think a collider is like a rancor - <a href="https://www.starwars.com/databank/rancor">the terrifying and destructive monster from the <em>Star Wars</em> universe</a> - that has been set loose to wreak havoc on your regression model.</p>
<section id="sec-who" class="level3">
<h3 class="anchored" data-anchor-id="sec-who">Who should care about colliders?</h3>
<p>Before going any deeper, we should note that colliders and collider bias are relevant to anyone using any type of regression model to estimate the causal effect of a variable on an outcome - or to determine whether one variable has an “influence” on another variable - irrespective of the functional form (e.g., linear; logistic; negative binomial), complexity, estimation method (e.g., OLS; ML; Bayes), or statistical program you use. Also, if you ever add covariates to your regression models to “adjust” for coefficient bias or “control” for alternative explanations - that is, if you use “control variables” in your regression models - then you really need to know about colliders and collider bias.</p>
<p>Also, if you are relatively new to the topic of colliders, then we wrote this blog for you. That does not mean we think you will <em>understand</em> colliders by the end of our post. We have been reading and thinking about colliders for years now, and we still find ourselves trying to get a firm grip on them. Our hope is to introduce you to colliders and to help you develop a healthy fear of them. We also hope to convince you of the importance of reading more about colliders and related topics like DAGs, adjustment sets, and the backdoor criterion; we link to many excellent and free resources on these topics throughout this post. So, by the end of our post, if you feel fearful and confused, then rest assured you are not alone! You are taking the first of many steps on a challenging but worthwhile journey with us. Now, grab some popcorn and turn on the lights for our version of a sci-fi stats thriller mashup.</p>
</section>
<section id="sec-dagsaber" class="level3">
<h3 class="anchored" data-anchor-id="sec-dagsaber">Selection effects, causal force, and DAG-sabers</h3>
<p>Perhaps without knowing it, you’ve likely encountered discussions of collider bias before in the <a href="https://thehardestscience.com/2014/08/04/the-selection-distortion-effect-how-selection-changes-correlations-in-surprising-ways/">form of selection bias</a>. It’s probably safe to say that most social scientists get exposed to the problems with <a href="https://psycnet.apa.org/record/2004-11156-005">selection effects</a> at some point in their graduate training. Indeed, it’s been at the center of high profile debates <a href="https://link.springer.com/article/10.1007/s10940-007-9024-4">within criminology</a> (e.g., <a href="https://www.annualreviews.org/doi/abs/10.1146/annurev-criminol-011518-024551">peer influence</a>; <a href="https://www.annualreviews.org/doi/abs/10.1146/annurev-criminol-032317-091949">turning points</a>; <a href="https://www.jstor.org/stable/23365655">sentencing</a>; <a href="https://journals.sagepub.com/doi/abs/10.1177/0093854811424690?journalCode=cjbb">specialty courts</a>; and <a href="https://fivethirtyeight.com/features/why-statistics-dont-capture-the-full-extent-of-the-systemic-bias-in-policing/">police use of force</a>). On some level, we often treat selection effects as a known limitation and perhaps even a minor nuisance. However, once you comprehend that selection effects often are caused by <a href="https://pubmed.ncbi.nlm.nih.gov/35700187/">restricting on levels of a collider or a causal descendant of a collider</a> (and other times by selecting on an effect moderator) then, like us, you too might begin to develop a healthy fear of colliders. You might also find yourself on a quest to master the transparent use of structural causal models or <a href="https://rpubs.com/NickCHK/DAGWorkshop2020">directed acyclic graphs</a> (DAGs).</p>
<p>Causal assumptions are the force from which our modeling power flows and that binds our scientific claims together. The transparent causal model or DAG is a powerful ally in the force that can shed light on hidden causal assumptions. They help us make essential design, modeling, and interpretive decisions with reason rather than intuition or emotion. If we (okay, this part is all Jon - IYKYK) have not yet stretched this extended <em>Star Wars</em> metaphor past its breaking point already, then let’s do it now. Fear (of colliders) is the path to the dark side. <a href="https://starwarsthoughts.com/2019/10/27/luke-skywalker-confronting-fear-is-the-destiny-of-a-jedi/">Confronting fear is the destiny of a Jedi</a> (scientist). Your destiny. Below, we will face our fear of colliders and learn to overcome it with DAGs, the elegant weapon of a Jedi scientist.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/notafraid.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Learn to fear colliders, then learn how to confront them with DAGs.</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-colliders" class="level2">
<h2 class="anchored" data-anchor-id="sec-colliders">What is a collider?</h2>
<p>Ok, so what exactly <em>is</em> a collider? To answer that, we should first specify a causal <a href="https://onbiostatistics.blogspot.com/2022/04/estimands-estimator-estimate-and.html">estimand</a> of interest - say, the causal effect or “average marginal effect” of <em>X</em> on outcome <em>Y</em>. Once we’ve determined what exactly we are trying to estimate using data, then we might start thinking about other things - like colloquially named “third variables” - that might be related to or potentially bias our estimate of the quantity of interest.</p>
<p>In our experience, most criminologists understand <a href="https://www.methodsman.com/blog/confounding-rose">confounding bias</a> and immediately think of confounders when asked about “third variables” that might affect causal effect estimation. Most also seem to have reasonable intuitions regarding what to do about confounders (e.g., adjust or “control” for them to block their <a href="http://causality.cs.ucla.edu/blog/index.php/category/back-door-criterion/">“backdoor”</a> causal paths). Additionally, many criminologists are familiar with <a href="https://www.publichealth.columbia.edu/research/population-health-methods/causal-mediation">mediation</a> - a type of “third variable” related to causal estimation that we discussed in our <a href="https://reluctantcriminologists.com/blog-posts/%5B4%5D/causation-no-corr">last post on causation without correlation</a>. In that post, we demonstrated how adjusting for a mediator <em>M</em> removes part of the total causal effect of <em>X</em> on <em>Y</em> - specifically, it isolates the indirect effect of <em>X</em> through <em>M</em> - from our causal estimate.</p>
<p>Like confounders and mediators of the <em>X</em>/<em>Y</em> relationship, colliders have been described as another type of <a href="https://www.the100.ci/2017/03/14/that-one-weird-third-variable-problem-nobody-ever-mentions-conditioning-on-a-collider/">“third variable”</a> that is relevant to causal effect estimation. However, unlike confounders and mediators, we get the sense that many in our field do not understand and perhaps have never even heard of colliders. So, what are they?</p>
<p>Well, most of the sources that we have read explicitly or implicitly define colliders <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8967310/">as a type of third variable is caused by both <em>X</em> and <em>Y</em></a>. The causal diagram depicted in the figure below represents the quintessential collider example.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(simstudy)</span>
<span id="cb1-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html</span></span>
<span id="cb1-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://kgoldfeld.github.io/simstudy/articles/simstudy.html</span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(psych) #detach to ensure alpha works with ggplot</span></span>
<span id="cb1-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(devtools)</span></span>
<span id="cb1-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install_github("jtextor/dagitty/r")</span></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dagitty)</span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdag)</span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(truncnorm)</span>
<span id="cb1-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(see)</span>
<span id="cb1-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># devtools::install_github("strengejacke/strengejacke")</span></span>
<span id="cb1-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sjPlot"</span>)</span>
<span id="cb1-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes"</span>)</span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"margins"</span>)</span>
<span id="cb1-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggdist"</span>)</span>
<span id="cb1-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb1-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtsummary)</span>
<span id="cb1-22"></span>
<span id="cb1-23">hauntedDAG1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb1-24">  Z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Y,</span>
<span id="cb1-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>,</span>
<span id="cb1-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>,</span>
<span id="cb1-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb1-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-30">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-31">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collider =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Z"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb1-32"></span>
<span id="cb1-33">hauntedDAG1p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hauntedDAG1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> collider)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb1-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb1-44"></span>
<span id="cb1-45">hauntedDAG1p </span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/DAG1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 1. DAG of classic three-variable example of a collider (Z)</figcaption>
</figure>
</div>
</div>
</div>
<section id="sec-trickshot" class="level3">
<h3 class="anchored" data-anchor-id="sec-trickshot">Colliders are like trick shots</h3>
<p>While this common definition usefully describes some colliders, we do not think it sufficiently captures all types of colliders. Assuming you have specified an estimand and then summarized relevant causal relationships in a DAG of the theorized data generating process connecting <em>X</em> and <em>Y</em>, then a more general definition of a collider might be <strong>any node in the DAG that you can trace along a path between <em>X</em> and <em>Y</em>, irrespective of directionality, where two or more arrows meet head-to-head</strong>. Judea Pearl <a href="http://bayes.cs.ucla.edu/BOOK-2K/d-sep.html">similarly describes colliders</a> as follows:</p>
<blockquote class="blockquote">
<p>“By a”path” we mean any consecutive sequence of edges, disregarding their directionalities. By “unblocked path” we mean a path that can be traced without traversing a pair of arrows that collide “head-to-head”. In other words, arrows that meet head-to-head do not constitute a connection for the purpose of passing information, such a meeting will be called a “collider”.”</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/https:/media.giphy.com/media/v1.Y2lkPTc5MGI3NjExY2ZhYjNlYzlmZjM1YjFmNmY3MzYxNGVmNTI4OGJjZTM1NmFhMzk0OCZlcD12MV9pbnRlcm5hbF9naWZzX2dpZklkJmN0PWc/iyaBAsg1Hyn23RI9m3/giphy.gif" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Colliders are like trick shots where arrows meet head to head (in a DAG)</figcaption>
</figure>
</div>
<p>We have provided some example DAGs below in which the variable <em>Z</em> is a collider in a path between <em>X</em> and <em>Y</em>. As you will see, the collider <em>Z</em> is not always caused (directly or as a descendent) by the outcome <em>Y</em>.<sup>1</sup> Likewise, in this blog post, we have attempted to deviate from the typical three-variable models (e.g., DAG Example 1, where <em>X</em> and <em>Y</em> cause collider <em>Z</em>) that we often encounter in collider explanations. Instead, we aimed to specify colliders and illustrate potential collider biases that might routinely occur from conditioning on a collider that is <em>not</em> necessarily an effect or a descendant of the outcome variable (<em>Y</em>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">hauntedDAG2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb2-2">  Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X,</span>
<span id="cb2-3">  A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X, </span>
<span id="cb2-4">  B <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Y,</span>
<span id="cb2-5">  Z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B,</span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>,</span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">B=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb2-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">B=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb2-11">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-12">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collider =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Z"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb2-13"></span>
<span id="cb2-14">hauntedDAG2p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hauntedDAG2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> collider)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb2-25"></span>
<span id="cb2-26"></span>
<span id="cb2-27">hauntedDAG3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb2-28">  Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> M <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C,</span>
<span id="cb2-29">  Z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> M, </span>
<span id="cb2-30">  M <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C,</span>
<span id="cb2-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>,</span>
<span id="cb2-32">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>,</span>
<span id="cb2-33">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb2-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-36">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-37">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collider =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Z"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb2-38"></span>
<span id="cb2-39">hauntedDAG3p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hauntedDAG3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> collider)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 3"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb2-50"></span>
<span id="cb2-51"></span>
<span id="cb2-52">hauntedDAG4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb2-53">  Z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C,</span>
<span id="cb2-54">  Y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C, </span>
<span id="cb2-55">  X <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> C,</span>
<span id="cb2-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>,</span>
<span id="cb2-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>,</span>
<span id="cb2-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb2-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Z=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-61">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-62">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collider =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Z"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>))</span>
<span id="cb2-63"></span>
<span id="cb2-64">hauntedDAG4p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hauntedDAG4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> collider)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-72">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb2-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 4"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb2-75"></span>
<span id="cb2-76">(hauntedDAG1p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> hauntedDAG2p) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (hauntedDAG3p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> hauntedDAG4p)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/DAG2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 2. Examples of colliders (Z) in four different DAGs</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-whycare" class="level2">
<h2 class="anchored" data-anchor-id="sec-whycare">Why should we care about colliders?</h2>
<p>So, how do colliders affect attempts to estimate the causal effect of <em>X</em> on <em>Y</em>? Well, when a causal system includes a collider in a path between <em>X</em> and <em>Y</em>, then <em>X</em> and <em>Y</em> are connected in such a way that, similar to mediators and confounders, we can expect the “passing” of empirical information (statistical dependence) between variables under certain conditions. Yet, paths between <em>X</em> and <em>Y</em> that contain confounders and mediators begin as unblocked and, therefore, causal estimates of the effect of <em>X</em> on <em>Y</em> will contain information from these types of third variables unless we stratify or condition on them to block their empirical information from passing between <em>X</em> and <em>Y</em>. In symmetric contrast, a path containing a collider begins as blocked, meaning that causal estimates of the effect of <em>X</em> on <em>Y</em> do not initially contain information about colliders. However, stratifying or conditioning on a collider unblocks this path, allowing information to flow through the collider and, therefore, biasing estimates of the causal effect of <em>X</em> on <em>Y</em>s. Likewise, in reference to colliders, Pearl states:</p>
<blockquote class="blockquote">
<p>“When we measure a common effect of two independent causes, the causes becomes dependent, because finding the truth of one makes the other less likely (or”explained away”), and refuting one implies the truth of the other.”</p>
</blockquote>
<p>DAGs are extremely useful, then, in helping us identify all paths through which information might flow between <em>X</em> and <em>Y</em> and, likewise, in figuring out which variables we <em>should</em> be including in our models to adjust for confounding bias and which variables we <em>should not</em> include in our models to avoid removing indirect causal effects and/or introducing collider bias.</p>
<p>For instance, using the fourth example above, we can identify all paths between <em>X</em> and <em>Y</em> and <a href="https://evalf20.classes.andrewheiss.com/example/dags/#paths-and-adjustment-sets">identify appropriate adjustment sets</a> automatically using <code>ggdag::ggdag_paths()</code> and <code>ggdag::ggdag_adjustment_set()</code>. You will note below that the path from <em>X</em> -&gt; <em>Y</em> and <em>X</em> &lt;- <em>C</em> -&gt; <em>Y</em> are open or unblocked paths, but the path from <em>X -&gt; Z &lt;- C -&gt; Y</em> is not an open path - unless we open it by conditioning on <em>Z</em> and, in turn, bias our estimate of the effect of <em>X</em> on <em>Y</em>. Likewise, the appropriate adjustment set for Example 4 contains only <em>C</em>, meaning we should control for <em>C</em> but not <em>Z</em> (or <em>C</em> and <em>Z</em>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">Ex4paths <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggdag_paths</span>(hauntedDAG4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 4 unblocked paths"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb3-6"></span>
<span id="cb3-7">Ex4adj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggdag_adjustment_set</span>(hauntedDAG4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shadow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 4 adjustment set"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb3-12"></span>
<span id="cb3-13">Ex4paths <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> Ex4adj</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/DAG3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 3. Unblocked paths (top) &amp; adjustment set (bottom) from Example 4 DAG above</figcaption>
</figure>
</div>
</div>
</div>
<p>Hopefully, it is clear by now that conditioning on a collider (and other issues) can inadvertently occur when we do not have <a href="https://journals.sagepub.com/doi/10.1177/25152459221095823">clear causal reasons for selecting control variables</a> in our models. Yet, depending upon the research question &amp; estimand of interest, conditioning on a collider can also happen when we analyze data collected via research designs involving known selection on variables related to causal processes of interest. This might pose particular challenges for criminologists investigating certain types of questions with popular data sources comprising samples of responses from youth with known criminal histories (e.g.&nbsp;Pathways to Desistance), or incarcerated samples, or even college student samples.</p>
<p>We will present examples of biases caused by conditioning on a collider with both methods (over-control &amp; selection) using simulated and real-world data. The first two examples will use simulated data that were generated in a way that resembles some key features of real-world criminological data. The third example will rely on comparisons of real-world data collected from a college student sample and from a similarly-aged online sample.</p>
</section>
<section id="sec-SATdag" class="level2">
<h2 class="anchored" data-anchor-id="sec-SATdag">Causal model (DAG) for simulated data</h2>
<p>Many existing examples of collider bias are in different fields &amp; use toy examples with only a few variables and, at least for us, do not always clearly represent the types of problems we face in criminology. Thus, if you’re like us, upon learning about collider bias, you may develop a fear of the problem, but you have difficulty imagining how such issues might affect analyses in criminology. So, a key goal in the examples below is realism. We want to present a scenario that many of us have or will encounter in the criminological wild.</p>
<p>In our first example, we will explore how colliders might bias estimation of the causal effects of high self-control and weak moral beliefs on delinquency.</p>
<p>The core causal structure underlying this part of the DAG we use to simulate data is inspired by theory and research on <a href="https://www.cac.crim.cam.ac.uk/resou/sat">Situational Action Theory</a> (SAT). Specifically, we will focus on modeling the theory’s posited <a href="https://journals.sagepub.com/doi/abs/10.1177/1477370807074858?journalCode=euca">interaction between moral beliefs and self-control</a> in predicting delinquent or criminal behavior.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/Brauer-SAT-figure.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 4: Stick figures depicting SAT’s perception-choice process</figcaption>
</figure>
</div>
<p>SAT’s basic claim is that most people refrain from crime for moral, not rational, reasons: Those who strongly believe that a criminal behavior is morally wrong generally will not perceive that crime as morally viable situational action alternative and, likewise, will not engage in that behavior - irrespective of their levels of self-control (i.e., executive functioning capacities). However, those with weaker moral beliefs might perceive a criminal behavior as a situational action alternative and, in such situations, their levels of self-control may become causally relevant to decision-making. As <a href="https://journals.sagepub.com/doi/abs/10.1177/1477370807074858?journalCode=euca">Wikstrom &amp; Treiber explain</a>:</p>
<blockquote class="blockquote">
<p>“…the primary reason for individuals’ law abidance is strong moral beliefs (and moral habits) that correspond to the moral rules of the law, rather than their ability to exercise self-control…” (p.250)</p>
</blockquote>
<blockquote class="blockquote">
<p>“…this implies that <em>morality is the fundamental individual characteristic</em> in the explanation of crime and that an individual’s ability to exercise self-control plays a far more limited role…” (p.251, emphasis in original)</p>
</blockquote>
<p>While SAT actually implies a complex causal structure involving a three-way (or more) interaction between moral beliefs, moral context, and self-control, we will specify a simpler DAG for the purposes of illustrating collider biases. Instead, we will aim to specify a causal structure and simulate data that builds upon the logic of many tests of SAT, which often regress delinquency or crime on self-control, moral beliefs, and their multiplicative interaction, as well as include gender and “controls” for other (presumably independent) variables.</p>
<p>Specifically, we will aim to generate data that resembles the interactive relationships found in such tests, like those <a href="https://journals.sagepub.com/doi/abs/10.1177/0093854810366542?journalCode=cjbb">Svensson and colleagues</a> documented across three international samples:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/Interactions.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 5: Self-control and morality interact to predict delinquency</figcaption>
</figure>
</div>
<p>Yet, as we think is true in tests of most criminological theories, empirical tests of SAT often explicitly consider only a limited set of causal relationships within a data source generated by a much larger connection of complex interlinked causal processes. So, we will add a bit of plausible complexity to the DAG to illustrate how colliders might bias estimation of theorized causal effects.</p>
<section id="sec-DAG4" class="level3">
<h3 class="anchored" data-anchor-id="sec-DAG4">DAG of causal structure underlying simulated data</h3>
<p>Below is our DAG of a simple causal structure describing a plausible (if simplified) data generating process used to simulate data for our first two examples. We highlighted the focal estimand of interest (effect of self-control on delinquency) for our first simulation example with a red arrow.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">collideDAG <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagitty</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dag{</span></span>
<span id="cb4-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Male -&gt; {SelfControl MoralBeliefs Delinquency PriorFelony}</span></span>
<span id="cb4-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  SelfControl -&gt; {Delinquency PriorFelony QualityEmploy College}</span></span>
<span id="cb4-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  MoralBeliefs -&gt; {Delinquency PriorFelony QualityEmploy College}</span></span>
<span id="cb4-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  PriorFelony -&gt; QualityEmploy</span></span>
<span id="cb4-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  SES -&gt; {QualityEmploy College}</span></span>
<span id="cb4-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  College -&gt; QualityEmploy</span></span>
<span id="cb4-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   }'</span>)</span>
<span id="cb4-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coordinates</span>( collideDAG ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb4-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PriorFelony=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">QualityEmploy=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SelfControl=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Male=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MoralBeliefs=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">College=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb4-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PriorFelony=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SelfControl=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">QualityEmploy=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Male=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MoralBeliefs=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">College=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) )</span>
<span id="cb4-12"></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(collideDAG)</span></span>
<span id="cb4-14"></span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#function to shorten arrows (edges)</span></span>
<span id="cb4-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://stackoverflow.com/questions/65420136/how-do-you-adjust-the-arrows-in-a-ggplot-of-a-ggdag</span></span>
<span id="cb4-18">shorten_dag_arrows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(tidy_dag, proportion){</span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update underlying ggdag object</span></span>
<span id="cb4-20">tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(tidy_dag<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, </span>
<span id="cb4-21">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(xend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x, </span>
<span id="cb4-22">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(yend <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y,</span>
<span id="cb4-23">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xstart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> xend,</span>
<span id="cb4-24">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ystart =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>proportion<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>yend) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> yend)</span>
<span id="cb4-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(tidy_dag)</span>
<span id="cb4-26">}</span>
<span id="cb4-27"></span>
<span id="cb4-28"></span>
<span id="cb4-29">collideDAGalt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb4-30">  Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl,</span>
<span id="cb4-31">  PriorFelony <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl, </span>
<span id="cb4-32">  MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male, </span>
<span id="cb4-33">  SelfControl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male,</span>
<span id="cb4-34">  College <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES, </span>
<span id="cb4-35">  QualityEmploy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> College <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> PriorFelony, </span>
<span id="cb4-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># labels = c("Delinquency" = "Delinquency",</span></span>
<span id="cb4-37">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "MoralBeliefs" = "Moral\nBeliefs",</span></span>
<span id="cb4-38">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "Male" = "Male",</span></span>
<span id="cb4-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "SelfControl" = "Self-\nControl",</span></span>
<span id="cb4-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "PriorFelony" = "Prior\nFelony",</span></span>
<span id="cb4-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "College" = "Attend\nCollege",</span></span>
<span id="cb4-42">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "SES" = "SES",</span></span>
<span id="cb4-43">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                 "QualityEmploy" = "Quality\nEmploy"),</span></span>
<span id="cb4-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SelfControl"</span>,</span>
<span id="cb4-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb4-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PriorFelony=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">QualityEmploy=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SelfControl=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Male=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb4-48">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MoralBeliefs=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">College=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PriorFelony=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SelfControl=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">QualityEmploy=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Male=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb4-50">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MoralBeliefs=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">College=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-51">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-52">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collider =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PriorFelony"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QualityEmploy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"College"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>))</span>
<span id="cb4-53"></span>
<span id="cb4-54"></span>
<span id="cb4-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#function to shorten arrows - set percentage to shorten</span></span>
<span id="cb4-56">collideDAGaltp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(collideDAGalt, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb4-57"></span>
<span id="cb4-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggdag(collideDAGaltp, </span></span>
<span id="cb4-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#              use_labels = "label", text = FALSE)</span></span>
<span id="cb4-60"></span>
<span id="cb4-61"></span>
<span id="cb4-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#if using label in geom_dag_text, arrange data by name then match labels to order of names in data!</span></span>
<span id="cb4-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print(collideDAGalt$data$name)</span></span>
<span id="cb4-64"></span>
<span id="cb4-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#create factor variable to isolate edge of interest, permits specifying edge color</span></span>
<span id="cb4-66">testdat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> collideDAGaltp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">myedge1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(collideDAGaltp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SelfControl"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> collideDAGaltp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>to <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb4-68">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no"</span>)</span>
<span id="cb4-69">  ) </span>
<span id="cb4-70"></span>
<span id="cb4-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#try filtering plot data for only edge of interest &amp; adding colored layer?</span></span>
<span id="cb4-72"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggraph)</span>
<span id="cb4-73">collideDAGaltp2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> testdat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-74">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#geom_dag_point(aes(color = collider)) +</span></span>
<span id="cb4-75">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_dag_edges(data = function(x) filter(x, name == "SelfControl" &amp; to == "Delinquency"), </span></span>
<span id="cb4-76">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                aes(x = xstart, y = ystart), color="maroon") +</span></span>
<span id="cb4-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xstart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ystart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color=</span>myedge1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Attend</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">College"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"   Delinquency"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moral</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Beliefs"</span>,</span>
<span id="cb4-79">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prior</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Felony"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quality</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Employ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Self-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Control"</span>), </span>
<span id="cb4-80">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> collider)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add labels</span></span>
<span id="cb4-81">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_dag_label_repel(</span></span>
<span id="cb4-82">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   aes(label=collideDAGalt$data$label), </span></span>
<span id="cb4-83">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       # fill="green",</span></span>
<span id="cb4-84">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       show.legend = FALSE) + </span></span>
<span id="cb4-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_edge_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change second color to highlight focal myedge1 </span></span>
<span id="cb4-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-90">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb4-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data-generating DAG"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb4-93"></span>
<span id="cb4-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how to change text names in DAG nodes </span></span>
<span id="cb4-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://www.r-bloggers.com/2019/10/how-to-use-math-symbols-with-ggdag/</span></span>
<span id="cb4-96"></span>
<span id="cb4-97"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># how to change color of all edges</span></span>
<span id="cb4-98"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_dag_edges(edge_color = "steelblue") +</span></span>
<span id="cb4-99"></span>
<span id="cb4-100">collideDAGaltp2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/DAG4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 6. Causal diagram (DAG) used to generate simulated data</figcaption>
</figure>
</div>
</div>
</div>
<p>As suggested, even this DAG is simplified for clarity purposes. It ignores, for instance, all other potential measured (e.g., race/ethnicity) and unmeasured confounders that might affect selection into delinquent behavior, criminal justice contact and subsequent felony conviction, and participation in a survey. Still, an important first step in analyzing data should be to precisely and transparently specify causal assumptions. Even if the causal model is wrong (as all likely are), we can learn from it because a precisely and transparently reported causal model clearly communicates the assumptions underlying our interpretation of the data and, in turn, allows others to critique, test, and challenge our causal model with alternatives.</p>
<p>Put differently, DAGs force the researcher to make choices, and these choices are ultimately testable. For example, in the above DAG, there is no arrow going directly from prior felony to delinquency. Thus, this DAG explicitly assumes that any empirically observed statistical dependence between prior felony and delinquency is expected to be entirely caused by other factors in the model (i.e., morality, sex, and self-control). If you think other factors than those in the DAG are important (e.g., crime as a collateral consequence of official labeling or the pains of punishment), then you can modify the DAG and examine the empirical implications of doing so. For now, we think this DAG will suit our purposes of illustrating some consequences of conditioning on colliders in three different examples using simulated yet realistic (examples 1 &amp; 2) and real-world (example 3) criminological data.</p>
<p>In our first example, we will estimate the moderated effects of self-control on delinquency at different levels of moral beliefs in two samples: (1) a sample drawn at random from a “general” population with known (simulated) parameters; and (2) a “restricted” sample selected at random from the same population only <em>after</em> limiting the sampling frame to those with criminal felony records. This second restricted sample was motivated by the <a href="https://www.pathwaysstudy.pitt.edu/">Pathways to Desistance study</a>, a commonly used data source in criminology.</p>
<p>In the second example, we will use these simulated data to examine whether conditioning on a collider might bias estimates of the null effect of SES on delinquency.</p>
<p>In the third example, we will briefly illustrate how conditioning on a collider might impact causal estimates using real-world data from college students and MTurk workers.</p>
<p>Now let’s simulate some data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/simulations.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Because, you know, addressing collider bias in messy real data is “just like the simulations.”</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-simdata" class="level2">
<h2 class="anchored" data-anchor-id="sec-simdata">Simulating data for examples 1 &amp; 2</h2>
<p>For simplicity, we will assume random normal distributions for socioeconomic status (SES), employment status/quality, and self-control. We will assume Poisson distributed morality and delinquency scales. Morality’s continuous Poisson distribution is rounded down to nearest integer and truncated so negative values are recoded as zero. Delinquency’s continuous Poisson distribution is rounded to the nearest integers. These rounding procedures add a bit more noise to the data and also make these variable more comparable to the types of highly skewed, ordinal, Likert-type measures we see in our field.</p>
<p>For realism, the magnitudes of key simulated causal effects for the first example are relatively consistent with <a href="https://www.researchgate.net/profile/Lieven-Pauwels/publication/257467328_PAUWELS_L_2012_How_Similar_is_the_Interaction_Between_Low_Self-Control_and_Deviant_Moral_Beliefs_in_the_Explanation_of_Adolescent_Offending_An_Inquiry_in_Sub_Groups_by_Gender_and_Immigrant_Background_/links/004635255013c9d38d000000/PAUWELS-L-2012-How-Similar-is-the-Interaction-Between-Low-Self-Control-and-Deviant-Moral-Beliefs-in-the-Explanation-of-Adolescent-Offending-An-Inquiry-in-Sub-Groups-by-Gender-and-Immigrant-Background.pdf">published correlation matrices</a>.</p>
<p>For the second example, we will assume no total effect of SES on delinquency association (for rationale, see our <a href="https://reluctantcriminologists.com/blog-posts/%5B4%5D/causation-no-corr">previous blog on causation without correlation</a>). However, we will assume a hypothetical positive effect of SES and negative effect of felony convictions on employment status/quality.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">options</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scipen=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb5-4">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6100</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#want approx n=1350 with felonies selecting into final sample (Pathways: n=1354)</span></span>
<span id="cb5-5"></span>
<span id="cb5-6">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binary"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>)</span>
<span id="cb5-8">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>,</span>
<span id="cb5-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-10">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HighSC"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>,</span>
<span id="cb5-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 + (-.21)*Male"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-12">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LowMoral"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb5-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.3 + 0.36*Male"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simpop &lt;- simpop %&gt;% mutate(LowMoral = ifelse(LowMoral &gt; 5, 5, LowMoral)) #truncate LowMoral (0-5) 0</span></span>
<span id="cb5-15">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>,</span>
<span id="cb5-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-.7 + .20*Male + (-.05)*HighSC + .68*LowMoral + (-.21)*HighSC*LowMoral"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>)</span>
<span id="cb5-17">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Felony"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binary"</span>, </span>
<span id="cb5-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-3.5 + 2.2*Male + (-.09)*HighSC + (.62)*LowMoral + (-.20)*HighSC*LowMoral"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>)</span>
<span id="cb5-19">def <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">defData</span>(def, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">varname =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QualityEmploy"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"normal"</span>,</span>
<span id="cb5-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 + .5*SES + .3*HighSC + (-.3)*LowMoral + (-2)*Felony"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variance =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-21">simpop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">genData</span>(n, def)</span>
<span id="cb5-22"></span>
<span id="cb5-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap LowMoral at 5 (0-5 item) - randomly replace n=3 oob values with values in bounds </span></span>
<span id="cb5-24">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>LowMoral <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb5-25">simpop<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>LowMoral[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-26"></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cap Delinquency at 7 (0-7 item) - randomly replace oob values with in bounds values</span></span>
<span id="cb5-28">inds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span></span>
<span id="cb5-29">simpop<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Delinquency[inds] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(inds), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-30"></span>
<span id="cb5-31">simpop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Felonysamp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(Felony))</span>
<span id="cb5-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simpop</span></span>
<span id="cb5-34">simsamp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Felony<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>) </span>
<span id="cb5-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># simsamp</span></span>
<span id="cb5-36"></span>
<span id="cb5-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># table(simsamp$Male) #approx .85 in sample</span></span>
<span id="cb5-38"></span>
<span id="cb5-39"></span>
<span id="cb5-40">Maleplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Male, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..,</span>
<span id="cb5-41">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-47">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-48">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-50"></span>
<span id="cb5-51">SESplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>SES, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density.., </span>
<span id="cb5-52">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb5-54">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-60">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-62"></span>
<span id="cb5-63">HighSCplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>HighSC, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density.., </span>
<span id="cb5-64">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb5-66">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-71">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-72">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High self-control"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-74"></span>
<span id="cb5-75">LowMoralplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>LowMoral, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density.., </span>
<span id="cb5-76">                                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-82">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-83">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Low morality"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-85"></span>
<span id="cb5-86">Delqplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Delinquency, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density.., </span>
<span id="cb5-87">                                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-93">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-94">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-96"></span>
<span id="cb5-97">Felonyplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Felony, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..,</span>
<span id="cb5-98">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-104">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-105">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-106">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Felonysamp"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-107"></span>
<span id="cb5-108">Employplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>QualityEmploy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density.., </span>
<span id="cb5-109">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb5-111">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-116">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-117">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Employment status/quality"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-119"></span>
<span id="cb5-120"></span>
<span id="cb5-121">Maleplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SESplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> HighSCplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-122">  LowMoralplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Delqplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Felonyplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Employplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-123">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_area</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s examine the bivariate correlations between our variables in the simulated “general” sample.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://r-coder.com/correlation-plot-r/  </span></span>
<span id="cb6-2"></span>
<span id="cb6-3">trimpop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>id)</span>
<span id="cb6-4"></span>
<span id="cb6-5">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pairs.panels</span>(trimpop,</span>
<span id="cb6-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smooth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, draws loess smooths</span></span>
<span id="cb6-7">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, scales the correlation text font</span></span>
<span id="cb6-8">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds density plots and histograms</span></span>
<span id="cb6-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ellipses =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, draws ellipses</span></span>
<span id="cb6-10">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pearson"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlation method (also "spearman" or "kendall")</span></span>
<span id="cb6-11">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pch symbol</span></span>
<span id="cb6-12">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, plots linear fit rather than the LOESS (smoothed) fit</span></span>
<span id="cb6-13">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cor =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, reports correlations</span></span>
<span id="cb6-14">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jiggle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, data points are jittered</span></span>
<span id="cb6-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factor =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Jittering factor</span></span>
<span id="cb6-16">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hist.col =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histograms color</span></span>
<span id="cb6-17">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stars =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds significance level with stars</span></span>
<span id="cb6-18">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds confidence intervals</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, let’s examine the bivariate correlations between our variables in the simulated “restricted” sample in which participants are selected based upon felony conviction status.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://r-coder.com/correlation-plot-r/  </span></span>
<span id="cb7-2"></span>
<span id="cb7-3">trimsamp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simsamp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(id, Felony, Felonysamp))</span>
<span id="cb7-4"></span>
<span id="cb7-5">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pairs.panels</span>(trimsamp,</span>
<span id="cb7-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smooth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, draws loess smooths</span></span>
<span id="cb7-7">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, scales the correlation text font</span></span>
<span id="cb7-8">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds density plots and histograms</span></span>
<span id="cb7-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ellipses =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, draws ellipses</span></span>
<span id="cb7-10">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pearson"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlation method (also "spearman" or "kendall")</span></span>
<span id="cb7-11">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pch symbol</span></span>
<span id="cb7-12">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, plots linear fit rather than the LOESS (smoothed) fit</span></span>
<span id="cb7-13">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cor =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, reports correlations</span></span>
<span id="cb7-14">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jiggle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, data points are jittered</span></span>
<span id="cb7-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factor =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Jittering factor</span></span>
<span id="cb7-16">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hist.col =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histograms color</span></span>
<span id="cb7-17">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stars =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds significance level with stars</span></span>
<span id="cb7-18">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds confidence intervals</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Even a brief examination of the bivariate correlation matrices foreshadows some of the problems we face when our research design invokes selection on a collider into the sample. For instance, imagine one group of researchers estimates gender gaps in self-control (<em>r</em>=-0.09), weak moral beliefs (<em>r</em>=0.17), and delinquency (<em>r</em>=0.18) using the general sample and then another group replicates their analysis using the felony sample (<em>r</em>=-0.01, 0.05, and 0.05, respectively). How might conclusions differ across these two studies?</p>
</section>
<section id="sec-ex1" class="level2">
<h2 class="anchored" data-anchor-id="sec-ex1">Example 1: Estimating causal effect of self-control on delinquency</h2>
<p>Let’s not get ahead of ourselves. Instead, let’s illustrate in detail with our first example. We begin by estimating a generalized linear model predicting delinquency in the simulated general sample and in the restricted sample that is selected on felony convictions. In both models, we specify a Poisson distribution with a log link for our delinquency outcome. Though we should also account for ordinal nature of predictors (e.g., model monotonic effects with cumulative logit link function), we will save that for a future blog entry.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#nonlinear models predicting delinquency in pop &amp; sample</span></span>
<span id="cb8-2">glm1a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> HighSC <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> LowMoral , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simpop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(glm1a)</span></span>
<span id="cb8-4">glm1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> HighSC <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> LowMoral , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simsamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(glm1b)</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set table theme</span></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_gtsummary_compact</span>()</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function for custom p-values</span></span>
<span id="cb8-11">roundp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb8-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(</span>
<span id="cb8-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x), </span>
<span id="cb8-14">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>,</span>
<span id="cb8-15">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scientific =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scientific =</span> F))</span>
<span id="cb8-16">    )</span>
<span id="cb8-17">  } </span>
<span id="cb8-18"></span>
<span id="cb8-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># function for reg output w/custom p-values</span></span>
<span id="cb8-20">regsum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(mymod) {</span>
<span id="cb8-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tbl_regression</span>(mymod, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pvalue_fun =</span> roundp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_significance_stars</span>(</span>
<span id="cb8-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb8-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb8-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hide_p =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb8-26">      )</span>
<span id="cb8-27">}</span>
<span id="cb8-28"></span>
<span id="cb8-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm1a) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-31">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 1: Poisson model 1a, General sample"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="zpcxbyzutw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zpcxbyzutw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zpcxbyzutw thead, #zpcxbyzutw tbody, #zpcxbyzutw tfoot, #zpcxbyzutw tr, #zpcxbyzutw td, #zpcxbyzutw th {
  border-style: none;
}

#zpcxbyzutw p {
  margin: 0;
  padding: 0;
}

#zpcxbyzutw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zpcxbyzutw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zpcxbyzutw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zpcxbyzutw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zpcxbyzutw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zpcxbyzutw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zpcxbyzutw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zpcxbyzutw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zpcxbyzutw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zpcxbyzutw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zpcxbyzutw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zpcxbyzutw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zpcxbyzutw .gt_spanner_row {
  border-bottom-style: hidden;
}

#zpcxbyzutw .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zpcxbyzutw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zpcxbyzutw .gt_from_md > :first-child {
  margin-top: 0;
}

#zpcxbyzutw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zpcxbyzutw .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zpcxbyzutw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zpcxbyzutw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zpcxbyzutw .gt_row_group_first td {
  border-top-width: 2px;
}

#zpcxbyzutw .gt_row_group_first th {
  border-top-width: 2px;
}

#zpcxbyzutw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#zpcxbyzutw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zpcxbyzutw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zpcxbyzutw .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zpcxbyzutw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#zpcxbyzutw .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zpcxbyzutw .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zpcxbyzutw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zpcxbyzutw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zpcxbyzutw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zpcxbyzutw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#zpcxbyzutw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zpcxbyzutw .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#zpcxbyzutw .gt_left {
  text-align: left;
}

#zpcxbyzutw .gt_center {
  text-align: center;
}

#zpcxbyzutw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zpcxbyzutw .gt_font_normal {
  font-weight: normal;
}

#zpcxbyzutw .gt_font_bold {
  font-weight: bold;
}

#zpcxbyzutw .gt_font_italic {
  font-style: italic;
}

#zpcxbyzutw .gt_super {
  font-size: 65%;
}

#zpcxbyzutw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zpcxbyzutw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zpcxbyzutw .gt_indent_1 {
  text-indent: 5px;
}

#zpcxbyzutw .gt_indent_2 {
  text-indent: 10px;
}

#zpcxbyzutw .gt_indent_3 {
  text-indent: 15px;
}

#zpcxbyzutw .gt_indent_4 {
  text-indent: 20px;
}

#zpcxbyzutw .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 1: Poisson model 1a, General sample</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">-0.50***</td>
<td headers="std.error" class="gt_row gt_center">0.022</td>
<td headers="ci" class="gt_row gt_center">-0.55, -0.46</td>
<td headers="p.value" class="gt_row gt_center">4.51e-115</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.17***</td>
<td headers="std.error" class="gt_row gt_center">0.024</td>
<td headers="ci" class="gt_row gt_center">0.12, 0.22</td>
<td headers="p.value" class="gt_row gt_center"> 4.22e-13</td></tr>
    <tr><td headers="label" class="gt_row gt_left">HighSC</td>
<td headers="estimate" class="gt_row gt_center">-0.23***</td>
<td headers="std.error" class="gt_row gt_center">0.018</td>
<td headers="ci" class="gt_row gt_center">-0.26, -0.19</td>
<td headers="p.value" class="gt_row gt_center"> 2.27e-35</td></tr>
    <tr><td headers="label" class="gt_row gt_left">LowMoral</td>
<td headers="estimate" class="gt_row gt_center">0.50***</td>
<td headers="std.error" class="gt_row gt_center">0.010</td>
<td headers="ci" class="gt_row gt_center">0.48, 0.52</td>
<td headers="p.value" class="gt_row gt_center"> 0.00e+00</td></tr>
    <tr><td headers="label" class="gt_row gt_left">HighSC * LowMoral</td>
<td headers="estimate" class="gt_row gt_center">-0.01</td>
<td headers="std.error" class="gt_row gt_center">0.009</td>
<td headers="ci" class="gt_row gt_center">-0.03, 0.00</td>
<td headers="p.value" class="gt_row gt_center">0.133</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm1b) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-3">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 1: Poisson model 1b, Felony sample"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="ynjnlyqdfn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ynjnlyqdfn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ynjnlyqdfn thead, #ynjnlyqdfn tbody, #ynjnlyqdfn tfoot, #ynjnlyqdfn tr, #ynjnlyqdfn td, #ynjnlyqdfn th {
  border-style: none;
}

#ynjnlyqdfn p {
  margin: 0;
  padding: 0;
}

#ynjnlyqdfn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ynjnlyqdfn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ynjnlyqdfn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ynjnlyqdfn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ynjnlyqdfn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ynjnlyqdfn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ynjnlyqdfn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ynjnlyqdfn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ynjnlyqdfn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ynjnlyqdfn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ynjnlyqdfn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ynjnlyqdfn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ynjnlyqdfn .gt_spanner_row {
  border-bottom-style: hidden;
}

#ynjnlyqdfn .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ynjnlyqdfn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ynjnlyqdfn .gt_from_md > :first-child {
  margin-top: 0;
}

#ynjnlyqdfn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ynjnlyqdfn .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ynjnlyqdfn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ynjnlyqdfn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ynjnlyqdfn .gt_row_group_first td {
  border-top-width: 2px;
}

#ynjnlyqdfn .gt_row_group_first th {
  border-top-width: 2px;
}

#ynjnlyqdfn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#ynjnlyqdfn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ynjnlyqdfn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ynjnlyqdfn .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ynjnlyqdfn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#ynjnlyqdfn .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ynjnlyqdfn .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ynjnlyqdfn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ynjnlyqdfn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ynjnlyqdfn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ynjnlyqdfn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#ynjnlyqdfn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ynjnlyqdfn .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#ynjnlyqdfn .gt_left {
  text-align: left;
}

#ynjnlyqdfn .gt_center {
  text-align: center;
}

#ynjnlyqdfn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ynjnlyqdfn .gt_font_normal {
  font-weight: normal;
}

#ynjnlyqdfn .gt_font_bold {
  font-weight: bold;
}

#ynjnlyqdfn .gt_font_italic {
  font-style: italic;
}

#ynjnlyqdfn .gt_super {
  font-size: 65%;
}

#ynjnlyqdfn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ynjnlyqdfn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ynjnlyqdfn .gt_indent_1 {
  text-indent: 5px;
}

#ynjnlyqdfn .gt_indent_2 {
  text-indent: 10px;
}

#ynjnlyqdfn .gt_indent_3 {
  text-indent: 15px;
}

#ynjnlyqdfn .gt_indent_4 {
  text-indent: 20px;
}

#ynjnlyqdfn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 1: Poisson model 1b, Felony sample</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">-0.29***</td>
<td headers="std.error" class="gt_row gt_center">0.069</td>
<td headers="ci" class="gt_row gt_center">-0.43, -0.16</td>
<td headers="p.value" class="gt_row gt_center"> 3.02e-05</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.11</td>
<td headers="std.error" class="gt_row gt_center">0.062</td>
<td headers="ci" class="gt_row gt_center">-0.01, 0.23</td>
<td headers="p.value" class="gt_row gt_center">0.071</td></tr>
    <tr><td headers="label" class="gt_row gt_left">HighSC</td>
<td headers="estimate" class="gt_row gt_center">-0.32***</td>
<td headers="std.error" class="gt_row gt_center">0.039</td>
<td headers="ci" class="gt_row gt_center">-0.40, -0.24</td>
<td headers="p.value" class="gt_row gt_center"> 3.07e-16</td></tr>
    <tr><td headers="label" class="gt_row gt_left">LowMoral</td>
<td headers="estimate" class="gt_row gt_center">0.44***</td>
<td headers="std.error" class="gt_row gt_center">0.018</td>
<td headers="ci" class="gt_row gt_center">0.41, 0.48</td>
<td headers="p.value" class="gt_row gt_center">5.18e-136</td></tr>
    <tr><td headers="label" class="gt_row gt_left">HighSC * LowMoral</td>
<td headers="estimate" class="gt_row gt_center">0.04**</td>
<td headers="std.error" class="gt_row gt_center">0.016</td>
<td headers="ci" class="gt_row gt_center">0.01, 0.08</td>
<td headers="p.value" class="gt_row gt_center">0.006</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use min (0), mean, and +2d low moral beliefs in felony sample to plot interaction  </span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mean(simsamp$LowMoral)</span></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mean(simsamp$LowMoral) + 2*sd(simsamp$LowMoral)</span></span>
<span id="cb10-4"></span>
<span id="cb10-5">plot_glm1a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1a, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HighSC"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LowMoral [0,1.46,3.76]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High self-control"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"General sample"</span>)  </span>
<span id="cb10-8"></span>
<span id="cb10-9"></span>
<span id="cb10-10">plot_glm1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HighSC"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LowMoral [0,1.46,3.76]"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High self-control"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Felony sample"</span>)    </span>
<span id="cb10-13"></span>
<span id="cb10-14">plot_glm1a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1b <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collect'</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Success! The plot on the left confirms that our simulation recreated the moderated effects of self-control on delinquency across levels of moral beliefs as documented in earlier research (e.g., see Figure 5 above, though note our x-axis is reversed and we specified a nonlinear functional form).</p>
<section id="sec-detour" class="level3">
<h3 class="anchored" data-anchor-id="sec-detour">Detour: On interactions in nonlinear models, psychoastronomy, &amp; posterity</h3>
<p>Before moving on, let’s take a brief detour. Note the interaction coefficient between high self-control and low morality <em>is not</em> statistically significant in the general sample (model 1a). Yet, we know there is an interaction in that sample because we simulated it to be there! Likewise, the nonparallel lines in the general sample’s plot confirm the existence of the exact interaction on the outcome scale that we intended to simulate.</p>
<p>Meanwhile, notice the interaction coefficient <em>is</em> statistically significant in the felony sample (model 1b). However, the outcome scale plot shows estimated effects of self-control on delinquency are nearly parallel (i.e., little to no interaction) across the minimum, mean, and +2SD values of low moral beliefs. At the very least, these plots imply a much stronger interaction on the outcome scale in the general sample compared to the felony sample, which is the exact opposite conclusion one might draw from a naive interpretation of the magnitude and statistical significance of the model’s linear interaction coefficients.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/trap.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Beware naive interpretations of interaction terms in models with nonlinear link functions - it’s a trap!</figcaption>
</figure>
</div>
<p>Hence, these simulated results help illustrate an important lesson: <strong>Never rely on the statistical significance test results of an interaction term in a generalized linear model with a nonlinear link function (e.g., logistic; Poisson; negative binomial) to determine whether there is a significant interaction.</strong><sup>2</sup> Instead, we recommend estimating and plotting the potential interaction on the <a href="https://pubmed.ncbi.nlm.nih.gov/33523708/">outcome probability or count scale</a> and calculating predicted marginal contrasts when estimating and interpreting these types of models.</p>
<p>This is not simply an issue of preferences, nor is it an insignificant concern - and no, simply reporting odds ratios or risk ratios does not solve the problem either. Rather, the issue stems from fundamental yet oft-misunderstood <a href="https://academic.oup.com/esr/article-abstract/26/1/67/540767">differences between linear and generalized linear models</a>. We are diving deeper into this issue with additional examples in an upcoming blog post. For now, we do not expect you to just take our word for it. Here are <a href="https://journals.sagepub.com/doi/10.1177/0003122418806282">recent editors of American Sociological Review</a> offering guidelines on the same issue:</p>
<blockquote class="blockquote">
<p>“The case is closed: don’t use the coefficient of the interaction term to draw conclusions about statistical interaction in categorical models such as logit, probit, Poisson, and so on.”</p>
</blockquote>
<p>Yes, we know that many of us in our field were trained to rely on the presence or absence of stars<sup>3</sup> next to an interaction coefficient to make inferences about the existence and nature of “significant” effects from regression models - including interaction effects in generalized linear models. Likewise, we know that the prospect of <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3447245/">reading</a> and <a href="https://sociologicalscience.com/articles-v6-4-81/">learning</a> new methods can be overwhelming - not to mention academia’s structural disincentives to do so. Have no fear - there are other alternatives to stepping up to this challenge! For instance, we can just skip all the hassle of collecting expensive data, building appropriate models, and correctly interpreting results and, instead, use a magic 8-ball or a coin-flip algorithm to make inferences. After all, though unreliable and lacking any evidentiary value, such random methods might be <a href="https://www.americanscientist.org/article/the-statistical-crisis-in-science">less biased</a> than many statistical decision-making procedures. Or, if you do not want to risk subjecting your desired findings to the whims of chance, you could just <a href="https://www.forbes.com/sites/brianbushard/2023/01/10/fake-scientific-abstracts-written-by-chatgpt-fooled-scientists-study-finds/?sh=79ab703c18b6">ask ChatGPT to make up the results for you</a>!<sup>4</sup></p>
<p>If you have read this far, we think it is likely that you care about science, like to learn, and want to do careful work. If we are right, then please do not use <em>p</em>-values and significance stars to make inferences about interaction terms in generalized linear models with nonlinear link functions. Also, please do not use <em>p</em>-values and significance stars to make decisions about which variables to include as controls in your models. Rather, use theory to generate a plausible causal model (DAG), then choose which variables to include - and which variables to exclude - based on your estimand of interest and implications derived from your transparent causal model. Again, do not just take our word for it - listen to <a href="https://www.youtube.com/watch?v=uanZZLlzKHw">McElreath’s 2023 lecture</a> on good and bad controls. At around the 42:15 mark, he states:</p>
<blockquote class="blockquote">
<p>“There are lots of heuristics that are taught in the sciences for choosing control variables and unfortunately most of them are simply wrong and damaging. One of the approaches of course is to just add everything in the spreadsheet and see what’s significant. This is the YOLO strategy. There is no statistical framework that justifies this at all but it is a great way to get published because you can farm asterisks and publish them and leave a trail of damage through the scientific literature that can last for decades. Not the posterity we should aspire to.”</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/For_the_Better_Right2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">So you want your research to change the world - for the better, right?</figcaption>
</figure>
</div>
</section>
<section id="sec-surprise" class="level3">
<h3 class="anchored" data-anchor-id="sec-surprise">Selection biases are not always easy to predict</h3>
<p>Ok, let’s get back on track. So far, we have seen some evidence that selecting on felony status when collecting data might bias inferences about important substantive questions in criminology. First, a quick glance at bivariate correlations revealed that the magnitude of estimated gender differences in delinquency, self-control, moral beliefs, and even employment outcomes are substantially biased towards zero in the restricted felony sample. Second, a theoretically expected interaction between self-control and delinquency that exists in the general sample was not clearly observed in the felony sample.</p>
<p>Specifically, those with the strongest moral beliefs constraining delinquency (i.e., <code>LowMoral == 0</code>) are not expected to engage in delinquency and, therefore, self-control should be unimportant to (i.e., have no effect on) delinquency since there is little to no temptation to resist. This is exactly what we see in the general sample plot. However, in the felony sample plot, self-control is predicted to have a negative effect on delinquency of similar magnitude for respondents with strong (==0), average, and weak (+2SD) moral beliefs.</p>
<p>Note, too, that the truncated variation from selection bias did not simply result in attenuated effect estimates in the felony sample. In fact, the magnitude of the estimated average marginal effect of self-control on delinquency is upwardly biased in the felony sample. Below, we plot the average marginal effect (AME) of self-control on delinquency in both samples, alongside a plot of the predicted delinquency count at each value of self-control in both samples.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#marginal effect of self-control plots</span></span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot 1 - AME of self-control (on response) in both samples </span></span>
<span id="cb11-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#NEED TO EXTRACT &amp; CREATE PLOT</span></span>
<span id="cb11-5">ame_scpop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margins</span>(glm1a, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HighSC"</span>))</span>
<span id="cb11-6">ame_scpop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ame_scpop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Felonysamp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb11-8">)</span>
<span id="cb11-9">ame_scsamp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margins</span>(glm1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variables =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HighSC"</span>))</span>
<span id="cb11-10">ame_scsamp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ame_scsamp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb11-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Felonysamp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb11-12">)</span>
<span id="cb11-13"></span>
<span id="cb11-14">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(ame_scpop, ame_scsamp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Felonysamp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(Felonysamp))</span>
<span id="cb11-16"></span>
<span id="cb11-17">coefplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb11-18">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> AME, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(Felonysamp, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Felonysamp)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> lower, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> upper, </span>
<span id="cb11-19">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> Felonysamp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_pointrange</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dotted"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average Marginal Effect of Self-control"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span>
<span id="cb11-28"></span>
<span id="cb11-29"></span>
<span id="cb11-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plot 2 - predicted delinquency count by self-control in both samples </span></span>
<span id="cb11-31">plot_glm1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1a, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HighSC"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High self-control"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"General sample"</span>)  </span>
<span id="cb11-34"></span>
<span id="cb11-35">plot_glm1d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HighSC"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_colorblind</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High self-control"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Felony sample"</span>)    </span>
<span id="cb11-38"></span>
<span id="cb11-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot_glm1c + plot_glm1d + plot_layout(guides = 'collect')</span></span>
<span id="cb11-40"></span>
<span id="cb11-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Extract lineribbon data &amp; combine plots into one custom plot</span></span>
<span id="cb11-42"></span>
<span id="cb11-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create own plot instead of plot_model()</span></span>
<span id="cb11-44">plot_glm1cd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simpop, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>HighSC, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Felonysamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Felonysamp), </span>
<span id="cb11-46">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>plot_glm1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted), </span>
<span id="cb11-50">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>plot_glm1c<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>conf.high), </span>
<span id="cb11-52">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E69F00"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>plot_glm1d<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>predicted), </span>
<span id="cb11-54">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>plot_glm1d<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>conf.low, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>conf.high), </span>
<span id="cb11-56">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb11-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb11-60">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"High self-control"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>)</span>
<span id="cb11-62"></span>
<span id="cb11-63">coefplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm1cd </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This may be surprising to some of you. After all, it is quite common for researchers to incorrectly defend against charges of selection bias by claiming that, with truncated distributions, the documented associations are likely attenuated and hence conservative estimates. In fact, we have made such claims ourselves,<sup>5</sup> before we learned about collider bias and came to realize that predicting the nature, extent, or direction of bias is not always as simple as it may seem.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/looking_for.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Don’t use Jedi mind tricks. State causal assumptions (in a DAG), then identify your estimand and adjustment set.</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-ex2" class="level2">
<h2 class="anchored" data-anchor-id="sec-ex2">Example 2: Estimating noncausal effect of SES on delinquency</h2>
<p>Let’s move onto our second example, where we illustrate how improperly “controlling for” (i.e., conditioning on) a collider can bias causal estimation using our simulated general population and felony sample data. Here, we are estimating the noncausal effect of SES on delinquency. Of course, since our <a href="https://reluctantcriminologists.com/blog-posts/%5B5%5D/colliders#sec-DAG4">DAG</a> and simulations specified no such causal effect, we should expect a near-zero estimate for the coefficient.</p>
<p>Let’s start with a model that includes male and employment (i.e., QualityEmploy) as control variables Why? Well, because employment might be related to SES and to delinquency, and because everyone throws in demographic controls like sex, right? I know just said that this is <strong>not</strong> how one should select controls; however, in this example, we are trying to illustrate what might happen when people DO select controls in this way.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#generalized linear model, effect of SES on delinquency in pop, strat on employment </span></span>
<span id="cb12-2">glm2a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> QualityEmploy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simpop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(glm2a)</span></span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2a) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 2: Model 2a, General sample, Collider"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="cneanpaseg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cneanpaseg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cneanpaseg thead, #cneanpaseg tbody, #cneanpaseg tfoot, #cneanpaseg tr, #cneanpaseg td, #cneanpaseg th {
  border-style: none;
}

#cneanpaseg p {
  margin: 0;
  padding: 0;
}

#cneanpaseg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cneanpaseg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cneanpaseg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cneanpaseg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cneanpaseg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cneanpaseg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cneanpaseg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cneanpaseg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cneanpaseg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cneanpaseg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cneanpaseg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cneanpaseg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cneanpaseg .gt_spanner_row {
  border-bottom-style: hidden;
}

#cneanpaseg .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cneanpaseg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cneanpaseg .gt_from_md > :first-child {
  margin-top: 0;
}

#cneanpaseg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cneanpaseg .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cneanpaseg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cneanpaseg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cneanpaseg .gt_row_group_first td {
  border-top-width: 2px;
}

#cneanpaseg .gt_row_group_first th {
  border-top-width: 2px;
}

#cneanpaseg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cneanpaseg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cneanpaseg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cneanpaseg .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cneanpaseg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cneanpaseg .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cneanpaseg .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cneanpaseg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cneanpaseg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cneanpaseg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cneanpaseg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cneanpaseg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cneanpaseg .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#cneanpaseg .gt_left {
  text-align: left;
}

#cneanpaseg .gt_center {
  text-align: center;
}

#cneanpaseg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cneanpaseg .gt_font_normal {
  font-weight: normal;
}

#cneanpaseg .gt_font_bold {
  font-weight: bold;
}

#cneanpaseg .gt_font_italic {
  font-style: italic;
}

#cneanpaseg .gt_super {
  font-size: 65%;
}

#cneanpaseg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cneanpaseg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cneanpaseg .gt_indent_1 {
  text-indent: 5px;
}

#cneanpaseg .gt_indent_2 {
  text-indent: 10px;
}

#cneanpaseg .gt_indent_3 {
  text-indent: 15px;
}

#cneanpaseg .gt_indent_4 {
  text-indent: 20px;
}

#cneanpaseg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 2: Model 2a, General sample, Collider</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">-0.09***</td>
<td headers="std.error" class="gt_row gt_center">0.019</td>
<td headers="ci" class="gt_row gt_center">-0.13, -0.05</td>
<td headers="p.value" class="gt_row gt_center"> 1.82e-06</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.24***</td>
<td headers="std.error" class="gt_row gt_center">0.024</td>
<td headers="ci" class="gt_row gt_center">0.19, 0.29</td>
<td headers="p.value" class="gt_row gt_center"> 1.35e-23</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SES</td>
<td headers="estimate" class="gt_row gt_center">0.10***</td>
<td headers="std.error" class="gt_row gt_center">0.012</td>
<td headers="ci" class="gt_row gt_center">0.08, 0.12</td>
<td headers="p.value" class="gt_row gt_center"> 2.85e-17</td></tr>
    <tr><td headers="label" class="gt_row gt_left">QualityEmploy</td>
<td headers="estimate" class="gt_row gt_center">-0.22***</td>
<td headers="std.error" class="gt_row gt_center">0.008</td>
<td headers="ci" class="gt_row gt_center">-0.23, -0.20</td>
<td headers="p.value" class="gt_row gt_center">1.02e-171</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">plot_glm2a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm2a, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"General sample, Stratify on employ"</span>)  </span>
<span id="cb13-4">plot_glm2a</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Uh oh. We simulated data to have no (i.e., null or “0”) effect of SES on delinquency, but our model estimated a positive effect of SES on delinquency in the population. By now, it should be clear that this is caused by inappropriately conditioning on the collider employment QualityEmploy.</p>
<p>Why? Well, to risk overextending another analogy, think of your focal estimand (SES -&gt; delinquency) as your room and a collider (employment) as the rancor monster in your closet that, if left unattended, will destroy your room (bias your effect estimate). Adjusting for a collider risks opening the closet door - aka, “backdoor paths” in your model - and letting the monster out. So, you need to check your DAG to be sure that the closet door is closed (the collider paths are blocked) from the outset and, if the closet door is opened (by conditioning on a collider), then you need to identify an adjustment that will close the door (block the path) to stop the monster (biasing information) from escaping.</p>
<p>To add another layer of complexity, a closer look at our <a href="https://reluctantcriminologists.com/blog-posts/%5B5%5D/colliders#sec-DAG4">DAG</a> will reveal that the SES -&gt; Delinquency estimand is not the only potential relationship depicted for which adjusting for employment threatens to bias estimates due to conditioning on a collider. Below, we also briefly discuss nonfocal coefficients in our SES -&gt; delinquency models (e.g., for male and employment) to help illustrate how conditioning on a collider can wreak havok on an entire model and other relevant alternative models by opening backdoor paths and letting out biasing information. However, before we do this, we want to issue a strong cautionary plea:</p>
<p>Do not try this at home or, worse, in scientific papers. It is typically a bad idea to interpret nonfocal coefficients as if they are effect estimates for alternative estimands like we are doing in this section. We plan to explain why in more detail in a later post about the <a href="http://www.dagitty.net/learn/graphs/table2-fallacy.html">Table 2 fallacy</a>. Here, we know that our DAG accurately reflects the causal processes that generated our simulated data, so we have a better understanding of what is happening in our models than one typically would in real world data analytic contexts. If you really feel it is necessary, then use your DAG and specify the nonfocal variable as the exposure to identify whether the variables in the model sufficiently adjust for potential bias (more on this soon).</p>
<p>With that cautionary statement in place, we ill-advisedly point your attention to the negative coefficient for employment in the model above. We know this should not be there, since we did not specify a causal relationship between them in our DAG and, therefore, we did not simulate a causal relationship between them. In this case, the biased coefficient arises because both employment and delinquency “listen to” (in this case, are caused by) common mechanisms, namely moral beliefs and self-control (see <a href="http://bayes.cs.ucla.edu/WHY/">Pearl &amp; Mackenzie</a> for explanation &amp; more on the “listens to” metaphor).</p>
<p>In more specific terms, tracing employment to delinquency reveals confounding paths (forks) involving self-control and moral beliefs that are not blocked by the male or SES variables. For example:</p>
<ol type="1">
<li>Employment &lt;- Self-control -&gt; Delinquency</li>
<li>Employment &lt;- Moral beliefs -&gt; Delinquency</li>
<li>Employment &lt;- Prior felony &lt;- Self-control -&gt; Delinquency</li>
<li>Employment &lt;- Prior felony &lt;- Moral beliefs -&gt; Delinquency</li>
</ol>
<p>Of course, if we had not simulated the data ourselves or had a reliable DAG to communicate our causal assumptions - which is exactly the situation most researchers find themselves in - then we might simply assume that the SES and employment coefficients are accurate causal estimates and then proceed to tell a story about them in a paper for publication.</p>
<p>Scared yet? Face your fears, then be empowered to overcome them.</p>
<p>Now, let’s illustrate what happens if we remove employment, the collider in our SES -&gt; delinquency estimate, from our model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#generalized linear model, effect of SES on delinquency in pop, drop employment </span></span>
<span id="cb14-2">glm2b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simpop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(glm2b)</span></span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2b) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 2: Model 2b, General sample, No collider"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="anjemdhssl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#anjemdhssl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#anjemdhssl thead, #anjemdhssl tbody, #anjemdhssl tfoot, #anjemdhssl tr, #anjemdhssl td, #anjemdhssl th {
  border-style: none;
}

#anjemdhssl p {
  margin: 0;
  padding: 0;
}

#anjemdhssl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#anjemdhssl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#anjemdhssl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#anjemdhssl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#anjemdhssl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#anjemdhssl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anjemdhssl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#anjemdhssl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#anjemdhssl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#anjemdhssl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#anjemdhssl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#anjemdhssl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#anjemdhssl .gt_spanner_row {
  border-bottom-style: hidden;
}

#anjemdhssl .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#anjemdhssl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#anjemdhssl .gt_from_md > :first-child {
  margin-top: 0;
}

#anjemdhssl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#anjemdhssl .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#anjemdhssl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#anjemdhssl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#anjemdhssl .gt_row_group_first td {
  border-top-width: 2px;
}

#anjemdhssl .gt_row_group_first th {
  border-top-width: 2px;
}

#anjemdhssl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#anjemdhssl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#anjemdhssl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#anjemdhssl .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anjemdhssl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#anjemdhssl .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#anjemdhssl .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#anjemdhssl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#anjemdhssl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anjemdhssl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#anjemdhssl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#anjemdhssl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#anjemdhssl .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#anjemdhssl .gt_left {
  text-align: left;
}

#anjemdhssl .gt_center {
  text-align: center;
}

#anjemdhssl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#anjemdhssl .gt_font_normal {
  font-weight: normal;
}

#anjemdhssl .gt_font_bold {
  font-weight: bold;
}

#anjemdhssl .gt_font_italic {
  font-style: italic;
}

#anjemdhssl .gt_super {
  font-size: 65%;
}

#anjemdhssl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#anjemdhssl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#anjemdhssl .gt_indent_1 {
  text-indent: 5px;
}

#anjemdhssl .gt_indent_2 {
  text-indent: 10px;
}

#anjemdhssl .gt_indent_3 {
  text-indent: 15px;
}

#anjemdhssl .gt_indent_4 {
  text-indent: 20px;
}

#anjemdhssl .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 2: Model 2b, General sample, No collider</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">0.02</td>
<td headers="std.error" class="gt_row gt_center">0.018</td>
<td headers="ci" class="gt_row gt_center">-0.01, 0.06</td>
<td headers="p.value" class="gt_row gt_center">0.210</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.43***</td>
<td headers="std.error" class="gt_row gt_center">0.023</td>
<td headers="ci" class="gt_row gt_center">0.38, 0.47</td>
<td headers="p.value" class="gt_row gt_center">1.43e-77</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SES</td>
<td headers="estimate" class="gt_row gt_center">-0.01</td>
<td headers="std.error" class="gt_row gt_center">0.011</td>
<td headers="ci" class="gt_row gt_center">-0.03, 0.01</td>
<td headers="p.value" class="gt_row gt_center">0.515</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">plot_glm2b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm2b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"General sample, Drop collider"</span>)  </span>
<span id="cb15-4"></span>
<span id="cb15-5">plot_glm2a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm2b</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Our estimate of the causal effect of SES on delinquency is now near-zero and negligible, with zero falling well within the 95% confidence interval.</p>
<p>What would happen if we continue to condition on employment in our other simulated sample that also essentially conditions on felony status, or a key (simulated) cause of employment quality/status? Let’s re-estimate our two models using the simulated felony sample to see.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#generalized linear model, effect of SES on delinquency in pop, stratify employment </span></span>
<span id="cb16-2">glm2c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> QualityEmploy, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simsamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># regsum(glm2a) %&gt;%</span></span>
<span id="cb16-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   as_gt() %&gt;%</span></span>
<span id="cb16-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   gt::tab_header(title = "Example 2: Model 2a, General sample, with Collider")</span></span>
<span id="cb16-7"></span>
<span id="cb16-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2c) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 2: Model 2c, Felony sample, with Collider"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="azymxkhsts" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#azymxkhsts table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#azymxkhsts thead, #azymxkhsts tbody, #azymxkhsts tfoot, #azymxkhsts tr, #azymxkhsts td, #azymxkhsts th {
  border-style: none;
}

#azymxkhsts p {
  margin: 0;
  padding: 0;
}

#azymxkhsts .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#azymxkhsts .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#azymxkhsts .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#azymxkhsts .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#azymxkhsts .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#azymxkhsts .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#azymxkhsts .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#azymxkhsts .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#azymxkhsts .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#azymxkhsts .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#azymxkhsts .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#azymxkhsts .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#azymxkhsts .gt_spanner_row {
  border-bottom-style: hidden;
}

#azymxkhsts .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#azymxkhsts .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#azymxkhsts .gt_from_md > :first-child {
  margin-top: 0;
}

#azymxkhsts .gt_from_md > :last-child {
  margin-bottom: 0;
}

#azymxkhsts .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#azymxkhsts .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#azymxkhsts .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#azymxkhsts .gt_row_group_first td {
  border-top-width: 2px;
}

#azymxkhsts .gt_row_group_first th {
  border-top-width: 2px;
}

#azymxkhsts .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#azymxkhsts .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#azymxkhsts .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#azymxkhsts .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#azymxkhsts .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#azymxkhsts .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#azymxkhsts .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#azymxkhsts .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#azymxkhsts .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#azymxkhsts .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#azymxkhsts .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#azymxkhsts .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#azymxkhsts .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#azymxkhsts .gt_left {
  text-align: left;
}

#azymxkhsts .gt_center {
  text-align: center;
}

#azymxkhsts .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#azymxkhsts .gt_font_normal {
  font-weight: normal;
}

#azymxkhsts .gt_font_bold {
  font-weight: bold;
}

#azymxkhsts .gt_font_italic {
  font-style: italic;
}

#azymxkhsts .gt_super {
  font-size: 65%;
}

#azymxkhsts .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#azymxkhsts .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#azymxkhsts .gt_indent_1 {
  text-indent: 5px;
}

#azymxkhsts .gt_indent_2 {
  text-indent: 10px;
}

#azymxkhsts .gt_indent_3 {
  text-indent: 15px;
}

#azymxkhsts .gt_indent_4 {
  text-indent: 20px;
}

#azymxkhsts .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 2: Model 2c, Felony sample, with Collider</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">-0.03</td>
<td headers="std.error" class="gt_row gt_center">0.076</td>
<td headers="ci" class="gt_row gt_center">-0.18, 0.11</td>
<td headers="p.value" class="gt_row gt_center">0.666</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.17**</td>
<td headers="std.error" class="gt_row gt_center">0.062</td>
<td headers="ci" class="gt_row gt_center">0.05, 0.29</td>
<td headers="p.value" class="gt_row gt_center">0.006</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SES</td>
<td headers="estimate" class="gt_row gt_center">0.15***</td>
<td headers="std.error" class="gt_row gt_center">0.022</td>
<td headers="ci" class="gt_row gt_center">0.10, 0.19</td>
<td headers="p.value" class="gt_row gt_center">1.58e-11</td></tr>
    <tr><td headers="label" class="gt_row gt_left">QualityEmploy</td>
<td headers="estimate" class="gt_row gt_center">-0.22***</td>
<td headers="std.error" class="gt_row gt_center">0.018</td>
<td headers="ci" class="gt_row gt_center">-0.26, -0.19</td>
<td headers="p.value" class="gt_row gt_center">4.42e-37</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">plot_glm2c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm2c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Felony sample, Stratify on employ"</span>)  </span>
<span id="cb17-4"></span>
<span id="cb17-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#generalized linear model, effect of SES on delinquency in pop, drop collider </span></span>
<span id="cb17-6">glm2d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simsamp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb17-7"></span>
<span id="cb17-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 2: Model 2d, Felony sample, no Collider"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="lgznoejcgw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lgznoejcgw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lgznoejcgw thead, #lgznoejcgw tbody, #lgznoejcgw tfoot, #lgznoejcgw tr, #lgznoejcgw td, #lgznoejcgw th {
  border-style: none;
}

#lgznoejcgw p {
  margin: 0;
  padding: 0;
}

#lgznoejcgw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lgznoejcgw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lgznoejcgw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lgznoejcgw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lgznoejcgw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgznoejcgw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgznoejcgw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lgznoejcgw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lgznoejcgw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lgznoejcgw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lgznoejcgw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lgznoejcgw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lgznoejcgw .gt_spanner_row {
  border-bottom-style: hidden;
}

#lgznoejcgw .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lgznoejcgw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lgznoejcgw .gt_from_md > :first-child {
  margin-top: 0;
}

#lgznoejcgw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lgznoejcgw .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lgznoejcgw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lgznoejcgw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lgznoejcgw .gt_row_group_first td {
  border-top-width: 2px;
}

#lgznoejcgw .gt_row_group_first th {
  border-top-width: 2px;
}

#lgznoejcgw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgznoejcgw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lgznoejcgw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lgznoejcgw .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgznoejcgw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgznoejcgw .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lgznoejcgw .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lgznoejcgw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lgznoejcgw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lgznoejcgw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgznoejcgw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgznoejcgw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lgznoejcgw .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#lgznoejcgw .gt_left {
  text-align: left;
}

#lgznoejcgw .gt_center {
  text-align: center;
}

#lgznoejcgw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lgznoejcgw .gt_font_normal {
  font-weight: normal;
}

#lgznoejcgw .gt_font_bold {
  font-weight: bold;
}

#lgznoejcgw .gt_font_italic {
  font-style: italic;
}

#lgznoejcgw .gt_super {
  font-size: 65%;
}

#lgznoejcgw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lgznoejcgw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lgznoejcgw .gt_indent_1 {
  text-indent: 5px;
}

#lgznoejcgw .gt_indent_2 {
  text-indent: 10px;
}

#lgznoejcgw .gt_indent_3 {
  text-indent: 15px;
}

#lgznoejcgw .gt_indent_4 {
  text-indent: 20px;
}

#lgznoejcgw .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 2: Model 2d, Felony sample, no Collider</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">0.56***</td>
<td headers="std.error" class="gt_row gt_center">0.058</td>
<td headers="ci" class="gt_row gt_center">0.44, 0.67</td>
<td headers="p.value" class="gt_row gt_center">4.49e-22</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.17**</td>
<td headers="std.error" class="gt_row gt_center">0.062</td>
<td headers="ci" class="gt_row gt_center">0.05, 0.29</td>
<td headers="p.value" class="gt_row gt_center">0.005</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SES</td>
<td headers="estimate" class="gt_row gt_center">0.03</td>
<td headers="std.error" class="gt_row gt_center">0.020</td>
<td headers="ci" class="gt_row gt_center">-0.01, 0.07</td>
<td headers="p.value" class="gt_row gt_center">0.100</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">plot_glm2d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_model</span>(glm2d, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pred"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Felony sample, Drop collider"</span>)  </span>
<span id="cb18-4"></span>
<span id="cb18-5"></span>
<span id="cb18-6">(plot_glm2a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm2b) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (plot_glm2c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_glm2d)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When conditioning on a collider (employment), SES is incorrectly estimated to have a positive effect on delinquency in the simulated general sample and a positive effect of even larger magnitude on the outcome scale in the restricted felony sample.</p>
<p>What about those nonfocal estimates? Let’s plug our noses and check. First, employment has a sizeable negative coefficient in both the general and felony samples, despite a lack of causal connection or direct simulated correlation between them. A review of our DAG helps us understand why this is the case: again, we did not adjust for self-control and moral beliefs, two confounders of the employment/delinquency relationship. As such, these backdoor paths remain open, resulting in a biased estimate.</p>
<p>Finally, a large, positive coefficient for male on delinquency is observed in the general sample, whereas a smaller positive coefficient is observed in the felony sample. This is because, due to our DAG and simulation, being male is causally related to self-control and moral beliefs. Thus, in the general sample, being male has a positive association due to its unblocked <em>indirect</em> effects on delinquency through these mediators. In contrast, in the felony sample, we are letting biasing information from these indirect effects into our estimate of the <em>total</em> Male -&gt; delinquency effect by conditioning on a collider (e.g., felony).</p>
<p>Again, if you must interpret nonfocal estimates in your model, then we recommend specifying the nonfocal variable as the exposure and using your DAG (and a program like DAGitty) to trace the paths and identify sufficient adjustment sets to determine whether the coefficient might be biased in the model - which is likely, since you built the model to identify the causal effect of a different (i.e., the focal) variable.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/death_star.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Destroy collider bias with the force. Or, you know, with a DAG and a sufficient adjustment set.</figcaption>
</figure>
</div>
<section id="sec-clever" class="level3">
<h3 class="anchored" data-anchor-id="sec-clever">Avoid being clever with DAG adjustment sets</h3>
<p>Though this collider business may be new to many of us, we all learned in early statistics classes that one way to unbias an empirical estimate of a causal in observational research (i.e., without randomization) is by adjusting for confounders. Well, it turns out that we can often do that to mitigate collider bias as well!</p>
<p>One of the cool things about the DAG framework is that it follows systematic and logically coherent rules that, though perhaps daunting at first, can be learned and applied formulaically. In fact, given you commit to a particular model of the world and specify it in a DAG, you do not have to rely on being clever when deciding what to adjust for in your statistical models.<sup>6</sup></p>
<p>Specifically, for any theoretical estimand you want to empirically estimate from the data, you can start by designing your DAG with a program like “DAGitty” and identifying the exposure (cause) and outcome. Then, you can have the program automatically identify the various adjustment sets that would give you the unbiased estimate based on your theoretical model as specified in the DAG. The <a href="http://www.dagitty.net/manual-3.x.pdf">DAGitty User’s Manual</a> explains a sufficient adjustment set as:</p>
<blockquote class="blockquote">
<p>“a set of covariates such that adjustment, stratification, or selection (e.g.&nbsp;by restriction or matching) will minimize bias when estimating the causal effect of the exposure on the outcome (<strong>assuming that the causal assumptions encoded in the diagram hold</strong>)…. One can understand adjustment sets graphically… as a set [of covariates] that closes all biasing paths while keeping desired causal paths open…” (p.9, bold emphasis added)</p>
</blockquote>
<p>Let’s do that with our SES -&gt; Delinquency example above.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">collideDAG_adjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adjustmentSets</span>(collideDAG, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)</span>
<span id="cb19-2">collideDAG_adjust</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> {}
{ Male }
{ MoralBeliefs }
{ Male, MoralBeliefs }
{ PriorFelony }
{ Male, PriorFelony }
{ MoralBeliefs, PriorFelony }
{ Male, MoralBeliefs, PriorFelony }
{ SelfControl }
{ Male, SelfControl }
{ MoralBeliefs, SelfControl }
{ College, MoralBeliefs, SelfControl }
{ Male, MoralBeliefs, SelfControl }
{ College, Male, MoralBeliefs, SelfControl }
{ PriorFelony, SelfControl }
{ Male, PriorFelony, SelfControl }
{ MoralBeliefs, PriorFelony, SelfControl }
{ College, MoralBeliefs, PriorFelony, SelfControl }
{ Male, MoralBeliefs, PriorFelony, SelfControl }
{ College, Male, MoralBeliefs, PriorFelony, SelfControl }
{ Male, MoralBeliefs, QualityEmploy, SelfControl }
{ College, Male, MoralBeliefs, QualityEmploy, SelfControl }
{ MoralBeliefs, PriorFelony, QualityEmploy, SelfControl }
{ College, MoralBeliefs, PriorFelony, QualityEmploy, SelfControl }
{ Male, MoralBeliefs, PriorFelony, QualityEmploy, SelfControl }
{ College, Male, MoralBeliefs, PriorFelony, QualityEmploy, SelfControl
  }</code></pre>
</div>
</div>
<p>Above you see the various combinations of variables that you could include in your model to get an “unbiased” estimate of the total (non)effect of SES on delinquency based on the structural causal model described above. Note that there are a lot of valid adjustment sets in this case but none of these include just male and employment - the covariates in our model - as a sufficient adjustment set, which is why our earlier estimates were biased.</p>
<p>One of these sets does include adjusting only for male without employment in the model. In fact, you might be surprised to see that, in the case of the SES -&gt; Delinquency relationship, the minimal and arguably most sensible of the valid adjustment sets includes adjusting for nothing at all (“{}”)! There is an important lesson here: <strong>Depending on the DAG, it might be better to do quite literally nothing at all (i.e., include no control variables in a model) than to do the wrong thing (i.e., include bad controls).</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/notry.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption"><em>Try not</em> to control. Use your DAG, then control you <em>do.</em> <em>Or do not.</em> <em>There is no try</em>.</figcaption>
</figure>
</div>
<p>Interestingly, of the 26 identified adjustment sets for accurately estimating the total (null) effect of SES on delinquency, only six of them include the collider “QualityEmploy.” So, given you include “QualityEmploy” in your model, you would also have to adjust for one of the following sets of variables to accurately estimate the null noncausal effect from your statistical model:</p>
<ol start="21" type="1">
<li>{ Male, MoralBeliefs, QualityEmploy, SelfControl }</li>
<li>{ College, Male, MoralBeliefs, QualityEmploy, SelfControl }</li>
<li>{ MoralBeliefs, PriorFelony, QualityEmploy, SelfControl }</li>
<li>{ College, MoralBeliefs, PriorFelony, QualityEmploy, SelfControl }</li>
<li>{ Male, MoralBeliefs, PriorFelony, QualityEmploy, SelfControl }</li>
<li>{ College, Male, MoralBeliefs, PriorFelony, QualityEmploy, SelfControl }</li>
</ol>
<p>This might seem like a random list but it is actually generated using <a href="https://ftp.cs.ucla.edu/pub/stat_ser/r493.pdf">formulaic rules</a> for determining adjustment sets - that’s why a program like DAGitty can do it for us! For instance, in this particular case, the reason we would be better off controlling for nothing is because there are no forks (confounders) or pipes (mediators) between SES and delinquency - as we trace our way from SES to delinquency, we immediately encounter colliders.</p>
<p>Meanwhile, given this DAG and the SES -&gt; Delinquency estimand, we can basically control for any combination of variables that is not one of the two colliders to which SES is causally related (employment or college), as the rest are essentially superfluous controls for our estimand. However, if we do open a path by conditioning on a collider, then we have to block it with something else between the collider and the outcome.</p>
<p>So, given we decide to control for male and employment in our model, then there are four adjustment sets that include both male and employment that should effectively block the path we open by conditioning on a collider (employment). “College” isn’t in the simulated data - it is common to lack key variables in a DAG in real world data - so that leaves us with two adjustment sets that we could use to block the open collider path with the data at hand. Let’s estimate those models and confirm that we get the correct “null” estimate.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">glm2e <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> QualityEmploy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> LowMoral <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> HighSC, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simpop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb21-2"></span>
<span id="cb21-3">glm2f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> QualityEmploy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> LowMoral <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> HighSC <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Felony, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simpop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"poisson"</span>)</span>
<span id="cb21-4"></span>
<span id="cb21-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2e) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-7">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 2: Model 2e, General sample, Adj.Set #25"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="chbsmotnlq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#chbsmotnlq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#chbsmotnlq thead, #chbsmotnlq tbody, #chbsmotnlq tfoot, #chbsmotnlq tr, #chbsmotnlq td, #chbsmotnlq th {
  border-style: none;
}

#chbsmotnlq p {
  margin: 0;
  padding: 0;
}

#chbsmotnlq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#chbsmotnlq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#chbsmotnlq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#chbsmotnlq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#chbsmotnlq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chbsmotnlq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chbsmotnlq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chbsmotnlq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#chbsmotnlq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#chbsmotnlq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#chbsmotnlq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#chbsmotnlq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#chbsmotnlq .gt_spanner_row {
  border-bottom-style: hidden;
}

#chbsmotnlq .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#chbsmotnlq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#chbsmotnlq .gt_from_md > :first-child {
  margin-top: 0;
}

#chbsmotnlq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#chbsmotnlq .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#chbsmotnlq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#chbsmotnlq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#chbsmotnlq .gt_row_group_first td {
  border-top-width: 2px;
}

#chbsmotnlq .gt_row_group_first th {
  border-top-width: 2px;
}

#chbsmotnlq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#chbsmotnlq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#chbsmotnlq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#chbsmotnlq .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chbsmotnlq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#chbsmotnlq .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#chbsmotnlq .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#chbsmotnlq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#chbsmotnlq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chbsmotnlq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chbsmotnlq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#chbsmotnlq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chbsmotnlq .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#chbsmotnlq .gt_left {
  text-align: left;
}

#chbsmotnlq .gt_center {
  text-align: center;
}

#chbsmotnlq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#chbsmotnlq .gt_font_normal {
  font-weight: normal;
}

#chbsmotnlq .gt_font_bold {
  font-weight: bold;
}

#chbsmotnlq .gt_font_italic {
  font-style: italic;
}

#chbsmotnlq .gt_super {
  font-size: 65%;
}

#chbsmotnlq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#chbsmotnlq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#chbsmotnlq .gt_indent_1 {
  text-indent: 5px;
}

#chbsmotnlq .gt_indent_2 {
  text-indent: 10px;
}

#chbsmotnlq .gt_indent_3 {
  text-indent: 15px;
}

#chbsmotnlq .gt_indent_4 {
  text-indent: 20px;
}

#chbsmotnlq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 2: Model 2e, General sample, Adj.Set #25</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">-0.51***</td>
<td headers="std.error" class="gt_row gt_center">0.021</td>
<td headers="ci" class="gt_row gt_center">-0.55, -0.47</td>
<td headers="p.value" class="gt_row gt_center">2.77e-124</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.17***</td>
<td headers="std.error" class="gt_row gt_center">0.024</td>
<td headers="ci" class="gt_row gt_center">0.12, 0.21</td>
<td headers="p.value" class="gt_row gt_center"> 5.74e-12</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SES</td>
<td headers="estimate" class="gt_row gt_center">0.00</td>
<td headers="std.error" class="gt_row gt_center">0.012</td>
<td headers="ci" class="gt_row gt_center">-0.03, 0.02</td>
<td headers="p.value" class="gt_row gt_center">0.858</td></tr>
    <tr><td headers="label" class="gt_row gt_left">QualityEmploy</td>
<td headers="estimate" class="gt_row gt_center">-0.01</td>
<td headers="std.error" class="gt_row gt_center">0.009</td>
<td headers="ci" class="gt_row gt_center">-0.02, 0.01</td>
<td headers="p.value" class="gt_row gt_center">0.502</td></tr>
    <tr><td headers="label" class="gt_row gt_left">LowMoral</td>
<td headers="estimate" class="gt_row gt_center">0.51***</td>
<td headers="std.error" class="gt_row gt_center">0.010</td>
<td headers="ci" class="gt_row gt_center">0.48, 0.53</td>
<td headers="p.value" class="gt_row gt_center"> 0.00e+00</td></tr>
    <tr><td headers="label" class="gt_row gt_left">HighSC</td>
<td headers="estimate" class="gt_row gt_center">-0.25***</td>
<td headers="std.error" class="gt_row gt_center">0.012</td>
<td headers="ci" class="gt_row gt_center">-0.27, -0.22</td>
<td headers="p.value" class="gt_row gt_center"> 1.04e-95</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regsum</span>(glm2f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-3">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Example 2: Model 2f, General sample, Adj.Set #26"</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="vtmdokfxyi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vtmdokfxyi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vtmdokfxyi thead, #vtmdokfxyi tbody, #vtmdokfxyi tfoot, #vtmdokfxyi tr, #vtmdokfxyi td, #vtmdokfxyi th {
  border-style: none;
}

#vtmdokfxyi p {
  margin: 0;
  padding: 0;
}

#vtmdokfxyi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 13px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vtmdokfxyi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vtmdokfxyi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vtmdokfxyi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vtmdokfxyi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtmdokfxyi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtmdokfxyi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtmdokfxyi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vtmdokfxyi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vtmdokfxyi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vtmdokfxyi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vtmdokfxyi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vtmdokfxyi .gt_spanner_row {
  border-bottom-style: hidden;
}

#vtmdokfxyi .gt_group_heading {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vtmdokfxyi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vtmdokfxyi .gt_from_md > :first-child {
  margin-top: 0;
}

#vtmdokfxyi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vtmdokfxyi .gt_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vtmdokfxyi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vtmdokfxyi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vtmdokfxyi .gt_row_group_first td {
  border-top-width: 2px;
}

#vtmdokfxyi .gt_row_group_first th {
  border-top-width: 2px;
}

#vtmdokfxyi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtmdokfxyi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vtmdokfxyi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vtmdokfxyi .gt_last_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtmdokfxyi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtmdokfxyi .gt_first_grand_summary_row {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vtmdokfxyi .gt_last_grand_summary_row_top {
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vtmdokfxyi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vtmdokfxyi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtmdokfxyi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtmdokfxyi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtmdokfxyi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtmdokfxyi .gt_sourcenote {
  font-size: 90%;
  padding-top: 1px;
  padding-bottom: 1px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtmdokfxyi .gt_left {
  text-align: left;
}

#vtmdokfxyi .gt_center {
  text-align: center;
}

#vtmdokfxyi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vtmdokfxyi .gt_font_normal {
  font-weight: normal;
}

#vtmdokfxyi .gt_font_bold {
  font-weight: bold;
}

#vtmdokfxyi .gt_font_italic {
  font-style: italic;
}

#vtmdokfxyi .gt_super {
  font-size: 65%;
}

#vtmdokfxyi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vtmdokfxyi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vtmdokfxyi .gt_indent_1 {
  text-indent: 5px;
}

#vtmdokfxyi .gt_indent_2 {
  text-indent: 10px;
}

#vtmdokfxyi .gt_indent_3 {
  text-indent: 15px;
}

#vtmdokfxyi .gt_indent_4 {
  text-indent: 20px;
}

#vtmdokfxyi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Example 2: Model 2f, General sample, Adj.Set #26</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>log(IRR)</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1,2</sup></span>"><strong>log(IRR)</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1,2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>SE</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>SE</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">-0.51***</td>
<td headers="std.error" class="gt_row gt_center">0.022</td>
<td headers="ci" class="gt_row gt_center">-0.55, -0.47</td>
<td headers="p.value" class="gt_row gt_center">2.93e-123</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Male</td>
<td headers="estimate" class="gt_row gt_center">0.17***</td>
<td headers="std.error" class="gt_row gt_center">0.025</td>
<td headers="ci" class="gt_row gt_center">0.12, 0.22</td>
<td headers="p.value" class="gt_row gt_center"> 4.50e-11</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SES</td>
<td headers="estimate" class="gt_row gt_center">0.00</td>
<td headers="std.error" class="gt_row gt_center">0.013</td>
<td headers="ci" class="gt_row gt_center">-0.03, 0.02</td>
<td headers="p.value" class="gt_row gt_center">0.877</td></tr>
    <tr><td headers="label" class="gt_row gt_left">QualityEmploy</td>
<td headers="estimate" class="gt_row gt_center">-0.01</td>
<td headers="std.error" class="gt_row gt_center">0.011</td>
<td headers="ci" class="gt_row gt_center">-0.03, 0.02</td>
<td headers="p.value" class="gt_row gt_center">0.569</td></tr>
    <tr><td headers="label" class="gt_row gt_left">LowMoral</td>
<td headers="estimate" class="gt_row gt_center">0.51***</td>
<td headers="std.error" class="gt_row gt_center">0.010</td>
<td headers="ci" class="gt_row gt_center">0.48, 0.53</td>
<td headers="p.value" class="gt_row gt_center"> 0.00e+00</td></tr>
    <tr><td headers="label" class="gt_row gt_left">HighSC</td>
<td headers="estimate" class="gt_row gt_center">-0.25***</td>
<td headers="std.error" class="gt_row gt_center">0.012</td>
<td headers="ci" class="gt_row gt_center">-0.27, -0.22</td>
<td headers="p.value" class="gt_row gt_center"> 1.68e-95</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Felony</td>
<td headers="estimate" class="gt_row gt_center">0.00</td>
<td headers="std.error" class="gt_row gt_center">0.036</td>
<td headers="ci" class="gt_row gt_center">-0.07, 0.07</td>
<td headers="p.value" class="gt_row gt_center">0.951</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> *p&lt;0.05; **p&lt;0.01; ***p&lt;0.001</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> IRR = Incidence Rate Ratio, SE = Standard Error, CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>As you can see, these adjustment sets resulted in the same coefficient estimates and, more importantly, they removed the collider bias from our causal estimates! We have more to say about alternative models, variable selection, and <a href="https://academic.oup.com/aje/article/177/4/292/147738">Table 2 fallacy</a>, but it will have to wait for a later entry. For now, let’s move on to one last example of collider bias caused by sample selection in real data.</p>
</section>
</section>
<section id="sec-ex3" class="level2">
<h2 class="anchored" data-anchor-id="sec-ex3">Example 3: Conditioning on a collider through selection in real data</h2>
<p>For our final example, we present results of an analysis of pilot survey data collected to explore the relationship between volunteering, moral behaviors, and moral attitudes in two samples: a university student sample (<em>n</em>=152 valid responses), and a similarly aged sample of respondents recruited online through Amazon Mechanical Turk (<em>n</em>=164 valid responses). Data collection was conducted by <a href="https://criminaljustice.indiana.edu/about/faculty/northcutt-bohmert-miriam.html">Miriam Northcutt Bohmert</a> (Principal Investigator) in collaboration with <a href="https://education.indiana.edu/about/directory/profiles/ochoa-theresa-a.html">Theresa Ochoa</a> and Jon Brauer. We owe a special thanks to Miriam Northcutt Bohmert for granting us permission to use the data for this post, as well as to Indiana University’s <a href="https://research.iu.edu/funding-proposals/funding/opportunities/social-sciences/index.html">Social Science Research Funding Program</a> for financially supporting the data collection.</p>
<p>In this example, we focus solely on a basic bivariate association: the relationship between moral beliefs and delinquent (criminal) behavior. Self-reported measures of one’s moral beliefs about crime are among the strongest and most consistent correlates of criminal behavior. Hence, we would expect to see similarly strong correlations in both the MTurk and university samples. Failure to see such correlations might raise concerns about the data.</p>
<p>In particular, we anticipate that selection into the University sample might introduce collider biases for estimates of various causal estimands of interest to criminologists. Of course, we communicated this expectation in our initial DAG used to simulate data, which we present again for convenience (see Figure 7 below).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">collideDAGalt2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagify</span>(</span>
<span id="cb23-2">  Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl,</span>
<span id="cb23-3">  PriorFelony <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl, </span>
<span id="cb23-4">  MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male, </span>
<span id="cb23-5">  SelfControl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Male,</span>
<span id="cb23-6">  College <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES, </span>
<span id="cb23-7">  QualityEmploy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> MoralBeliefs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SelfControl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> College <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> PriorFelony, </span>
<span id="cb23-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exposure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MoralBeliefs"</span>,</span>
<span id="cb23-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb23-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb23-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PriorFelony=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">QualityEmploy=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SelfControl=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Male=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb23-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MoralBeliefs=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">College=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb23-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PriorFelony=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SelfControl=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">QualityEmploy=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Male=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb23-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">MoralBeliefs=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">College=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb23-15">  )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy_dagitty</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb23-16">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collider =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PriorFelony"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"QualityEmploy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"College"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>))</span>
<span id="cb23-17"></span>
<span id="cb23-18"></span>
<span id="cb23-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#function to shorten arrows - set percentage to shorten</span></span>
<span id="cb23-20">collideDAGalt2p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shorten_dag_arrows</span>(collideDAGalt2, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>)</span>
<span id="cb23-21"></span>
<span id="cb23-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#create factor variable to isolate edge of interest, permits specifying edge color</span></span>
<span id="cb23-23">testdat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> collideDAGalt2p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb23-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">myedge1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(collideDAGalt2p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MoralBeliefs"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> collideDAGaltp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>to <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>,</span>
<span id="cb23-25">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no"</span>)</span>
<span id="cb23-26">  ) </span>
<span id="cb23-27"></span>
<span id="cb23-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#try filtering plot data for only edge of interest &amp; adding colored layer?</span></span>
<span id="cb23-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggraph)</span>
<span id="cb23-30">collideDAGalt2p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> testdat2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span>xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span>yend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_edges</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xstart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ystart, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color=</span>myedge1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dag_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Attend</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">College"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"   Delinquency"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moral</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Beliefs"</span>,</span>
<span id="cb23-33">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prior</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Felony"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Quality</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Employ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Self-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Control"</span>), </span>
<span id="cb23-34">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> collider)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add labels</span></span>
<span id="cb23-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_dag_label_repel(</span></span>
<span id="cb23-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   aes(label=collideDAGalt$data$label), </span></span>
<span id="cb23-37">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       # fill="green",</span></span>
<span id="cb23-38">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       show.legend = FALSE) + </span></span>
<span id="cb23-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_dag</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb23-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge_color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC79A7"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_edge_colour_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change second color to highlight focal myedge1 </span></span>
<span id="cb23-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change default expansion on y-axis min &amp; max</span></span>
<span id="cb23-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data-generating DAG"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb23-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb23-47"></span>
<span id="cb23-48">collideDAGalt2p2</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/DAG5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 7. Causal diagram (DAG), highlighting Example 3 estimand</figcaption>
</figure>
</div>
</div>
</div>
<p>For our purposes here, note that we are assuming the MTurk sample is more akin to a “general” sample that is not subject to the same collider biases for our estimand and, as such, it provides a useful point of comparison for visualizing the extent of the problem. However, we recognize this is a <a href="https://link.springer.com/article/10.1007/s10940-019-09436-7">strong assumption</a> that <a href="https://journals.sagepub.com/doi/abs/10.1177/0011128720977439?journalCode=cadc">may be untenable for many research questions</a>; likewise, consider that any differences we see between these two samples may be distorting the true extent to which collider biases are affecting our estimates.</p>
<p>Important caveats aside, let’s get to the results. Below, we skip the coefficient tables this time and instead jump straight to prediction plots in the outcome scale (like our previous plots). These plots are visualizations of posterior estimates generated by Bayesian bivariate negative binomial regression models predicting a criminal behavior variety index in each sample (integer counts ranging from <em>min</em>=0 to <em>max</em>=11).<sup>7</sup></p>
<p>We start by presenting sample-specific results in separate plots.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Restore RDS data to object</span></span>
<span id="cb24-2">dat.mturk.epred <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blog-posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[5]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dat_mturk.rds"</span>))</span>
<span id="cb24-3">dat.univ.epred <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blog-posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[5]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dat_univ.rds"</span>))</span>
<span id="cb24-4">dat.ssrfp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blog-posts"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[5]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dat_ssrfp.rds"</span>)) </span>
<span id="cb24-5"></span>
<span id="cb24-6"></span>
<span id="cb24-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Figure 3A: Pile of lines &amp; Shaded 95CI Plot, CrmBehavVI by zMoralBlfIRT, mturk only</span></span>
<span id="cb24-8">fig3a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat.ssrfp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> zMoralBlfIRT, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>CrmBehavVI)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.mturk.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> .draw), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.mturk.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.mturk.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(dat.ssrfp, mturk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Greens"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Criminal Behaviors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb24-19">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-20">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3A. Posterior Fitted Curves, MTurk"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb24-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>))</span>
<span id="cb24-25"></span>
<span id="cb24-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Figure 3B: Pile of lines &amp; Shaded 95CI Plot, CrmBehavVI by zMoralBlfIRT, univ onlydat.univ %&gt;%</span></span>
<span id="cb24-27">fig3b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat.ssrfp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> zMoralBlfIRT, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>CrmBehavVI)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.univ.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> .draw), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.univ.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.univ.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(dat.ssrfp, mturk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Criminal Behaviors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb24-38">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-39">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3B. Posterior Fitted Curves, University"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb24-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>))</span>
<span id="cb24-44"></span>
<span id="cb24-45">fig3a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> fig3b </span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In case it is easier to visualize the selection thresholds, we also overlay both plots on the same grid below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">fig3c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat.ssrfp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> zMoralBlfIRT, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>CrmBehavVI)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_line(data=dat.mturk.epred, aes(y = .epred, group = .draw), alpha = 0.5, color="grey60") +</span></span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.mturk.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.mturk.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(dat.ssrfp, mturk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># scale_fill_brewer(palette="Greens") + </span></span>
<span id="cb25-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geom_line(data=dat.univ.epred, aes(y = .epred, group = .draw), alpha = 0.5, color="grey60") +</span></span>
<span id="cb25-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.univ.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dat.univ.epred, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgrey"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(dat.ssrfp, mturk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># scale_fill_brewer() + </span></span>
<span id="cb25-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Strong Moral Beliefs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Criminal Behaviors"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb25-17">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-18">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3C. Posterior Fitted Curves, MTurk + University"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb25-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"serif"</span>))</span>
<span id="cb25-23"></span>
<span id="cb25-24">fig3c</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, what is happening here? Well, if our DAG is correct, then we conditioned on a collider when selecting a sample of university students to survey about moral beliefs and crime.</p>
<p>Let’s check our sufficient adjustment sets.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">collideDAG_adjust2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">adjustmentSets</span>(collideDAG, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MoralBeliefs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all"</span>)</span>
<span id="cb26-2">collideDAG_adjust2</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{ Male }
{ Male, SES }
{ Male, SelfControl }
{ College, Male, SelfControl }
{ Male, PriorFelony, SelfControl }
{ College, Male, PriorFelony, SelfControl }
{ Male, QualityEmploy, SelfControl }
{ College, Male, QualityEmploy, SelfControl }
{ Male, PriorFelony, QualityEmploy, SelfControl }
{ College, Male, PriorFelony, QualityEmploy, SelfControl }
{ Male, SES, SelfControl }
{ College, Male, SES, SelfControl }
{ Male, PriorFelony, SES, SelfControl }
{ College, Male, PriorFelony, SES, SelfControl }
{ Male, QualityEmploy, SES, SelfControl }
{ College, Male, QualityEmploy, SES, SelfControl }
{ Male, PriorFelony, QualityEmploy, SES, SelfControl }
{ College, Male, PriorFelony, QualityEmploy, SES, SelfControl }</code></pre>
</div>
</div>
<p>Again assuming our DAG is correct, then the first thing to note is that a bivariate model is insufficient for estimating the causal effect of moral beliefs on delinquency (or criminal behavior). At the very least, we need to adjust for Male sex to remove its potential confounding bias.</p>
<p>Next, notice that a single adjustment for College is not listed among the sufficient adjustment sets. Given we condition on College, then at the very least we would also need to remove the confounding bias of Male sex and adjust for Self-control to block the path we opened that allowed the collider College to bias our causal estimate.</p>
<p>In this case, though, model-based adjustments are unlikely to help us very much. After all, we did not simply condition on the collider College by adding it as a “bad control” in our regression model. Rather, we systematically selected out observations from our data through our sampling design. Adding in the appropriate model-based adjustments will not magically make those truncated observations appear in our data. So, what do we do now?</p>
<p>Well, fellow Jedi Padawan Scientists, we heed the advice of OG Jedi Master Yoda: <strong>“Mind what you have learned. Save you it can.”</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[5]/mindwhatlearned.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Mind what you have learned. Save you it can.</figcaption>
</figure>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If you traced all the paths from X to Y and applied the general definition of a collider that we provided above, then you might have noticed the mediator <em>M</em> is also a collider in the Example 3 DAG.↩︎</p></li>
<li id="fn2"><p>Note we are not saying here that you should <a href="https://www.nature.com/articles/d41586-019-00857-9">abandon statistical significance</a> altogether. That is a different issue, albeit one with which <a href="https://journals.sagepub.com/doi/10.1177/0049124119826158?icid=int.sj-abstract.citing-articles.72">we strongly sympathize</a>. However, we also recognize the <a href="https://link.springer.com/article/10.1007/s11229-022-03692-0">error control utility of significance testing</a> given specific circumstances, such as transparent theoretical assumptions about data generating processes, a precise hypothesis, and an appropriate research design. Perhaps we can try to tackle these issues in a future blog post…↩︎</p></li>
<li id="fn3"><p>In <a href="https://www.google.com/books/edition/The_Nurture_Assumption/-uKBJRMJBjcC?hl=en&amp;gbpv=1&amp;bsq=psychoastronomy"><em>The Nurture Assumption</em> (footnote, p.18)</a>, Judith Rich Harris cleverly describes this process as follows: “The significant correlations are easy to spot, nicely marked with asterisks by the statistics software. It’s a technique known as ‘psychoastronomy’: looking for the stars.”↩︎</p></li>
<li id="fn4"><p>Liability caveat: If it is not obvious to all, we are being facetious here. Do learn new things. Do not waste scientific resources on data and then subject them to methods that routinely deliver unreliable, random, or biased inferences. Do not make up data yourself, and do not have an ever-expanding super-intelligent AI overlord do it for you.↩︎</p></li>
<li id="fn5"><p>For example, Jake is guilty of this type of claim in his published work on race inequality in the college football coaching profession (see <a href="https://doi.org/10.1177/0730888415580651">Day, 2015</a>). To offer what is in hindsight an embarrassing quote: “…given that Black coaches are more likely to leave the profession, by examining predictors of racial differences in promotions to executive positions <em>(in retrospective data)</em>, the present study offers a conservative test of the relationship between job-level, task-based,segregation and racial disparities in career outcomes (pg. 435).” To again paraphrase <a href="https://twitter.com/rlmcelreath/status/1330092043553681412?s=20">Richard McElreath</a>], upon learning about DAGs, collider bias, and a host of other issues, I have often found myself experiencing “a profound sense of regret for (my) previous analyses.”↩︎</p></li>
<li id="fn6"><p>“Avoid being clever” is another McElreath motto. You’re probably picking up on a pattern with all of our McElreath references. Seriously, do yourself a favor and read his book and watch his lectures.↩︎</p></li>
<li id="fn7"><p>Strong moral beliefs is measured as a standardized item response theory (IRT) score scale. It is similar to measures found in existing criminological literature and, like our simulated moral beliefs variable above, is assumed to capture an underlying latent continuous dimension theoretically ranging from endorsement of strong pro-crime moral beliefs (<em>min</em>=-3.84) to strong anti-crime moral beliefs (<em>max</em>=1.18). We also specify weakly informative priors for the <em>beta</em> coefficient; we hope to write more about specification of prior distributions in such models in a later post.↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer and jake day2023,
  author = {Brauer and Jake Day, Jon},
  title = {Are You Afraid of Colliders?},
  date = {2023-06-06},
  url = {https://www.reluctantcriminologists.com/blog-posts/[5]/colliders.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer and jake day2023" class="csl-entry quarto-appendix-citeas">
Brauer and Jake Day, Jon. 2023. <span>“Are You Afraid of
Colliders?”</span> June 6, 2023. <a href="https://www.reluctantcriminologists.com/blog-posts/[5]/colliders.html">https://www.reluctantcriminologists.com/blog-posts/[5]/colliders.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <category>rstats</category>
  <category>causality</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[5]/colliders.html</guid>
  <pubDate>Tue, 06 Jun 2023 04:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[5]/rancor.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Causation without Correlation?</title>
  <dc:creator>Jon Brauer</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/empty-egg-dag3.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Empty Easter egg, or countervailing causation?</figcaption>
</figure>
</div>
<section id="sec-ladder" class="level2">
<h2 class="anchored" data-anchor-id="sec-ladder">Thinking up the ladder of causation</h2>
<p>I have taught a version of my undergraduate introductory course on theories of crime and deviance (CJUS-P 200 at <a href="https://criminaljustice.indiana.edu/index.html">Indiana University</a>) nearly every semester for the past 15 years and across three different universities. In each of those courses, my second lecture has always been devoted to teaching <em>principles of causality</em>.</p>
<p>I start that segment with a thought question and class discussion about what it means to say that something “causes” something else. Most of the time, students start with correlational descriptions of causality, such as “X causes Y means that when X changes, Y tends to change.” Such answers are what <a href="http://bayes.cs.ucla.edu/WHY/">Pearl &amp; Mackenzie</a> refer to as a “rung one” observation on the <a href="https://blogs.kcl.ac.uk/behaviouralinsights/2020/07/07/why-you-should-read-the-book-of-why/">ladder of causation</a>. In contrast, it is much rarer for students to intuit with minimal prompting a <a href="https://engineeringideas.substack.com/i/47016069/counterfactuals">counterfactual</a> or “rung three” description of causality, such as “if X caused Y, then Y might not have changed if X had not changed.”</p>
<p>At first glance, this may be a bit unexpected. We seem to engage in counterfactual thinking naturally, as it appears central to <a href="https://plato.stanford.edu/entries/counterfactuals/">imagination and rational agency</a>. Pearl and Mackenzie go so far as to claim that the ability to use counterfactual thinking to make “explanation-seeking inferences reliably and repeatably” is what “most distinguishes human from animal intelligence, as well as from model-blind versions of AI and machine learning” (<a href="https://www.basicbooks.com/titles/judea-pearl/the-book-of-why/9780465097616/">2018</a>, p.33). Moreover, the belief that randomization in controlled experiments offers a valid mechanism for making causal inferences relies upon counterfactual reasoning about potential outcomes; these counterfactual justifications underlying classical statistics were proposed by pioneers Jersey Neyman and Sir Ronald Fisher <a href="https://www.cambridge.org/core/books/abs/causal-inference-for-statistics-social-and-biomedical-sciences/brief-history-of-the-potential-outcomes-approach-to-causal-inference/B8CEDDC08F0E0D6C577847F0CBE4E6A3">a century ago</a>! Meanwhile, principled counterfactual frameworks using potential outcomes to make causal inferences with observational data have been in use <a href="https://en.wikipedia.org/wiki/Rubin_causal_model">since the 1970s</a> and represent arguably <a href="https://jech.bmj.com/content/76/11/960">the best approach to causal identification with observational data today</a>.</p>
<p>Yet, counterfactuals also <a href="https://www.inference.vc/causal-inference-3-counterfactuals/">are weird and can be difficult to comprehend</a>, particularly when using formal statistical notation. So, I still start with a discussion of the three basic criteria for establishing causal claims found in most sociology and criminology textbooks (correlation; nonspuriousness; temporal order). From there, I very briefly introduce students to some more advanced ideas, such as simple versus complex causality, causal chains, causal mechanisms and mediation, effect heterogeneity and moderation, and, of course, counterfactual causality. In doing so, I often tell students that, while they might know that correlation does not necessarily imply causation, they may be surprised to learn that <strong>causation may exist even in the absence of observed correlation</strong>.</p>
</section>
<section id="sec-reasons" class="level2">
<h2 class="anchored" data-anchor-id="sec-reasons">Causation without correlation</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/DALL-E_pop_art_style_portrait_painting_of_someone_very_confused3.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Pop art portrait of someone very confused, by DALL-E</figcaption>
</figure>
</div>
<p>To say students are surprised by this claim is an understatement - many seem confused or downright skeptical when I state it. After all, didn’t we just discuss how a basic criteria for establishing that X causes Y is <em>observing a correlation</em> between X and Y? Anticipating this confusion, I provide an example involving multiple mediation.</p>
<p>In fact, there are a number of reasons why two variables, X &amp; Y, can be causally related despite the lack of an observed bivariate or conditional (partial) correlation between them that have nothing to do with multiple mediation. Many of these reasons involve a <em>failure to detect</em> a correlation where one is expected to exist due to an existing causal relationship (notice the counterfactual reasoning again?). Examples include poor measurement and insufficient statistical power of a test to detect an effect, or improper modeling of <a href="https://qr.ae/pvj4pD">nonlinear (e.g., parabolic) functional relationships</a>, or <a href="https://www.christopherspenn.com/2018/08/can-causation-exist-without-correlation/">sample selection bias</a>. Interestingly, it is possible to fail to observe a correlation between two variables even when in situations where there is nearly perfect functional causality (<a href="https://theincidentaleconomist.com/wordpress/causation-without-correlation-is-possible/">see advanced example at end here</a>).</p>
<p>While it is certainly important to understand how and why we might sometimes fail to statistically detect a correlation between X &amp; Y where one might be causally expected, the example I use draws from a different situation in which one <em>would not even expect the existence of a statistical correlation</em> between X &amp; Y even with precise measurement, sufficient power, careful sampling, and so on, and despite a reasonable belief in the existence of causal processes or mechanisms connecting X &amp; Y. Examples of this situation might include counteracting direct and indirect effects or multiple countervailing mediators.</p>
<p>The statistical literature on mediation was particularly formative for my thinking on this topic. For example, consider the following excerpt from <a href="https://www.ln.edu.hk/mkt/staff/gcui/Hayes2009.pdf">Andrew Hayes’ (2009, p.413)</a> article, <em>Beyond Baron &amp; Kenny: Statistical Mediation Analysis in the New Millennium</em>, which was published around the time I first started teaching my theories of crime course and in the same year that I published <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1745-9125.2009.00164.x">my very first article</a>, which included a “test” of a mediation hypothesis using the old school <a href="https://davidakenny.net/cm/mediate.htm#BK">Baron &amp; Kenny method</a>:</p>
<blockquote class="blockquote">
<p>Can Effects that Don’t Exist be ‘Mediated’?<br>
<br> If a mediator is a variable, M, that is causally between X and Y and that <em>accounts at least in part for the association between X and Y</em>, then by definition X and Y must be associated in order for M to be a mediator of that effect. According to this logic, if there is no evidence that X affects Y, then how can X’s effect on Y be mediated and so what is the point of estimating indirect and direct effects? But it is possible for M to be causally between X and Y even if X and Y aren’t associated. In this case, some prefer to avoid the term <em>mediator</em> when describing M and instead refer simply to X’s indirect effect on Y through M…<br>
<br> The distinction between mediation and indirect effect is not always made by users of the Baron and Kenny method, who may prematurely end the hunt for evidence of indirect effects if there is no evidence that X and Y are associated. If the size of <em>c</em> [path coefficients] constrained the size of <em>a</em> and <em>b</em> and therefore their product, this logic would make sense. Unfortunately, no such constraints exist, and it is easy to show that the claim that X can’t affect Y indirectly in the absence of a detectable total effect is false.</p>
</blockquote>
<p>In this excerpt, Hayes first expresses the common sentiment that X &amp; Y must be correlated if they are causally connected through a mediator, then proceeds to inform us that this view has been debunked as a myth. Yet, despite this being a well-established fact in the mediation/indirect effect literature for many years, I was surprised to find very few accessible examples online to which I could point students and colleagues for a more detailed illustration of the type of situation I regularly describe to them. So, I did what any nerd who recently learned R would do - I simulated some data to help my students better visualize an example. Then, I thought that others also might be uninformed or confused about the issue, and here we are.</p>
</section>
<section id="sec-ai" class="level2">
<h2 class="anchored" data-anchor-id="sec-ai">AI to the rescue?</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/DALL-E_person_climbing_mountain_to_seek_wisdom_from_computer_cartoon3.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Cartoon person seeking wisdom from a computer oracle, by DALL-E</figcaption>
</figure>
</div>
<p>Before transforming my simulation example for students into a blog entry, I sought the wisdom of the artificial intelligence oracle <a href="https://openai.com/blog/chatgpt">ChatGPT</a>, thinking it might lead me to existing examples that I was missing. I realize that, at present, ChatGPT is not particularly <a href="https://medium.com/@vanillaxiangshuyang/let-us-talk-about-chatgpt-b4be68dd0da">well-suited for causal reasoning</a>, as <a href="https://twitter.com/yudapearl/status/1642780699953627137?s=20">Pearl himself has documented</a> and the AI oracle itself <a href="https://twitter.com/yudapearl/status/1641386266595033088?s=20">has humbly admitted</a>, though it also notes some ability to <a href="https://twitter.com/DrJimFan/status/1641111697971884034?s=20">extract, mimic, or make guesses from data containing information about causal relations</a>. Nonetheless, I asked the oracle: “Is it possible to have causation without correlation?”</p>
<p>For those interested in such things, I have included the full conversation with ChatGPT in the expandable link below.</p>
<details>
<summary>
Conversation with ChatGPT (4/5/2023, 12:20am)
</summary>
<style>
div.magma { background-color:#fddc9e80; border-radius: 5px; padding: 20px;}
</style>
<style>
div.limey { background-color:#d1e18980; border-radius: 5px; padding: 20px;}
</style>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> Is it possible to have causation without correlation?</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> Yes, it is possible to have causation without correlation. While causation and correlation are often related, they are not the same thing.</p>
<p>Correlation refers to a statistical relationship between two variables, where a change in one variable tends to be associated with a change in the other variable. However, correlation does not necessarily imply causation, because there could be other factors at play that influence both variables. For example, there is a correlation between the number of ice cream cones sold and the number of drownings each year, but this does not mean that ice cream causes drownings.</p>
<p>Causation, on the other hand, refers to a relationship where one event (the cause) brings about another event (the effect). A causal relationship can exist even if there is no correlation between the two variables, because the relationship is not dependent on a statistical pattern. For example, smoking causes lung cancer, but not everyone who smokes gets lung cancer, and not everyone with lung cancer smokes.</p>
<p>In summary, while correlation and causation are often linked, they are not the same thing, and it is possible to have causation without correlation.</p>
</div>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> In your smoking example, if smoking causes lung cancer, wouldn’t there also be a statistical relationship (i.e., a correlation) between smoking and lung cancer? The statement that “not everyone who smokes gets lung cancer, and not everyone with lung cancer smokes” does not rule out the possibility (or the likelihood) of a statistical relationship - it only rules out the possibility of a perfect correlation.</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> You are correct that in the case of smoking causing lung cancer, there is typically a statistical relationship (i.e., a correlation) between smoking and lung cancer. In fact, smoking is one of the strongest risk factors for developing lung cancer, and studies have consistently shown a strong correlation between smoking and lung cancer.</p>
<p>My previous statement about not everyone who smokes getting lung cancer and not everyone with lung cancer smoking was intended to highlight the fact that while there is a strong correlation between smoking and lung cancer, it is not a perfect correlation. In other words, there are some people who smoke and do not develop lung cancer, and there are some people who develop lung cancer even though they have never smoked.</p>
<p>So while a correlation between smoking and lung cancer does exist, it is not a one-to-one relationship, and it is possible for some smokers to avoid lung cancer and for some non-smokers to develop lung cancer. However, this does not negate the fact that smoking is a significant risk factor for developing lung cancer, and the statistical relationship between the two remains strong.</p>
</div>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> Yes, but the question was whether it is possible to have causation without correlation. You gave an example of causation with correlation.</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> You are correct, my apologies for any confusion. The smoking example I gave was indeed an example of causation with correlation.</p>
<p>To provide an example of causation without correlation, imagine a scenario where a scientist discovers that a specific gene mutation causes a rare disease that affects only a small portion of the population. In this case, there may not be a statistical relationship or correlation between the gene mutation and the disease in the general population, because the disease is so rare and the gene mutation is only found in a small portion of the population. However, there is a clear causal relationship between the gene mutation and the disease.</p>
<p>So, to answer the original question more accurately, it is possible to have causation without a statistically significant correlation between the two variables in the general population, as in the rare disease example described above.</p>
</div>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> In that example, again, there is a correlation between the gene mutation and the disease. I did not ask about whether there could be causation without a statistically significant correlation - statistical significance depends on power of the test. So, in this causal example, if you had a sufficiently large sample, the correlation would also be detected, making it another example of causation with correlation.</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> You are correct, and I apologize for the confusion. In the scenario I described, there is indeed a correlation between the gene mutation and the rare disease, even though it may not be statistically significant in the general population due to the low prevalence of the disease.</p>
<p>It is true that statistical significance depends on the power of the test and the sample size, and it is possible that a correlation between two variables could become statistically significant with a larger sample size. Therefore, in this case, with a larger sample size, the correlation between the gene mutation and the rare disease would likely be detected, and it would be an example of causation with correlation.</p>
<p>Thank you for pointing out this mistake in my previous responses, and I hope this clarification is helpful.</p>
</div>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> So, can you think of another example of causation without correlation that does not involve an insufficiently powered test for detecting correlation?</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> Yes, I can provide another example of causation without correlation that does not involve an insufficiently powered test for detecting correlation.</p>
<p>Consider the example of a person who takes a medication that causes a significant reduction in their symptoms of a medical condition. In this case, there is a clear causal relationship between taking the medication and the improvement in symptoms, but there may not be a statistical correlation between the two variables in the general population.</p>
<p>This lack of correlation could be due to a number of factors, such as individual differences in the severity or type of the medical condition, or differences in the dosage or timing of the medication. Additionally, the relationship between the medication and the symptoms could be confounded by other factors, such as the person’s diet, exercise habits, or stress levels.</p>
<p>So, in this scenario, while there may not be a statistically significant correlation between taking the medication and the improvement in symptoms in the general population, there is a clear causal relationship between the two variables in the individual person who experienced the improvement in symptoms.</p>
</div>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> This example again leverages a lack of statistical significance, which I am unmoved by such arguments. For instance, here, there is causation and likely correlation - but the correlation is not detectable due to improper modeling due to issues like heterogeneity in the strength of the effect, confounding, poor measurement, or inadequately specifying dosage and time. Can you think of any other examples that are different from these?</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> Thank you for the feedback and clarification. I will provide another example of causation without correlation that is different from the previous examples.</p>
<p>Consider the example of a person who develops a fear of flying after experiencing a traumatic event on a plane, such as severe turbulence or an emergency landing. In this case, the traumatic event on the plane is the direct cause of the person’s fear of flying.</p>
<p>However, there may not be a statistical correlation between traumatic events on planes and the development of a fear of flying in the general population. This is because not everyone who experiences a traumatic event on a plane will develop a fear of flying, and some people may develop a fear of flying for other reasons unrelated to traumatic events.</p>
<p>Therefore, in this scenario, there is a clear causal relationship between the traumatic event on the plane and the person’s fear of flying, but there may not be a statistically significant correlation between the two variables in the general population.</p>
</div>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> Interesting. If it was a singular event, then would there not be a perfect correlation between flight exposure and fear of flying since there are two data points (pre-exposure level of fear &amp; post-exposure levels of fear)? If it is not a singular event and there is some proportion of the population that develops fear of flying after exposure to flying, then again we are back to the rare genetic cause of disease example - with sufficient data, we would be able to detect this causally driven correlation in the population. Any other ideas?</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> You make a good point, and I apologize for any confusion. The example I provided may not be a good example of causation without correlation.</p>
<p>Another example of causation without correlation could be the case of a person who develops an allergic reaction to a specific food after consuming it for the first time. In this case, the food is the direct cause of the allergic reaction, but there may not be a statistically significant correlation between consuming the food and developing an allergic reaction in the general population.</p>
<p>This lack of correlation could be due to individual differences in genetics or immune system function, or differences in the amount or preparation of the food consumed. Additionally, the relationship between the food and the allergic reaction could be confounded by other factors, such as the person’s age or other underlying health conditions.</p>
<p>Therefore, in this scenario, while there may not be a statistically significant correlation between consuming the food and developing an allergic reaction in the general population, there is a clear causal relationship between the two variables in the individual person who experienced the allergic reaction.</p>
</div>
<div class="limey">
<p><strong><em>Jon Brauer</em></strong> <br> Again, this example seems to have a very similar logical structure and empirical implications of your previous examples. I am going to write a blog entry on causation without correlation that covers a different type of example. I will share the idea with you in case it helps you answer questions like this. Another reason there might be causation without correlation is that an exposure affects multiple mechanisms that have countervailing effects on an outcome. For instance, the exposure might be causally related to the mediators and correlated with the mediators, but and the mediators are causally related to the outcome and correlated with the outcome but in opposite directions, thereby resulting in a null (negated or cancelled out) correlation in the population. There would still be causation, though, since one could imagine intervening on one mediating pathway to hold it constant, then the exposure would cause change the outcome - and be correlated with the outcome - through the other mediating pathway. Have you encountered any examples like this before?</p>
</div>
<div class="magma">
<p><strong><em>ChatGPT</em></strong> <br> Thank you for sharing your idea. That is a very interesting perspective on causation without correlation, and it makes sense that an exposure affecting multiple mechanisms could result in countervailing effects on an outcome, leading to a null correlation in the population.</p>
<p>I have not encountered this specific example before, but I can see how it could arise in situations where there are complex and interrelated causal pathways between an exposure and an outcome. For example, in a study investigating the effects of a particular medication on a disease outcome, the medication may affect multiple biological pathways that have opposing effects on the disease outcome. As a result, the overall correlation between medication use and disease outcome may be null or weak, even though the medication is causing changes in the underlying biological pathways and ultimately influencing the disease outcome.</p>
<p>I hope this example helps to provide a different perspective on causation without correlation, and thank you for bringing up this interesting topic.</p>
</div>
</details>
<p>To its credit, ChatGPT recognized the possibility of causation without correlation. However, it primarily provided examples where causation exists and correlation would be expected to exist but, for reasons such as event rarity, shoddy measurement, or insufficiently powered tests, researchers are unable to detect an actually existing (i.e., nonzero) correlation. Again, what I wanted was an example where causality exists, yet where we would <em>not</em> expect to detect a correlation (e.g., we might expect <em>r</em>=0).</p>
</section>
<section id="sec-dependence" class="level2">
<h2 class="anchored" data-anchor-id="sec-dependence">Causation <em>does</em> require statistical dependence</h2>
<p>One final point of clarification before getting to an example. The basic criteria are not really wrong. Causation involves <strong>statistical dependence</strong> between X and (mechanisms of) Y, and statistical dependence may exist despite a lack of observed linear correlation. I think it may be easier for some people to understand how this might happen for methodological reasons (e.g., imprecise measures; insufficient data; mispecified model) than it is to understand how this might happen for theoretical reasons. Counterfactual reasoning can help; so can <a href="https://onlinelibrary.wiley.com/doi/10.1111/1745-9133.12027">causal models</a> or <a href="https://cran.r-project.org/web/packages/ggdag/vignettes/intro-to-dags.html">directed acyclic graphs (DAGs)</a>.</p>
<p>For instance, you might be wondering if it is really useful or accurate to say that X causes Y if there is no (total) statistical dependence between X &amp; Y - that is, if (in some populations or samples comprised of units with particular levels of key variables) Y does not reliably change after X changes. Yes, I think so! To understand why, it is helpful to consider an example, to rely on causal models, and to engage in counterfactual thinking. There are many possible examples; for simplicity, let’s imagine only four variables - X, M1, M2, and Y - that are causally related like so:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psych)</span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(devtools)</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install_github("jtextor/dagitty/r")</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dagitty)</span>
<span id="cb1-8"></span>
<span id="cb1-9">XYdag <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagitty</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dag{</span></span>
<span id="cb1-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  X -&gt; M1 -&gt; Y</span></span>
<span id="cb1-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  X -&gt; M2 -&gt; Y</span></span>
<span id="cb1-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   }"</span>) </span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coordinates</span>(XYdag) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb1-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M1=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M2=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb1-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">X=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M1=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">M2=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Y=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) )</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(XYdag)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this hypothetical example, imagine that increasing or “dialing up the knob” on X causes an increase in both M1 and M2. Imagine also that increasing or dialing up M1 causes an <em>increase</em> in Y, whereas an increase in M2 causes a <em>decrease</em> in Y of comparable magnitude in the opposite direction (i.e., countervailing indirect effects). So, when we dial up X, we also causally up M1 and M2, which in turn equivalently dials Y up (through M1) and down (through M2) - meaning Y does not change when X changes despite changes in mediators.</p>
<p>So, you might still be wondering whether it is reasonable to describe this situation as one in which X <em>causes</em> Y, or whether this is an example of <strong>causation</strong> without (XY) correlation. Again, I say YES! To understand why, let’s use counterfactual reasoning. I want you to further imagine that we identify a way to intervene on the X -&gt; M1 -&gt; Y pathway. For instance, perhaps we design an intervention to mitigate or disrupt the X -&gt; M1 causal effect so that, when we dial up X, M1 no longer subsequently increases or it increases to a much lesser degree; that is, our intervention allows us to hold constant the level of M1 following a change in X, thereby negating the positive indirect effect of X on Y through M1. Now in this counterfactual situation, when we dial up X, what would happen to Y? It would change in a causally predictable way: If X increases, Y would decrease due to the negative indirect effect of X on Y through M2!</p>
<p>I hope this abstract example helps illustrate why, without the proper causal model guiding our statistical modeling decisions and interpretations of data, it is easy to fail to observe statistical dependence where it exists (and vice versa) and then to incorrectly infer a lack of causality (or its presence) from the absence (or presence) of observed correlation. To avoid such traps, what we need is to understand theoretically how and why X is related to Y - e.g., by creating a <em>causal diagram</em> that accurately depicts the causal relationship(s) between these variables and by using counterfactual reasoning. Once we identify the correct causal model generating the data, then we can model the data in a way that permits us to observe statistical dependence and identify the causal effect(s) of X on Y. In short, we really need to understand <strong>theory</strong>, or logical statements of the causal relations between concepts, to properly model and interpret our data.</p>
<p>With all that said, it can be difficult to grasp abstract examples, and it may be tempting to wonder whether such situations really exist in our world. So, let’s draw inspiration from a real study in criminology to add meat to the abstract bones of our example.</p>
</section>
<section id="sec-sescrim" class="level2">
<h2 class="anchored" data-anchor-id="sec-sescrim">Example from criminology</h2>
<p>Specifically, we will draw inspiration from Bradley Wright and colleagues’ (1999) <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1745-9125.1999.tb00483.x">paper in Criminology</a> entitled “Reconsidering the relationship between SES and delinquency: Causation but not correlation.” Seems fitting, eh?</p>
<p>The basic idea is this: There is a long history of debates over the SES-delinquency relationship. Some theories specifically posit a negative causal relationship (i.e., low SES -&gt; high delinquency), yet observational research has documented inconsistent patterns (e.g., weak negative, nonexistent, or even positive relationships). Wright and colleagues argue that this state of affairs may be due to SES simultaneously having positive and negative causal effects on crime through countervailing mechanisms. Together, the positive and negative effects of these mechanisms may generally offset each other in many survey datasets, which might result in observing a lack of any bivariate correlation between SES and delinquency (i.e., “total effect” estimate = 0) and/or inconsistent partial correlations (i.e., variable conditional direct effect etimates) depending on which mechanisms are included or excluded from researchers’ statistical models.</p>
<p>We will illustrate how something like this might happen using simulated data. Specifically, we will simulate data for <em>parental SES</em>, <em>child delinquency</em>, and two potential countervailing mechanisms - <em>financial strain</em> and <em>perceived risk of detection</em> of delinquent behaviors. In our simulated example, we will assume parental SES does not directly cause child delinquency and that it indirectly causes child delinquency through both mediating mechanisms. Additionally, we will assume that the causal effects of Parental SES on financial strain and perceived risk of detection are equal in magnitude and that the causal effect of financial strain on delinquency is equal in magnitude yet opposite in direction, such that both indirect or mediated effects offset one another. Below is a directed acyclic graph, or DAG, of this simple causal structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">SESdag <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dagitty</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dag{</span></span>
<span id="cb2-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  SES -&gt; Strain -&gt; Delinquency</span></span>
<span id="cb2-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  SES -&gt; Risk -&gt; Delinquency</span></span>
<span id="cb2-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   }"</span>) </span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coordinates</span>(SESdag) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Strain=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Risk=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SES=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Strain=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Risk=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) )</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(SESdag)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let’s simulate some data. In doing so, note we round data drawn from continuous (i.e., normal &amp; Poisson) distributions to integers; this adds a bit of noise to the data yet also makes our variables more comparable to the types of ordinal, Likert-type measures we see in our field.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># X = Parental SES</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Y = Child delinquent behavior</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># F = Mediatior through which high Parent SES might decrease delinquency - e.g., less financial (S)train</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># P = Mediators through which high Parent SES increase delinquency - e.g., lower perceived (R)isk of detection</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strain -&gt; Delinquency &lt;- Risk </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strain &lt;- SES -&gt; Risk</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb3-10">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># McElreath method (p.153)</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SES &lt;- rnorm(n)</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strain &lt;- rnorm(n,SES)</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Risk &lt;- rnorm(n,SES)</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Delinquency &lt;- rnorm(n,Strain-Risk)</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://www.tandfonline.com/doi/pdf/10.1080/10691898.2020.1752859</span></span>
<span id="cb3-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1138</span>)</span>
<span id="cb3-21">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb3-22">SES <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-23">Strain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-24">Risk <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-25">Delinquency <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Strain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>Risk <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(n,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-26"></span>
<span id="cb3-27">simdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(SES, Strain, Risk, Delinquency)</span>
<span id="cb3-28">simdata <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-29">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Delinquency =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, Delinquency)</span>
<span id="cb3-30">)</span>
<span id="cb3-31"></span>
<span id="cb3-32">simdata</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 × 4
     SES Strain  Risk Delinquency
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
 1    -1      1     0           2
 2    -1     -1     0           0
 3     0      1     1           2
 4     0     -1     0           0
 5    -1      0     1           0
 6    -1      1     0           2
 7     2     -1    -1           1
 8    -1      0    -1           4
 9     0      0    -2           2
10     1      0    -1           4
# ℹ 990 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">SESplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>SES, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..),</span>
<span id="cb5-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1fa187"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4ac16d"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb5-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb5-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-9">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Parental SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-11"></span>
<span id="cb5-12">Strainplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Strain, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..),</span>
<span id="cb5-14">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1fa187"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4ac16d"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb5-15">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb5-16">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-20">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Financial strain"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-22"></span>
<span id="cb5-23">Riskplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Risk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..),</span>
<span id="cb5-25">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1fa187"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4ac16d"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb5-26">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, </span>
<span id="cb5-27">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-30">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-31">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Perceived risk of detection"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-33"></span>
<span id="cb5-34">Delqplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> simdata <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Delinquency, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>..density..),</span>
<span id="cb5-36">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#1fa187"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4ac16d"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb5-37">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb5-40">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-41">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Child delinquency"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-43"></span>
<span id="cb5-44"></span>
<span id="cb5-45">SESplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Strainplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Riskplot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Delqplot</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="sec-bivar" class="level3">
<h3 class="anchored" data-anchor-id="sec-bivar">Bivariate correlation</h3>
<p>Let’s examine the bivariate correlations between our simulated variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://r-coder.com/correlation-plot-r/  </span></span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pairs.panels</span>(simdata,</span>
<span id="cb6-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">smooth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, draws loess smooths</span></span>
<span id="cb6-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, scales the correlation text font</span></span>
<span id="cb6-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds density plots and histograms</span></span>
<span id="cb6-7">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ellipses =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, draws ellipses</span></span>
<span id="cb6-8">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pearson"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Correlation method (also "spearman" or "kendall")</span></span>
<span id="cb6-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pch symbol</span></span>
<span id="cb6-10">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, plots linear fit rather than the LOESS (smoothed) fit</span></span>
<span id="cb6-11">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cor =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, reports correlations</span></span>
<span id="cb6-12">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">jiggle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, data points are jittered</span></span>
<span id="cb6-13">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">factor =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Jittering factor</span></span>
<span id="cb6-14">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hist.col =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histograms color</span></span>
<span id="cb6-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stars =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds significance level with stars</span></span>
<span id="cb6-16">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If TRUE, adds confidence intervals</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As the pairs plot shows, there is virtually no correlation between SES and delinquency (<em>r</em> = -0.01). However, SES is negatively correlated with both mediators - financial strain (<em>r</em> = -0.43) and perceived risk (<em>r</em> = -0.40). Additionally, the mediator-delinquency correlations are similar in magnitude but opposite in direction (<em>r</em> = 0.30 for financial strain; <em>r</em> = -0.35 for perceived risk).</p>
<p>Given this, if we estimate a linear model<sup>1</sup> regressing delinquency on SES without the mediators, we should see another near-zero association between SES and delinquency because this model essentially reproduces the bivariate correlation (with a partially standardized beta coefficient). This means the <strong>total effect</strong> of SES - its direct effect plus all indirect effects through other mechanisms like financial strain and perceived risk, all combined - is estimated to be virtually zero (<em>b</em> = -0.01, se = 0.04). Thus, either SES has no direct or indirect causal effects on delinquency, or SES has direct and/or indirect causal effects on delinquency but we have failed to adequately identify it with our statistical model (and with the assumed causal model underlying it). For instance, perhaps the causal effect is non-linear, with positive and negative effects on delinquency at different levels of SES that average out to a null total effect. Or, perhaps SES has countervailing indirect effets through different mediating mechanisms and, together, the mediators offset each other to result in no total causal effect.</p>
<p>Of course, we know this last explanation is the true data generating process here because we simulated the data accordingly! However, in real-world data analysis, if you were to observe no correlation between two variables, you now know that it is unwise to immediately assume that there is no causal relationship between them.</p>
</section>
<section id="sec-lm" class="level3">
<h3 class="anchored" data-anchor-id="sec-lm">Linear regressions</h3>
<p>The scatterplot and regression line from our bivariate linear regression model again illustrates the lack of total association between our simulated SES and delinqueny variables.<sup>2</sup></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">lm1a <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> SES, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdata)</span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(lm1a)</span></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(lm1a)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error
(Intercept)  1.09914632 0.03855249
SES         -0.01125514 0.03849479</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(simdata$SES, simdata$Delinquency)</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># abline(lm1a)</span></span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#equation for delinquency regression line  </span></span>
<span id="cb9-5">eqY1a<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){</span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1a)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1a)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb9-7">  }</span>
<span id="cb9-8"></span>
<span id="cb9-9">lmYplot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(simdata,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>SES)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun=</span>eqY1a, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb9-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb9-15">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>)</span>
<span id="cb9-17">lmYplot</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, let’s estimate a linear model regressing delinquency on SES and include <em>both mediators</em> as predictors in the model as well and then plot the regression line (with mediators set at their mean values). Once again, we should see a near-zero association between SES and delinquency, but for very different reasons this time. In this model, we are estimating what is commonly referred to as the <strong>direct effect</strong> of SES after stratifying on (aka, adjusting for) any potential indirect effects through financial strain and perceived risk mechanisms. Of course, we simulated our data in such a way that there would be no direct causal effect of SES on delinquency in our simulated data and, after including both mechanisms in the model, we accurately estimate virtually no direct effect of SES on delinquency (<em>b</em> = -0.03, se = 0.04). Hence, this plot looks comparable to the bivariate one above.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">lm1b <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Strain <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Risk, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdata)</span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(lm1b)</span></span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(lm1b)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate Std. Error     t value      Pr(&gt;|t|)
(Intercept)  1.07938412 0.03338240  32.3339287 2.126993e-157
SES         -0.02905861 0.03980686  -0.7299899  4.655680e-01
Strain       0.38859596 0.03290744  11.8087577  3.274331e-30
Risk        -0.43975564 0.03164821 -13.8951191  2.980525e-40</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(simdata$SES, simdata$Delinquency)</span></span>
<span id="cb12-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># abline(lm1b)</span></span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#equation for delinquency regression line in model with both mediators at means  </span></span>
<span id="cb12-5">eqY1b<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){</span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1b)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1b)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1b)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(simdata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Strain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1b)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(simdata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Risk)</span>
<span id="cb12-8">  }</span>
<span id="cb12-9"></span>
<span id="cb12-10">lmYplot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(simdata,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>SES)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun=</span>eqY1b, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb12-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb12-16">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>)</span>
<span id="cb12-18">lmYplot2</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that this model above also estimates a positive effect of financial strain (<em>b</em> = 0.39, se = 0.03) and a negative effect of perceived risk (<em>b</em> = -0.44, se = 0.03) on delinquency. So, we might conclude that these theoretical mechanisms are related to delinquency as expected. But how would we know SES has indirect causal effects on delinquency through these mechanisms - i.e., that these variables <em>mediate</em> the SES-delinquency relationship? Well, we could estimate additional models regressing each mediator on SES; if SES predicts each mediator (which we know it does in our simulated data) and if each mediator predicts delinquency then, with certain strong assumptions in place (e.g., no exposure-mediator interaction and no unmeasured confounding of any paths; see <a href="https://www.publichealth.columbia.edu/research/population-health-methods/causal-mediation">here</a>, <a href="https://datacolada.org/103">here</a>, and <a href="https://www.hsph.harvard.edu/tyler-vanderweele/tools-and-tutorials/">here</a>), we can infer indirect causal effects of SES on delinquency. This is essentially the logic behind the classic <a href="https://davidakenny.net/cm/mediate.htm#BK">Baron &amp; Kenny method</a>. We can also extend this logic to test for and estimate the magnitude and confidence intervals around such indirect effects through each specific mediator.<sup>3</sup></p>
</section>
<section id="sec-trap" class="level3">
<h3 class="anchored" data-anchor-id="sec-trap">Springing the causal trap</h3>
<p>But without jumping ahead to mediation tests, what would have happened if we had failed to specify the appropriate causal model ahead of time and, as a result, we mistakenly included <em>only one mediator</em> in the model with SES predicting delinquency? Let’s add financial strain to the model and exclude perceived risk from the model, then see what happens.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">lm1c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Strain, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>simdata)</span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># summary(lm1c)</span></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(lm1c)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coefficients[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value
(Intercept) 1.0982531 0.03642628 30.150019
SES         0.1790345 0.04027868  4.444895
Strain      0.3951323 0.03593409 10.996029</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(simdata$SES, simdata$Delinquency)</span></span>
<span id="cb15-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># abline(lm1c)</span></span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#equation for delinquency regression line in model with one mediator (at its mean)  </span></span>
<span id="cb15-5">eqY1c<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x){</span>
<span id="cb15-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(lm1c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(simdata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Strain) </span>
<span id="cb15-8">  }</span>
<span id="cb15-9"></span>
<span id="cb15-10">lmYplot3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(simdata,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Delinquency,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>SES)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun=</span>eqY1c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  </span>
<span id="cb15-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb15-16">        ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SES"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Delinquency"</span>)</span>
<span id="cb15-18">lmYplot3</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Uh oh. Suddenly, our model estimates a <em>positive</em> effect of SES on delinquency! Why?! Well, since we stratified on (adjusted for) financial strain, we essentially removed SES’s indirect effect on delinquency that operates through financial strain from our causal estimate. However, since we simulated these data, we know that SES also has an indirect effect on delinquency through perceived risk that is excluded from our model. So, the positive causal estimate of SES on delinquency in this model (<em>b</em> = 0.18, se = 0.04) reflects any direct effects of SES on delinquency (which we set to equal “0” in our simulation) and any indirect effects of SES on delinquency through unmeasured mediators - in this case, through perceived risk. We know that, in our simulated example, SES increases delinquency by reducing perceived risk of detection among those with high SES - that is, SES has <em>a positive indirect causal effect</em> on delinquency through perceived risk. Likewise, if we stratify on financial strain, thereby adjusting our estimate for this other known mediator, we are left with a positive estimate of the net causal effect of SES on delinquency (which we know is through perceived risk).</p>
<p>This should help illustrate an important point about so-called <strong>direct effect</strong> estimates - they are not really estimating “direct” effects at all. Rather, like bivariate correlation and regression coefficients, they are simply descriptive statistics that summarize the <strong>total</strong> effect of a predictor (SES) on an outcome (delinquency) through any and all unmeasured mechanisms.</p>
<p>This is an essential point. Imagine we were analyzing real non-simulated observational data and, after including measures of known mediating mechanisms (e.g., financial strain; perceived risk) in our model, we observed no association or “direct effect” of SES on delinquency (like in our second model <code>lm1b</code> above). In that situation, it is possible that there are no other mediating mechanisms through which SES might cause delinquency. However, it is also possible that there are additional unmeasured mechanisms that, combined, offset each other to result in a near-zero total remaining causal effect!</p>
<p>Moreover, bivariate correlations and partial regression coefficients also may be biased by effects of other unmeasured sources of confounding as well. In our simulation, we made a strong simplifying assumption that there were no such unmeasured sources of confounding and that we had identified all relevant mechanisms. However, with real data, such assumptions often are highly implausible. Hence, if one cares about causal effects of a variable (SES) on an outcome (delinquency) - total, indirect, or otherwise - then it is essential to identify the appropriate causal model and then to include (or exclude) variables as appropriate to accurately estimate the causal effect of interest. One cannot simply let the data speak.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/datacantspeak2.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Data cannot speak meme</figcaption>
</figure>
</div>
</section>
<section id="sec-mediate" class="level3">
<h3 class="anchored" data-anchor-id="sec-mediate">Simple mediation tests</h3>
<p>Finally, let’s illustrate a simple test of the indirect effect of SES on delinquency using <code>mediate()</code> from the psych package.<sup>4</sup></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mediate</span>(Delinquency <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> SES <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (Strain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (Risk), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> simdata, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">short =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mediation/Moderation Analysis 
Call: mediate(y = Delinquency ~ SES + (Strain) + (Risk), data = simdata, 
    n.iter = 10000)

The DV (Y) was  Delinquency . The IV (X) was  SES . The mediating variable(s) =  Strain Risk .

Total effect(c) of  SES  on  Delinquency  =  -0.01   S.E. =  0.04  t  =  -0.29  df=  998   with p =  0.77
Direct effect (c') of  SES  on  Delinquency  removing  Strain Risk  =  -0.03   S.E. =  0.04  t  =  -0.73  df=  996   with p =  0.47
Indirect effect (ab) of  SES  on  Delinquency  through  Strain Risk   =  0.02 
Mean bootstrapped indirect effect =  0.02  with standard error =  0.03  Lower CI =  -0.04    Upper CI =  0.08
R = 0.5 R2 = 0.25   F = 112.47 on 3 and 996 DF   p-value:  3.83e-79 

 To see the longer output, specify short = FALSE in the print statement or ask for the summary</code></pre>
</div>
</div>
<p>As before, these models estimate a near-zero total effect (<em>c</em> = -0.01) and so-call “direct effect” (<em>c’</em> = -0.03) of SES on delinquency. However, SES is negatively associated with both mediators, and each mediator has a comparably sized yet opposite effect on delinquency. The text results also indicate that the total indirect effect of SES on delinquency through both mediators is nearly zero as well (Mean bootstrapped indirect effect [<em>ab</em>] of SES on Delinquency through Strain and Risk = 0.02; standard error = 0.03; 95% CI = [-0.04, 0.08]). This should be unsurprising since we simulated the data so that the two indirect effects would equally offset one other, resulting in a total indirect effect of zero.</p>
<p>We could re-estimate the model, specifying each mechanism separately as a posited mediator, to calculate an estimate of the specific indirect effect through each mediator. Or, we could multiply the SES-&gt;Mediator path coefficient and the Mediator-&gt;Delinquency path coefficient together to get basic estimates of these specific indirect effects. For instance, using this “product of <em>ab</em> coefficients” approach, we would estimate a negative indirect effect of SES on delinquency through financial strain (-0.48 * 0.39) approximately equal to -0.19 and a positive indirect effect through perceived risk (-0.47 * -0.44) approximately equal to 0.21.<sup>5</sup> As expected, these countervailing indirect effects nearly perfectly offset one another!</p>
<p>So, this was a long-winded illustration of just one way that two variables might be <strong>causally related even in the absence of observing a (bivariate; total; direct) correlation</strong> between them!</p>
</section>
</section>
<section id="sec-caution" class="level2">
<h2 class="anchored" data-anchor-id="sec-caution">Concluding cautions</h2>
<p>Finally, remember that although this example was inspired by a published study, ours is also a contrived example using simulated data designed to help you think more deeply about causation and (non)correlation. With simulated data, we create the rules and can ensure strong mediation assumptions are met. Yet, in the real world of messy observational data, there are often countless plausible causal models that could have generated the patterns of correlations in one’s data. For an excellent example, check out Julia Rohrer’s blog entry about <a href="https://www.the100.ci/2019/10/03/indirect-effect-ex-machina/">hunting for indirect effects</a> in the absence of a total effect (e.g., correlation) between X &amp; Y. She warns:</p>
<blockquote class="blockquote">
<p>Third, be wary of mediation in the absence of a total effect. There may be scenarios in which it makes sense, but confounding may be the more plausible alternative explanation in other scenarios.</p>
</blockquote>
<p>Her example beautifully, or frighteningly, illustrates how a collider can produce an erroneous inference about an indirect effect. You might be wondering to yourself: <em>what the heck is a collider</em>? Great question. To us, it is the scary monster in our statistical modeling closet that keeps us up at night; neither of us have ever really seen the monster, but we’ve read enough stories about it to be convinced that it is there. We’ll try tackling that one another time…</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Yes, I realize that I simulated the outcome variable, <em>Delinquency</em>, from a Poisson distribution - you got me. I should be specifying a generalized linear regression model (e.g., Poisson distribution with a log link) instead to avoid generating biasing estimates and accurately recover simulated parameters. But, then I would need to get into more <a href="https://ftp.cs.ucla.edu/pub/stat_ser/r363.pdf">advanced issues related to estimating indirect effects in nonlinear models</a>, which would distract from the key point here. Let’s get this straight: I adopted a simple modeling approach that is a poor match to the more complex (simulated) data I am analyzing for the sake of easing interpretation for the reader. Sound familiar? Now, it seems I have painted myself into a corner. Don’t worry - I have a mantra to get us out of this mess, courtesy of my dad: Do as I say and not as I do! If you are considering estimating indirect effects with real-world data, please check out <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4287269/">counterfactual causal mediation</a> approaches; various packages in R, like <a href="https://bs1125.github.io/CMAverse/">CMAverse</a> or <a href="https://bs1125.github.io/CMAverse/">medflex</a>, might do the trick. Moreover, in the course of conducting <em>real</em> science, don’t paint yourself into a corner. You’ll just be stuck in place for a long time and the job won’t be finished, or you’ll get paint on your shoes and make a huge mess that someone has to clean up.↩︎</p></li>
<li id="fn2"><p>We used <code>geom_jitter()</code> to slightly offset or spread out observations that fall at the exact same place on the plot, which can be helpful in a scatterplot displaying a limited (e.g., ordinal) variable. With this method, observations cluster around their actual values rather than directly on the same crowded points, which permits you to see where data are plentiful or sparse along the observed distributions.↩︎</p></li>
<li id="fn3"><p>It remains common for researchers to use the <a href="https://web.pdx.edu/~newsomj/semclass/ho_mediation.pdf">Sobel product of coefficients approach</a> for mediation tests and to estimate <a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2022.810258/full">bias corrected bootstrapped confidence intervals</a>. However, for most observational data applications, I typically recommend using a <a href="https://www.publichealth.columbia.edu/research/population-health-methods/causal-mediation">causal mediation approach</a> that relies on counterfactual reasoning using a potential outcomes framework to estimate controlled and natural direct and indirect effects, along with <a href="https://journals.sagepub.com/doi/full/10.1177/25152459221095827">careful consideration</a> and <a href="https://bmcresnotes.biomedcentral.com/articles/10.1186/s13104-016-2163-7">transparent reporting</a> of the <a href="https://www.annualreviews.org/doi/10.1146/annurev-publhealth-032315-021402#_i12">strong assumptions</a> required to interpret mediation results as causal effects.↩︎</p></li>
<li id="fn4"><p>This is a very <a href="https://r-workshop.mindsci.net/mediation">basic mediation function</a> that applies the Sobel product of <em>ab</em> coefficients approach mentioned earlier. Remember, do as I say and not as I do! As noted above, I would not recommend this approach for most applications to observational data. However, in this case, the data were simulated from random distributions and a simple causal mediation structure without confounding or exposure-mediator interactions, so we know the <a href="https://www.annualreviews.org/doi/10.1146/annurev-publhealth-032315-021402#_i12">strong causal mediation assumptions</a> hold. As such, this simple approach is sufficient for our purposes. That is, assuming you did us a solid by ignoring our Poisson-distributed outcome variable - and all the paint on our shoes.↩︎</p></li>
<li id="fn5"><p>Using the population parameters we specified to generate our simulated sample, the population <em>ab</em> indirect effect magnitudes equal (-0.5 * 0.5) = -0.25 and (-0.5 * -0.5) = 0.25, respectively.↩︎</p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer2023,
  author = {Brauer, Jon},
  title = {Causation Without {Correlation?}},
  date = {2023-04-10},
  url = {https://reluctantcriminologists.com/blog-posts/[4]/causation-no-corr.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer2023" class="csl-entry quarto-appendix-citeas">
Brauer, Jon. 2023. <span>“Causation Without Correlation?”</span> April
10, 2023. <a href="https://reluctantcriminologists.com/blog-posts/[4]/causation-no-corr.html">https://reluctantcriminologists.com/blog-posts/[4]/causation-no-corr.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <category>rstats</category>
  <category>causality</category>
  <category>mediation</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[4]/causation-no-corr.html</guid>
  <pubDate>Mon, 10 Apr 2023 04:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[4]/empty-egg-dag3.png" medium="image" type="image/png" height="135" width="144"/>
</item>
<item>
  <title>Dr. Charles R. Tittle’s intellectual contributions</title>
  <dc:creator>Jon Brauer, with Katya Botchkovar and Carter Hay</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[3]/charles-memorial.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[3]/charles_smiling.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Dr.&nbsp;Charles R. Tittle</figcaption>
</figure>
</div>
<p>The comments below were delivered in one of two <a href="https://tinyurl.com/yf3uexwu">tribute panels</a> dedicated to Dr.&nbsp;Charles R. Tittle’s intellectual and interpersonal contributions to criminology at the <a href="https://asc41.com/events/2021-asc-annual-meeting/">2021 American Society of Criminology annual meeting</a> in Chicago. While others contributed additional comments on the spot, the following include only those formally scheduled comments delivered about Charles’ intellectual contributions to the field. Click on a panel topic below to expand and view its contents:</p>
<p><strong>Charles R. Tittle Tribute I: Intellectual Contributions to Criminology</strong></p>
<details>
<summary>
Contributions to International Criminology (Katya Botchkovar)
</summary>
<section id="sec-charles_international" class="level2">
<h2 class="anchored" data-anchor-id="sec-charles_international">Contributions to International Criminology</h2>
<p><strong>by <a href="https://cssh.northeastern.edu/faculty/ekaterina-botchkovar/">Katya Botchkovar</a></strong></p>
<p><em>Katya gave us permission to share the recorded video of her presentation, which was delivered remotely for the ASC tribute session:</em></p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/PgUFS5-Cum4" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section></details>
<details>
<summary>
Contributions to Measurement and Theory Testing (Carter Hay)
</summary>

<section id="sec-charles_measurement" class="level2">
<h2 class="anchored" data-anchor-id="sec-charles_measurement">Contributions to Measurement and Theory Testing</h2>
<p><strong>by <a href="https://criminology.fsu.edu/faculty-and-staff/carter-hay">Carter Hay</a></strong></p>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p><em>Carter gave us permission to share the written notes for his comments delivered for the ASC tribute session:</em></p>
<p>Thank you Jon, and thank you for all of your organizing these sessions that allow us to reflect on Charles as such an important scholar and person for the field of criminology but also in our lives. My areas to cover are measurement and theory testing, and it was a wonderful idea to put those two together because when we look at Charles’s research in broad strokes, those two are inherently linked. I think of it in this way:</p>
<ul>
<li>Charles was as theoretical as they come — he approached each issue with a deep concern for theory.</li>
<li>But he also was immensely empirical; analyzing data and testing hypotheses are the core of his research activities.</li>
<li>But a third thing: He commonly used data that he had some part in collecting, which meant that he wasn’t having to rely on the measures available in secondary data; instead, he played a role in shaping new novel measures of theoretical concepts.</li>
</ul>
<p>This ultimately translated into extraordinary number of novel creative tests—studies that are among the best and most influential tests of a given theory, and this often was due in part to measurement.</p>
<p>And he did this for MANY different theories — by my count, it’s at 10 different theories not just that Charles was able to test, but that he was able to test with original data that enabled he and his co-authors to design their own measures:</p>
<ul>
<li>Differential association theory</li>
<li>Self-control theory</li>
<li>Deterrence theory</li>
<li>Reintegrative shaming and labeling theory</li>
<li>Strain theory, including general strain theory</li>
<li>Situational action theory</li>
<li>Colvin’s social support/coercion theory</li>
</ul>
<p>And then there also are theoretical topics that cut across <strong>multiple</strong> theories, including innovative work on:</p>
<ul>
<li>criminal motivations</li>
<li>morality and crime and religiosity and crime.</li>
</ul>
<p>It’s not possible talk about all of those areas where Charles had a big impact with respect to measurement and empirical testing. I’m instead going to discuss two of those areas—deterrence and self-control—in some detail as illustrations of his general approach and his lasting influence.</p>
</section>
<section id="deterrence" class="level3">
<h3 class="anchored" data-anchor-id="deterrence">Deterrence</h3>
<p>So the first area I want to focus on is deterrence. Charles’s work in this area most clearly begins with the Tittle (1969) article that used official data for the 50 states to reveal that the certainty of punishment—as indicated by the probability of imprisonment—was associated with lower crime and that severity (the length of prison sentences) also could reduce crime when certainty was at high levels. Charles’s key point in that article and in several others that followed in the 1970s was that deterrence needed to be taken seriously; it had been dismissed, but this wasn’t because good testing or good data had found problems; instead, he saw biases in play along with a tendency to go along with the conventional wisdom even when it wasn’t on firm ground.</p>
<p>Charles wasn’t in favor of deterrence theory, he wasn’t opposed to it—he wanted to test it effectively.</p>
<p>And his ideas on how best to test deterrence evolved fairly quickly and they would help shape the field. In 1972, Charles gets an NSF grant of $100,000 to fund a survey approach to testing deterrence theory. The results of that work were published in the book Sanctions and Social Deviance was published in 1980 and in some other articles published around that time.</p>
<p>Early in the book, he makes the case for studying deterrence with surveys, which of course, was quite different than his 1969 test that attracted so much attention—he expressed some real doubts that the macro-level research could ever explicitly reveal fear of sanctions as the operative mechanism, and this was crucial for distinguishing deterrence from other mechanisms by which punishment can affect crime.</p>
<p>Also, Charles felt that causal order issues would be tough to parse out because of how legal systems are embedded in complicated social contexts where history looms large. Even with sophisticated analyses, it was difficult to determine whether low certainty was leading to high crime, or conversely, whether high crime was leading to low certainty.</p>
<p>So he set out to try to address these two issues with a survey of roughly 2,000 adults randomly selected from three states: Iowa, Oregon, and New Jersey.</p>
<p>So on that first issue, Charles’s created an comprehensive measure of fear of sanctions. He identified multiple indicators of fear that were used for a multitude of different rule violations, with these capturing:</p>
<ul>
<li>the chances that people would find out?</li>
<li>would those be people you know?</li>
<li>would lots of people in the community find out?</li>
<li>would there be a loss of respect?</li>
<li>would it produce an arrest?</li>
<li>would produce jail?</li>
</ul>
<p>And then scores were further adjusted based on the person’s peer deviance—if most of the people that someone knew engaged in deviance, then them finding out probably shouldn’t be seen as increasing sanction fear.</p>
<p>Now, I’ll emphasize that Charles was not the only one pursuing this survey approach at this time (Waldo, Chiricos, Anderson), but his comprehensive approach to measurement was unique and his attention to scaling was meticulous.</p>
<ul>
<li>And let me mention something in connection to that — when you go to Charles’s CV, you see that 4 of his first 6 publications were explicitly measurement-oriented methodological pieces — measurement and scaling were the explicit priorities of the paper. This included articles or research notes from 1966-68 in American Journal of Sociology, Public Opinion Quarterly, Sociometry, and Social Forces. Collectively, they were cited more than 600 times and often re-printed.</li>
<li>These articles precede the articles in criminology that we think of regarding Charles’s career, and they dealt with things like political activity and bureaucratization, but there’s some foreshadowing that innovation and rigor in the area of measurement would be central to his work.</li>
</ul>
<p>But the scope of his survey-based approach to deterrence theory also was unique—it was a big project drawing a very diverse set of subjects from 3 states to ensure big variations in social contexts—which is critical to testing deterrence theory—a convenience sample taken from a group of people in the same social context simply isn’t the best test.</p>
<p>So that’s innovation #1 — taking the most rigorous approach possible to get at that mechanism of fear.</p>
<p>The second innovation dealt with this causal order issue, which had its own problems when using the survey approach. In cross-sectional studies, perceived certainty, severity, or fear of sanctions is measured at the time of the survey and offending is measured for the prior 6 or 12 months creating an obvious causal order concern in which offending precede perceptions of sanctions.</p>
<p>Now longitudinal panel data could be used but that’s difficult to come by and it creates the problem of lags—current perceptions are being used to predict future behavior, but what if perceptions of sanctions change and those current perceptions being measured at the time of the survey become outdated.</p>
<p>So Charles had an interesting fix for this — he measured projected deviance.</p>
<p>He asked this question: “If you were in a situation tomorrow where you had an extremely strong desire or need to [fill in the blank on the behavior], what are the chances that you would actually do it?”</p>
<p>So he used current perceptions of punishment to predict this measure of <strong>projected deviance</strong>, but he also measured prior deviance — it could be used as a conditioning variable or a control variable, and this measurement advance created much stronger causal inferences, especially in light of the later research that would show that projections of future deviance often were strongly correlated with actual deviance.</p>
<p>And this approach becomes the basis for many criminological studies that in some way make use of projected deviance or crime, intentions to offend, willingness to offend, and the vignette studies. These studies go beyond deterrence theory—studies on strain theory, differential association theory, self-control theory, and so on. In many instances, they cite Tittle’s earlier work—that’s especially true for the people in this room because there are a lot of us who have used these measures—but even when Tittle wasn’t cited, they typically lean on the same basic rational that Charles drew attention to more than 40 years ago:</p>
<p>the desire to use cross-sectional data to examine contemporaneous or short-term effects (rather than lagged effects) and to do so with stronger causal inferences.</p>
<p>Taking these two innovations together, what did Charles find? Findings that are very close to the current state of knowledge today. He found that:</p>
<ul>
<li>Sanction fear reduces offending but fairly modestly.</li>
<li>Perceived informal sanctions tends to matter more than perceived formal sanctions.</li>
<li>And sanction fear generally has smaller effects than other theoretical variables, including moral commitments, social bonding, and differential associations.</li>
</ul>
<p>And Charles discovered lots of contingencies. His findings on this are immensely valuable; they laid the groundwork for interesting work to come on the idea of differential deterrability — with sanction fear operating more for some people and under some circumstances than others.</p>
<section id="sec-charles_deterrence" class="level4">
<h4 class="anchored" data-anchor-id="sec-charles_deterrence">(Mark Stafford on deterrence)</h4>
<p>And this issue of contingencies is something that <a href="https://faculty.txst.edu/profile/1921048">Mark Stafford</a> emphasized in comments that he sent me. Mark had a family issue arise and he wasn’t able to travel to Chicago, but I wanted to share with you his comments on this issue:</p>
<blockquote class="blockquote">
<p>Most deterrence researchers have paid lip-service to the idea that the threat of legal punishment probably interacts with other variables to affect the likelihood of crime. However, few have followed through on it, and no one as much as Charles. This was a central theme in his Sanctions and Social Deviance: The Question of Deterrence. A brief perusal of his deterrence studies over the years reveals that he looked at interactions between punishment threats and age, gender, informal punishments, self-control, and morality.</p>
</blockquote>
<blockquote class="blockquote">
<p>Probably my favorite deterrence research by Charles focused on the possible interaction between punishment threats and motivation to commit crime. When I was a graduate student at the University of Arizona, I remember students (Mark Warr, Kirk Williams, Joe Rankin, and I) drinking with faculty (Jack Gibbs, Maynard Erickson, and Gary Jensen) on many occasions and discussing the obvious that punishment threats could not deter unless people were motivated to commit crime. We concluded, however, that motivation was too complex to capture in a simple measure. Move ahead decades later and that is exactly what Charles did – he measured motivation, and by simply asking people how much they wanted to commit crime. It turned out that this measure interacted with punishment threats to form a strong predictor of crime. Charles had a real talent of taking complex ideas and reducing them to their basics. What was too complex for the rest of us was easy for Charles. As a consequence, deterrence research is decades ahead of where it would have been without Charles. Perhaps it is hyperbole to compare Charles with Bentham and Beccaria, but I bet they would have liked to pick Charles’ brain about deterrence, and I bet Charles would tell them many things they got wrong.</p>
</blockquote>
</section>
</section>
<section id="self-control-theorymany-innovations-here" class="level3">
<h3 class="anchored" data-anchor-id="self-control-theorymany-innovations-here">Self-control theory—many innovations here</h3>
<p>Let me pivot now to self-control theory, which is an area where Charles’s contributions are immense. Many of the things we know about this theory are things we learned from Charles’s work.</p>
<p>If you look at Charles’s book reviews and commentaries on Gottfredson and Hirschi’s self-control theory, along with comments he’d make, three things were clear: (1) he saw some shortcomings in the theory, (2) he was nevertheless impressed by the case they made for self-control being an important neglected variable, and (3) he knew the theory would attract a lot of attention and testing.</p>
<p>And a question has occurred to me, one that I wished I’d asked him: In 1991, when Charles published one of the first reviews of Gottfredson and Hirschi’s book, did he anticipate that he himself would become so central to the empirical testing of the theory? I don’t know; maybe some of you do.</p>
<p>But his centrality is unquestioned.</p>
<p>It begins obviously with the Grasmick et al.&nbsp;self-control scale, which of course never gets referred to by the more long-winded label of the Grasmick, Tittle, Bursik, and Arneklev scale. But I do know that Charles was quite involved in the development of that scale because he once described the painstaking process he went through to try to identify items from the California Psychological Inventory, along with the recognition at various points that newly invented items also would be needed.</p>
<p>That resulting scale they came up with was examined with new data from the Oklahoma City Survey in one the first tests of the theory, and that scale or subsets of it of it have been used in scores of studies. And their original study also has been cited more than 2600 times. The bottom line is that this scale is in many ways the gold standard for measuring self-control in criminology, and the meticulous attention to its scaling has inspired further research into not just this measure but possible limitations in Gottfredson and Hirschi’s initial conceptualization of self-control.</p>
<p>Another notable innovation of Charles’s in this area involves the distinction between <strong>self-control ability and self-control interest</strong>, along with his creative attempts to empirically distinguish them. This 2004 article with Grasmick and Ward really displays Charles’s skill in getting at the interplay between theoretical creativity and measurement. This study went beyond the arguments of the theory to consider something new, but rather than just making an interesting argument, he used data and creative measurement to test it.</p>
<p>The argument was this: self-control theory and research had been really centered on the idea that people differ in the <strong>ABILITY (or capacity)</strong> to exercise self-control—some people have that ability, some people don’t. Charles’s point was that there also could be variation in self-control <strong>INTEREST</strong>. Here’s what he said:</p>
<blockquote class="blockquote">
<p>some people may have a strong capacity for self-control but may not always want to exercise it, while others may have weak self-control ability but have such a keen interest in controlling their deviant impulses that they end up conforming.</p>
</blockquote>
<p>So these two things—ability and interest—can both be consequential and maybe they even interact with each other. Maybe the effect that one has on crime depends on how much of the other they possess.</p>
<ul>
<li>And he also raises this interesting possibility: self-control <strong>interest</strong> could be distinct from ability in being especially responsive to social stimuli. Maybe self-control ability is pretty stable in the way that the theory predicts, but interest—do you feel like exercising the self-control you really do possess or do you not feel like it?—is probably a much more situationally-fluid variable.</li>
</ul>
<p>So in this study, using Oklahoma City Survey data, they construct a measure of self-control interest, and they do so with items that place a person in a situation in which they have the option of REFRAINING from some deviant action, and they ask might come from refraining—</p>
<ul>
<li>would it allow them to feel proud?</li>
<li>to earn praise from others?</li>
<li>to avoid losing the respect of people they care about?</li>
<li>to avoid feeling guilty?</li>
</ul>
<p>If they say yes to these things, that’s an <strong>interest</strong> in exercising self-control.</p>
<p>And very quickly on the findings:</p>
<ul>
<li>They found that items measuring self-control interest coalesced nicely, loading on the same factor and not loading on a 2nd factor that including the traditional self-control ABILITY items.</li>
<li>Self control interest and self-control ability BOTH affected offending, often similarly, but when differences did emerge, it was <strong>INTEREST</strong> having the greater effect</li>
<li>There was some evidence of interaction such that self-control ability mattered less when a person was really INTERESTED in exercising self-control.</li>
</ul>
<p>Now there are other innovations that Charles had on self-control research, including measurement, but I’m running out of time. And there are other areas beyond deterrence and self-control theory that I would have liked to discuss. In particular, Charles’s research with Jon Brauer on Colvin’s social support and coercion theory in my mind provides a similar gold standard for testing that theory and measuring its concepts in both global and domain-specific ways.</p>
<p>But there’s not time, so I’ll just conclude by saying that the lasting influence of Charles’s research on theory testing and measurement comes back to a simple premise that seemed to always guide him, and we should be inspired to have it guide us as well. I believe that premise that really guided Charles was this:</p>
<ul>
<li>Before reaching a conclusion on something, get the highest quality evidence you can, even if doing that is really hard. And it probably will be really hard. Press on and do it anyway.</li>
</ul>
</section></section></details>
<details>
<summary>
Advocate for Theoretical Science in Criminology (Jon Brauer)
</summary>


<section id="sec-charles_science" class="level2">
<h2 class="anchored" data-anchor-id="sec-charles_science">Advocate for Theoretical Science in Criminology</h2>
<p><strong>by <a href="https://jonbrauer.com">Jon Brauer</a></strong></p>
<section id="introduction-1" class="level3">
<h3 class="anchored" data-anchor-id="introduction-1">Introduction</h3>
<p>As my colleagues have described, Charles’ scholarship advanced so many areas of criminological inquiry, including: (1) several important substantive debates in criminology; (2) concept measurement &amp; theory testing using survey research; (3) and assessment of the generality of criminological patterns &amp; theories across international contexts. As scholars, many of us would love to make meaningful contributions to any single issue within one of these broad areas. The breadth, magnitude, and consistency of his contributions cements Charles Tittle’s status as one of the brightest stars in our criminological universe.</p>
<p>Throughout all this work, one would be hard-pressed to find a theory of crime or deviance that was popular or that emerged during his illustrious 55+ year career that Charles had not read, reviewed, and even directly tested himself. Think about that a moment. He did not devote his time to becoming a specialist in any one theory or any particular area of inquiry. Rather, he devoted his time to becoming a specialist in countless theories and interdisciplinary areas relevant to his vast domain of inquiry – human behavior. That is, Charles embodied a generalist or Renaissance model of scholarship that seems all too rare in today’s knowledge silos, perpetuated by narrow training specializations, focused research funding and accomplishments, and exponential growth in short, quick-hitting publications.</p>
<p>Charles’ varied contributions stemmed directly from his philosophy of science. He was not simply jumping from latest fad to latest fad. He was not an opportunist doggedly seeking to aim his crosshairs at every emergent idea from other hard-working scholars. He was not just publishing because that is what we do. No, Charles had much loftier aims with his research and writing. Individually and in their totality, his publications reflect his deep commitment to the health and vibrancy of the field of criminology. In fact, to Charles, the health and vibrancy of a scientific field is tantamount to the health and vibrancy of <em>theoretical development</em> in that field.</p>
<p>Likewise, Charles devoted his entire career – and such a massive portion of his precious hours spent on this Earth – to trying to improve our theories: by reading them, thinking about them, testing them, critiquing them, developing them, and by advocating for and training others to do the same.</p>
</section>
<section id="charles-philosophy-the-mansion-of-science" class="level3">
<h3 class="anchored" data-anchor-id="charles-philosophy-the-mansion-of-science">Charles’ Philosophy &amp; The Mansion of Science</h3>
<p>Charles was not known as someone who spent much time writing explicitly about philosophy of science. Yet, he certainly had a coherent working scientific philosophy – his belief in and advocacy for the centrality of theories to scientific progress was a cornerstone – and while his scientific philosophy was readily apparent to those who knew him well, it also emanated from his teachings and writings.</p>
<p>In the introductory lecture to one of his foundational graduate theory courses, Charles would begin by describing the “mansion of science” as having many rooms, with these rooms divided into blocks representing different paradigms or models of science. After describing other complementary or competing models of science, such as descriptive, <em>vehrstehen</em>, engineering, critical, nihilistic approaches, and the like, Charles would then endorse the “theoretical science” model, which he viewed as the most efficient, reliable means of fostering scientific progress. He would also pointedly profess that the theoretical science model occupied the most rooms and held the best real estate in the mansion of science.</p>
<p>In this regard, Charles views were heavily influenced by works such as Richard Braithwaite’s classic 1953 book, <em>Scientific Explanation</em>, and by Paul Reynolds’ 1971 book, <em>A Primer in Theory Construction</em>. Reynolds’ book was particularly influential to Charles’ working scientific philosophy.</p>
<p>Like Reynolds, Charles viewed the goals of science and scientific activity as:</p>
<ol type="1">
<li>providing <em>typologies</em>, or identification and organization of phenomena into conceptual categories of similar and different things;</li>
<li>permitting the accurate <em>prediction</em> of future phenomena;</li>
<li>providing accurate <em>explanations</em> for past phenomena; and</li>
<li>providing people a <em>sense of understanding</em> about how and why phenomena occur via full articulation of the causal mechanisms linking changes in some concepts (causes) with changes in other concepts (effects).</li>
</ol>
<p>(Many would add the <em>potential for control</em> of phenomena as a secondary consequence of accurate explanation and prediction, though Charles was infamously resistant to making the jump from <em>is</em>-based knowledge to <em>ought</em>-based control or policy prescriptions given the state of our evidence, to which I will return soon.)</p>
<p>If these indeed are the primary goals of scientific activity, then theory development is central to science. Theories provide our typologies, or our conceptual categories and shared language about phenomena. Theories are our explanations of phenomena, and we use them to generate and test predictions. Likewise, theories are our (variably) formalized answers to why and how things occur and, as such, they do, or they fail to, provide us with a sense of understanding about – or potential for effective control of – phenomena. So, for Charles, science goes as our theories go. Also, like Reynolds, Charles viewed scientific progress or the successful pursuit of these goals as occurring most efficiently through what is reminiscent of a Lakatosian process involving:</p>
<ol type="1">
<li>Observing, describing, &amp; making initial empirical generalizations about phenomena -&gt;</li>
<li>Developing initial hypotheses, or what Charles endearingly called “simple theories,” that explain some of those descriptive patterns or empirical generalizations -&gt;</li>
<li>Rigorous testing of these (often numerous, varied, &amp; competing) hypotheses or “simple theories” -&gt;</li>
<li>Slow accumulation of knowledge from these tests; identification of additional generalizations &amp; negative cases; and, ultimately, the development of new theories that better account for patterns observed in accumulated knowledge base through processes such as theoretical invention, elaboration, or integration.</li>
</ol>
<p>Charles most explicitly outlines his adherence to this philosophy in one of my favorite pieces of his – a chapter in Gilbert Geis &amp; Mary Dodge’s wonderful 2002 book, <em>Lessons of Criminology</em> (see p.32-3), entitled “Confessions of a Reluctant but Committed Criminologist.” In it, he describes the eventual development of adequate theories ultimately is what will permit “explanation, prediction, and sometimes control of criminal/deviant or other human behavior.” He warns, a la Lakatos, that “[t]he whole process, however, is long and tedious, with knowledge growing in a cumulative process. One study means nothing; collections of large numbers and varieties of progressively more refined studies are required.” (p.33).</p>
</section>
<section id="lessons-of-a-reluctant-but-committed-criminologist" class="level3">
<h3 class="anchored" data-anchor-id="lessons-of-a-reluctant-but-committed-criminologist">Lessons of a Reluctant but Committed Criminologist</h3>
<p>In that Reflections chapter, Charles also described the first four important lessons of his academic career, which crystallized during his time on the faculty at Washington State University. Those are that:</p>
<ol type="1">
<li>Our body of verified scientific knowledge is exceptionally weak</li>
<li>[Theoretical] Science is the best model for criminological work</li>
<li>Bias is pervasive in social science, including criminology, &amp; is an archenemy of knowledge</li>
<li>Recommendations or guidelines from criminologists for social policy should be delayed until there is a strong scientific base of relevant knowledge</li>
</ol>
<p>Charles then states: “…to fully comprehend their import [of these four lessons] one must share certain definitions and orientations about the meaning of science.” That is, one must share a view of science as ideally involving the slow process of knowledge construction through careful observation, empirical generalization, explanation, testing, evolution of community consensus about the adequacy an explanation following accumulation of supporting and challenging test results, development of refined explanations under more general explanatory schemes or adequate theories, and rinse and repeat.</p>
<p>Charles worked with intention according to these lessons. His strong dedication to theory development always involved frequent testing of others’ ideas; ultimately, these efforts also culminated in his magnum opus, <em>Control Balance: Toward a General Theory of Deviance</em>. His advocacy for theoretical science was readily apparent in his book, in his reactions to critics of the book, and in his later published refinements to control balance theory.</p>
</section>
<section id="culmination-in-his-magnum-opus-control-balance" class="level3">
<h3 class="anchored" data-anchor-id="culmination-in-his-magnum-opus-control-balance">Culmination in His Magnum Opus, <em>Control Balance</em></h3>
<p>In the first sentence of his published reply in <em>Theoretical Criminology</em> to John Braithwaite’s review of <em>Control Balance</em>, Charles summarized the dual aims of his book:</p>
<blockquote class="blockquote">
<p>“<em>Control Balance</em>… tries to do two things. One is to set forth a paradigm for theory building and the other is to present an exemplar to be used as a starting point for the application of that paradigm. An important theme contained within the paradigm is that theory must represent the collective efforts of the community of scholars. No specific theoretical effort should be owned by anybody, a specific formulation is always tentative, and theory cumulates and improves as many individuals add their ideas and the results of research to the enterprise…”</p>
</blockquote>
<p>The paradigm he envisions here is a theoretical science of criminology oriented toward the collective, collaborative construction of causal process theories. The first half of <em>Control Balance</em> described this paradigm in detail. He started by illustrating both the utility and deficiencies inherent in existing “simple theories” of crime and deviance, thereby convincingly highlighting the need for a new paradigm such as his – and likely disaffecting at least as many readers as he convinced in the process. He then described core features of an adequate theory, calling for criminologists to work towards developing theories with sufficient <em>breadth</em>, <em>comprehensiveness</em>, <em>precision</em>, and <em>depth</em>. He subsequently argued that integration around central causal processes or mechanisms, as opposed to invention or elaboration, holds the greatest promise for collaborative efforts at effective theory development.</p>
<p>I am convinced our field would benefit from widely disseminating these initial chapters as a touchstone by which we judge our ideas and organize our efforts. In particular, I think we really need collective commitment to improving the <em>precision</em> of our causal predictions – to “identifying the conditions that influence exactly when and to what degree causal processes will unfold, the nature of the causal effects, the time interval between the proposed causes and expected effects” (or timing, magnitude, and functional form), and other contingencies that specify the scope or conditions under which the causal processes and predictions are expected to vary.</p>
<p>Additionally, Charles thought our best chance at accumulating a meaningful body of scientific knowledge in criminology was for us to build a community of like-minded scholars dedicated to the same cause. Toward this end, foreshadowing post-replication crisis movements, Charles put forth provocative suggestions for a more collaborative peer review system (in <em>The Criminologist</em>), and he advocated for changes to our incentive structures and training regimes to foster theoretical science pursuits. For instance, in his 2002 Reflections chapter, Charles stated (p.33):</p>
<blockquote class="blockquote">
<p>“For science to operate and to produce the desired outcomes, it must be supported by a community of scholars dedicated to the scientific enterprise. This community of scholars must structure itself to reward those who follow its dictates and ignore those who do not, and it must socialize new members in the values and methods of science. Those values include dedication to: (1) knowledge gained through the scientific method, (2) objectivity, (3) the search for truth, (4) open discussion and sharing of information, and (5) skepticism and mutual criticism. Science, therefore, is not value free. It is absolutely committed to a value system – the values of science. Moreover, science is a jealous master, insisting that other values (ideology and personal commitments) be rejected or overcome, at least when attempting to do science.”</p>
</blockquote>
<p>Charles also insisted that, this being a difficult task, we scientists organize our community to check competing values by “insisting on review by demanding critics, rewarding those who work against their own personal interests and values, and granting prestige to those who most fully exhibit the ideals of science while stigmatizing those who betray the cause.” If we meet these ideals, Charles asserted that “science can lead to knowledge that is more reliable, satisfying, and useful than any other paradigm by which people seek to understand human behavior and social organization.” However, “practicing science is difficult, especially for those who study social phenomena.” So, “the best that we criminologists can do is to practice science to the fullest extent possible, recognizing that our work often falls short and being cautious in our claims.”</p>
</section>
<section id="back-to-the-mansion" class="level3">
<h3 class="anchored" data-anchor-id="back-to-the-mansion">Back to the Mansion</h3>
<p>How did Charles think we criminologists are doing in this regard? Well, remember that mansion of science? I will refrain from elaborating on our self-derogatory conversations about which floors (or subfloors) our fields – sociology, criminology, &amp; criminal justice – took up in the mansion. What I will say, though, is that over their final several years attending ASC, Charles and his close friend Jim Short would frequently lament about the diminishing number of ASC panels devoted specifically to theory compared to the burgeoning number of panels representing work within those other paradigms. Moreover, in our last conversations, Charles expressed much pessimism about the health of criminology and the future of theoretical development in our field.</p>
<p>I certainly empathized with his viewpoint – much more so than I let him know in those conversations. However, I also pointed to various developments – such as emerging theoretical solutions to the replication crisis; advances in formal modeling; sophisticated theorizing and prediction in the Bayesian movement; and theoretical advancements tied to the counterfactual causal revolution – that I think hold much promise for interdisciplinary social science. He was also encouraged when I summarized Proctor &amp; Niemeyer’s new book, <em>Mechanistic Criminology</em>, which (I think) in many ways represents a new generation of criminologists carrying Charles’ paradigmatic torch into exciting unexplored theoretical territory and, likewise, holds much promise for our field.</p>
<p>Most importantly, across more than a half-century of scholarship, Charles practiced science to the fullest extent possible, he never failed to recognize that his work often fell short, and likewise he was consistently cautious in his claims. In doing so, he was perhaps most effective as a relentless advocate for theoretical science in criminology in leading us by example. His writings will live on in the scholarly record – with each of his individual studies meaning nothing on their own but, collectively, each contributing as “grist for the mill” of science in the long and tedious process of cumulative knowledge production. Additionally, likely without explicitly intending to do so, he built a community of like-minded scholars – including many of you in this room – who share his pursuit and, in doing so, make his journey and his immense sacrifices on the alter of science meaningful.</p>
</section>
<section id="community-building-by-example" class="level3">
<h3 class="anchored" data-anchor-id="community-building-by-example">Community Building by Example</h3>
<p>Finally, as a last testament to his advocacy and community building by example, I would like to close with quotes from a few students of Charles’ students – these are young scholars, a generation removed, most of whom never had the pleasure of meeting the man, the myth, the legend in black jeans and cowboy boots.</p>
<p>As these excerpts come from a list of longer quotes that I collected for a different purpose – to read to Charles as he neared the end – I have kept the authors’ names anonymous here. They are a small sample, but I think these effectively represent the legacy of influence that Charles Tittle has left with his students and colleagues.</p>
<p>First, two assistant professors who never met Charles but had read Control Balance in a graduate course state that reading Control Balance theory reminded them:</p>
<blockquote class="blockquote">
<p>“of the creativity, effort, and time it takes to actually put forth a theory. Your review of previous criminological theories and their weaknesses to even set up Control Balance Theory shows how meticulous you were in theory building approach. In today’s race to publish, it is easy to lose sight of the difficulty and time it takes to develop a comprehensive framework for thinking about crime.”</p>
</blockquote>
<p>An advanced doctoral student states that “Dr.&nbsp;Charles Tittle was the first scholar who was able to convince me of the value and power of theory and” that reading <em>Control Balance</em> “was, in the deepest sense of the word, enlightening.” After reading it, this student says:</p>
<blockquote class="blockquote">
<p>“I now think theory development and testing are some of the most important scientific endeavors social scientists can and should engage in–moreover, I find them the most intellectually satisfying! It turns out I love theory. His book, his articles, and even discussions with his former students influenced by his work have certainly shaped my trajectory as a student and a scholar. And I am certain that echoes of his influence will continue to shape the rest of my academic career.”</p>
</blockquote>
<p>An advanced graduate student states that:</p>
<blockquote class="blockquote">
<p>“Control Balance had a tremendous influence on me… in illustrating and breaking down all the complexities that go into theory building and integration. We all know human behavior is a complicated phenomenon, but the way Control Balance looks at the integration of theories to build a general theory of crime and how it connects the numerous converging variables, which each exists on their own continuum, is just artistry. Dr.&nbsp;Tittle’s work really stuck with me in enumerating how much work we have ahead of us in our field (and in many other fields) to truly understanding the nature of crime and deviance. His call for the continued elaboration on his work really sets a precedence for how we as scholars should approach and encourage critiques, elaboration, and hopefully integration on our own work instead of falling into the time-old tradition of pure competition.”</p>
</blockquote>
<p>A newer doctoral student says that prior to reading <em>Control Balance</em> for a course:</p>
<blockquote class="blockquote">
<p>“I had not, in fact, taken any interest in theory construction or debate, believing it to be outside of my level of comprehension. Upon reading Control Balance, I realized that theory is not a tool that one can afford to overlook out of fear of dissonance and ambiguity. As an individual who has only just begun to break into the world of theoretical science…, your book could not have come to me at a better time. For that, I thank you and proudly take up your call toward better theory, debate, and collaboration…”</p>
</blockquote>
<p>Finally, an advanced doctoral student explains various lessons learned from Charles work:</p>
<blockquote class="blockquote">
<p>“…your [Reflections chapter] taught me that it is important to be nice in the work that we do (from your conversation with Dr.&nbsp;Short), that it is okay to do science for the sake of science, and not to be supremely concerned with policy relevance. Along similar lines, your article The Arrogance of Public Sociology taught me to employ healthy skepticism regarding research that is primarily public/policy driven. Additionally, your work on Control Balance Theory has helped me see where existing theories are deficient, how they can potentially be improved, and how complex it is to formulate a grand theory of deviant/criminal behavior.”</p>
</blockquote>
<p>This student also reflected on how Charles’ legacy of mentorship was indirectly influential in teaching the importance of:</p>
<blockquote class="blockquote">
<p>“…increasing methodological rigor in research methodology/statistical analysis, creating a more transparent and cumulative science, being honest about things we do not know in the field, and an appreciation for the importance of testing and refining criminological theory. … I am forever grateful to you and cannot wait to pass on these principles to students of my own one day.”</p>
</blockquote>
<p>I could not have said that better myself. Thank you, Charles.</p>
</section></section></details>
<p>For additional reflections about Charles from a few of his former students and colleagues, see Washington State University’s wonderful <a href="https://soc.wsu.edu/socnews/remembering-charles-tittle-1938-2021/"><em>Remembering Charles Tittle</em></a> memorial tribute.</p>





<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer, with katya botchkovar and carter hay2023,
  author = {Brauer, with Katya Botchkovar and Carter Hay, Jon},
  title = {Dr. {Charles} {R.} {Tittle’s} Intellectual Contributions},
  date = {2023-03-12},
  url = {https://reluctantcriminologists.com/blog-posts/[3]/charles-memorial.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer, with katya botchkovar and carter hay2023" class="csl-entry quarto-appendix-citeas">
Brauer, with Katya Botchkovar and Carter Hay, Jon. 2023. <span>“Dr.
Charles R. Tittle’s Intellectual Contributions.”</span> March 12, 2023.
<a href="https://reluctantcriminologists.com/blog-posts/[3]/charles-memorial.html">https://reluctantcriminologists.com/blog-posts/[3]/charles-memorial.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[3]/charles-memorial.html</guid>
  <pubDate>Sun, 12 Mar 2023 05:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[3]/charles_smiling.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Check out some of our favorite sites</title>
  <dc:creator>Jon Brauer and Jake Day</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[2]/favorite_links.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[2]/DALL-E-melting_heart_of_statistics_in_Dali_style_80.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Melting heart of statistics in Salvadore Dali’s surrealist style, by DALL-E</figcaption>
</figure>
</div>
<p>We have learned so much from blogs, bookdowns, and videos openly shared by others. Here, we compiled a list of some of our favorite resources.</p>
<!--more-->
<p>This list is far from exhaustive; there are too many influential sources to recall and credit as deserved. Nonetheless, we felt it would be helpful to pull together some of those that we routinely find ourselves revisiting and recommending to others.</p>
<section id="statistics-especially-bayesian-approaches-and-more" class="level2">
<h2 class="anchored" data-anchor-id="statistics-especially-bayesian-approaches-and-more">statistics, especially Bayesian approaches, and more</h2>
<p><strong>Andrew Gelman’s</strong> <a href="https://statmodeling.stat.columbia.edu/">blog</a> is perhaps our favorite place to go for musings on all things statistics, especially <a href="https://statmodeling.stat.columbia.edu/2022/08/10/bayesian-inference-continues-to-completely-solve-the-multiple-comparisons-problem/">Bayesian inference</a>, <a href="https://statmodeling.stat.columbia.edu/2022/12/02/not-frequentist-enough-2/">frequentist evaluation</a>, <a href="https://statmodeling.stat.columbia.edu/2021/03/11/regression-discontinuity-analysis-is-often-a-disaster-so-what-should-you-do-instead-do-we-just-give-up-on-the-whole-natural-experiment-idea-heres-my-recommendation/">causal inference</a>, <a href="https://statmodeling.stat.columbia.edu/2023/03/09/the-butterfly-and-the-piranha-understanding-the-generalizability-and-reproducibility-crisis-from-statistical-and-political-perspectives-my-talk-at-the-university-of-minnesota-political-science/">multilevel modeling</a>, <a href="https://statmodeling.stat.columbia.edu/2022/04/05/confidence-intervals-compatability-intervals-uncertainty-intervals/">uncertainty</a>, and <a href="https://statmodeling.stat.columbia.edu/2018/12/04/bayes-statistics-reproducibility-many-serious-problems-statistics-practice-arise-bayesian-inference-not-bayesian-enough-frequentist-evaluation-not-frequentist/">reproducibility</a>. We also appreciate the frequent attention paid to <a href="https://statmodeling.stat.columbia.edu/2019/09/11/exchange-with-deborah-mayo-on-abandoning-statistical-significance/">philosophy of science issues</a> throughout many posts. Bonus: if you browse long enough, you might even stumble upon an answer to the question that perennially motivates a career crisis for us: <a href="https://statmodeling.stat.columbia.edu/2021/03/12/the-social-sciences-are-useless-so-why-do-we-study-them-heres-a-good-reason/">The social sciences are useless, so why do we even study them?</a>.</p>
<p>Speaking of Andrew Gelman - do you want to <a href="https://avehtari.github.io/ROS-Examples/">learn regression</a> or <a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian modeling</a>? Gelman and colleagues’ books and accompanying websites are excellent resources on these topics. However, our go-to resource for learning statistics from a Bayesian framework is <strong>Richard McElreath’s</strong> <a href="https://www.routledge.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-STAN/McElreath/p/book/9780367139919"><em>Rethinking Statistics (2nd Ed.)</em></a>. All code from the book and a corresponding R package (<code>rethinking</code>) are <a href="https://xcelab.net/rm/statistical-rethinking/">openly shared online</a>, and McElreath’s brilliant <a href="https://youtube.com/playlist?list=PLDcUM9US4XdNUolPcpdclIg4Ijt4dqxVc">video lectures on YouTube</a>, which he routinely updates, simply are without equal. Seriously - stop reading our site now and go work your way through those lectures and associated code.</p>
<p>As much as we love McElreath’s book and lectures for learning a Bayesian approach to data analysis, we usually rely on <strong>Paul Bürkner’s</strong> “Bayesian regression models using Stan,” or <code>brms()</code>, <a href="https://paul-buerkner.github.io/brms/">R package</a> for everyday Bayesian modeling tasks. In addition to the <code>brms()</code> package, we recommend checking out Bürkner’s <a href="https://paul-buerkner.github.io/projects/">research projects</a> and <a href="https://paul-buerkner.github.io/publications/">publications</a>. In particular, we especially appreciate his work on modeling and visualizing <a href="https://paul-buerkner.github.io/projects/#mu-bmb">uncertainty in (Bayesian) model comparison</a> and his efforts to incorporate cumulative link functions for modeling <a href="https://psyarxiv.com/9qkhj/">monotonic effects of ordinal predictors in Bayesian regression models</a>. Meanwhile, we are particularly fond of Bürkner’s <a href="https://paul-buerkner.github.io/brms/articles/index.html"><code>brms</code> vignettes</a>, especially those on <a href="https://paul-buerkner.github.io/brms/articles/brms_multivariate.html">multivariate (i.e., multiple response variables) models</a> and <a href="https://paul-buerkner.github.io/brms/articles/brms_monotonic.html">monotonic effects</a>. You can also watch <a href="https://www.youtube.com/watch?v=1qeXD4NQ4To">his talk on multilevel modeling in <code>brms</code></a> for free courtesy of <a href="https://www.youtube.com/@generableHQ/about"><span class="citation" data-cites="GenerableHQ">@GenerableHQ</span></a>.</p>
<p>So, what if you want to learn Bayesian analysis from McElreath’s book and lectures, yet you also want to follow along with his examples using the <code>brms()</code> package? Enter <strong>Solomon Kurz</strong>, the data science hero we need but do not deserve. Kurz has dedicated an unfathomable amount of energy to developing Bayesian translations of some of our favorite statistics books into R language and the <code>brms()</code> package, then sharing these valiant efforts in <a href="https://solomonkurz.netlify.app/book/">open-access bookdown projects</a>. Specifically, here are Kurz’s translations of the <a href="https://bookdown.org/content/3890">first edition</a> and <a href="https://bookdown.org/content/4857">second edition</a> of McElreath’s book. Additionally, many years agom Jake and I initially learned longitudinal data analysis in the SAS program using <a href="https://academic.oup.com/book/41753">Singer and Willett’s (2003) now-classic book</a>; Kurz actually offers a free <a href="https://bookdown.org/content/4253/">tidyverse and brms translation</a> of their book as well! Likewise, he has similarly translated two other favorites of ours: <a href="https://bookdown.org/content/3686/">Kruschke’s <em>Doing Bayesian Data Analysis</em></a> and Hayes’ <a href="https://bookdown.org/content/b472c7b3-ede5-40f0-9677-75c3704c7e5c/"><em>Introduction to Mediation, Moderation, and Conditional Process Analysis</em></a>. If you make it through all that free content, then we suggest heading over to his informative <a href="https://solomonkurz.netlify.app/blog/">blog on data analysis in R</a> for more useful content.</p>
<p>There are so many others worth mentioning in this section but, in respect of your time, we will simply share the rest in list format:</p>
<ul>
<li><strong>Matthew Kay’s</strong> <a href="https://www.mjskay.com/">site</a> for inspiration on communicating and visualizing uncertainty with <code>tidybayes</code> and <code>ggdist</code>. In particular, we recommend Kay’s various package vignettes, such as this one on <a href="https://cran.r-project.org/web/packages/tidybayes/vignettes/tidybayes.html">using tidy data with Bayesian models</a> and this one on <a href="https://mjskay.github.io/ggdist/articles/slabinterval.html">slab + interval stats and geoms with ggdist</a>. Also, you can watch <a href="https://www.youtube.com/watch?v=PqCaljvE89k">Kay’s talk on visualizing uncertainty</a> courtesy of <a href="https://www.youtube.com/@generableHQ/about"><span class="citation" data-cites="GenerableHQ">@GenerableHQ</span></a>.<br>
</li>
<li><strong>Andrew Heiss’s</strong> <a href="https://www.andrewheiss.com/blog/">blog</a>, especially entries on <a href="https://www.andrewheiss.com/blog/2022/09/26/guide-visualizing-types-posteriors/">different types of posterior predictions</a>, <a href="https://www.andrewheiss.com/blog/2022/05/20/marginalia/">marginal effects terminology</a>, and <a href="https://www.andrewheiss.com/blog/2022/11/29/conditional-marginal-marginaleffects/">conditional and marginal effects in multilevel models</a></li>
<li><strong>Aki Vehtari’s</strong> <a href="https://users.aalto.fi/~ave/">work</a>, especially that on <a href="https://avehtari.github.io/modelselection/">model selection</a>, <a href="https://arxiv.org/abs/1507.04544">model checking and cross-validation</a>, and <a href="https://arxiv.org/abs/2006.12335">posterior stacking</a>. Also, be sure to check out his various <a href="https://www.youtube.com/channel/UCcFy4yl5IyWeqJ5z2g1U8yg">videos</a>, like this one on <a href="https://www.youtube.com/watch?v=lKRRyrPxxeU">Bayesian workflow</a> or his open access course videos on <a href="https://www.youtube.com/playlist?list=PLBqnAso5Dy7O0IVoVn2b-WtetXQk5CDk6">Bayesian data analysis</a>.</li>
<li><strong>Michael Betancourt’s</strong> <a href="https://betanalpha.github.io/writing/">writing</a> and <a href="https://betanalpha.github.io/speaking/">videos</a> on probabilistic modeling in Stan, and especially those on adopting a <a href="https://betanalpha.github.io/assets/case_studies/principled_bayesian_workflow.html">principled Bayesian workflow</a>.</li>
<li><a href="https://www.the100.ci/"><strong>The 100% CI</strong></a> is a newer favorite. We are especially fond of Julia Rohrer’s (one of the site’s authors) various writing related to causal inference, like these on <a href="https://journals.sagepub.com/doi/full/10.1177/2515245917745629">directed acyclic graphs</a>, <a href="https://www.the100.ci/2017/03/14/that-one-weird-third-variable-problem-nobody-ever-mentions-conditioning-on-a-collider/">collider bias</a>, and what can go wrong with <a href="https://www.the100.ci/2023/03/07/non-representative-samples-what-could-possibly-go-wrong/">nonrepresentative samples</a>.</li>
<li>The <strong>Data Colada</strong> <a href="https://datacolada.org/">blog</a> offers great analysis on various topics. For instance, they write about <a href="https://datacolada.org/76">replication</a>, conduct <a href="https://datacolada.org/81">preregistered replications</a>, and even offer an R package (<a href="https://datacolada.org/100"><code>groundhog</code></a>) for improving reproducibililty of code. They also have interesting things to say about <a href="https://datacolada.org/104">meta-analysis</a> and problems with common techniques such as <a href="https://datacolada.org/58">funnel plots</a> and <a href="https://datacolada.org/30">trim and fill “corrections”</a>.</li>
<li><strong>Dan Quintana,</strong> co-host of the <a href="https://everythinghertz.com/"><em>Everything Hertz</em> podcast</a>, also has a <a href="https://www.dsquintana.blog/">blog</a> containing great resources for meta-analysis and more in R.<br>
</li>
<li><strong>Daniel Lakens’</strong> blog, the <a href="https://daniellakens.blogspot.com/">20% statistician</a>, is rife with useful posts about two of our favorite topics - statistics and philosophy of science. Some of our favorites include posts about <a href="https://daniellakens.blogspot.com/2021/11/why-p-values-should-be-interpreted-as-p.html"><em>p</em>-values</a>, <a href="https://daniellakens.blogspot.com/2020/03/effect-sizes-and-power-for-interactions.html">power</a> and <a href="https://daniellakens.blogspot.com/2014/12/observed-power-and-what-to-do-if-your.html">observed power</a>, the <a href="https://daniellakens.blogspot.com/2017/05/how-power-analysis-implicitly-reveals.html">smallest effect size of interest</a>, or whether <a href="https://daniellakens.blogspot.com/2019/01/does-your-philosophy-of-science-matter.html">philosophy of science matters in practice</a> (we think it does a lot in criminology). Several of his lecture videos are also available online, including <a href="https://youtu.be/gVqFAQC8O14">this one</a> that corresponds to another favorite post discussing why more of us should seriously consider <a href="https://daniellakens.blogspot.com/2019/11/do-you-really-want-to-test-hypothesis.html">whether we are really ready to test a hypothesis</a> in our research. Lakens has combined and expanded on a lot of these materials in his open access book, <a href="https://lakens.github.io/statistical_inferences/index.html"><em>Improving Your Statistical Inferences</em></a> and his free <a href="https://www.coursera.org/learn/statistical-inferences">coursera course</a> of the same name.<br>
</li>
<li>Of all the podcasts we enjoy, the <strong>Quantitude</strong> <a href="https://quantitudepod.org/?s=bayes">podcast</a> deserves a special shout-out for its highly informative yet quirky and accessible introduction to all sorts of important issues in statistics. Now, if only the hosts would join the Bayesian <a href="https://quantitudepod.org/s2e04-bayesian-wake-up-call/">dark side</a>.</li>
<li><strong>Jacob Kaplan</strong> has <a href="https://jacobdkaplan.weebly.com/books.html">multiple resources</a> related to R that are geared specifically to Criminologists. Perhaps most notably is a free online book <a href="https://crimebythenumbers.com/"><em>Crime by the Numbers: A Criminologist’s Guide to R</em></a>. Kaplan has great programming skills and, as such, many of his examples rely on base R functionality more so than ours do.</li>
</ul>
</section>
<section id="learning-data-science-with-r" class="level2">
<h2 class="anchored" data-anchor-id="learning-data-science-with-r">learning data science with R</h2>
<p>While there is so much to learn from resources found at the links shared above, those are not the first places we send our students and friends that are interested in learning data science skills in R, yet that lack any R programming experience. We find the following links to be especially useful for these purposes - so much so that they deserve their own dedicated section! Of course, we also hope our <a href="../../course-materials">course materials</a> might be useful in this regard to some of you.</p>
<p><strong>Danielle Navarro’s</strong> <a href="https://blog.djnavarro.net/">blog</a> is as delightful as it is informative. The blog is a model for reproducible R programming and showcases Danielle’s inspiring art throughout the site (see more of Danielle’s <a href="https://art.djnavarro.net/">computational art here</a>). The newest version of the blog often focuses on technical posts addressing issues beyond our range of program expertise. However, we love various topical essays from earlier blog renditions, <a href="https://psyarxiv.com/wxn58/">like this one on preregistration</a>, and we strongly recommend Danielle’s <a href="https://robust-tools.djnavarro.net/">Data Science with R</a> course and associated video tutorials for R beginners or those interested in leveling up their R skills.</p>
<p><strong>Allison Hill’s</strong> <a href="https://www.apreshill.com/blog/">blog</a> is a great place to find resources for learning to do as well as to teach R-related topics. For instance, we especially appreciate her post on teaching <a href="https://www.apreshill.com/blog/2020-05-how-i-teach-r-markdown/">R Markdown</a>, which was influential in creating our own courses, as well as her post on transitioning to <a href="https://www.apreshill.com/blog/2022-04-we-dont-talk-about-quarto/">Quarto</a>, which was helpful to us in creating our blog.</p>
<p>The <a href="https://psyteachr.github.io/">psyTeachR</a> website is a phenomenal repository of resources for learning and teaching reproducible research using R. They offer a wealth of open access courses and tutorials for undergraduate and graduate levels.</p>
<p>The <a href="https://easystats.github.io/easystats/"><code>easystats</code></a> collection of R packages is a great place for those new to R to learn basic skills related to modeling, visualization, and reporting within a relatively unified framework. Those new Unlike curated nature of R and package conflicts Those transitioning from curated statistical packages to R’s open-source environment, with its <em>a la carte</em> format and associated challenges (e.g., package conflicts), may find the <code>easystats</code> suite of packages especially helpful.</p>
<p>Of course, we also love creating data visualizations with <code>ggplot2</code> in R, so we owe a huge shout out to <strong>Hadley Wickham</strong> for all his R programming efforts and clear tutorials and foundational texts, which you can learn more about and freely access via his <a href="https://hadley.nz/">website</a>.</p>
</section>
<section id="creating-a-website" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-website">creating a website</h2>
<p>If you want to learn to create your own website or blog using R, we recommend checking out Andrew Rapp’s <a href="https://albert-rapp.de/posts/13_quarto_blog_writing_guide/13_quarto_blog_writing_guide.html">ultimate guide to creating a Quarto blog</a>, Beatriz Mills’ guide to <a href="https://beamilz.com/posts/2022-06-05-creating-a-blog-with-quarto/en/">creating a blog with Quarto in 10 steps</a>, Samantha Csik’s tutorial on <a href="https://samanthacsik.github.io/posts/2022-10-24-quarto-blogs/">adding a blog to your existing Quarto website</a>, and Ezekiel Ekunola’s instructions for <a href="https://www.codementor.io/@ekunolaeasybuoy/setting-up-domain-with-namecheap-netlify-12yiksvig6">setting up a personalized domain address for your site</a>.</p>
<p>In addition to R-based visualizations, we relied heavily upon <strong>Allison Horst’s</strong> <a href="https://allisonhorst.com/allison-horst">website</a>, where she freely shares amazing data science, statistics, and R themed artwork, to help improve our site’s aesthetics. We also had fun generating custom images and art using the artificial intelligence system <a href="https://openai.com/product/dall-e-2">DALL-E</a>.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer and jake day2023,
  author = {Brauer and Jake Day, Jon},
  title = {Check Out Some of Our Favorite Sites},
  date = {2023-03-11},
  url = {https://www.reluctantcriminologists.com/blog-posts/[2]/favorite_links.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer and jake day2023" class="csl-entry quarto-appendix-citeas">
Brauer and Jake Day, Jon. 2023. <span>“Check Out Some of Our Favorite
Sites.”</span> March 11, 2023. <a href="https://www.reluctantcriminologists.com/blog-posts/[2]/favorite_links.html">https://www.reluctantcriminologists.com/blog-posts/[2]/favorite_links.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <category>rstats</category>
  <category>causality</category>
  <category>bayesian</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[2]/favorite_links.html</guid>
  <pubDate>Sat, 11 Mar 2023 05:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[2]/DALL-E-melting_heart_of_statistics_in_Dali_style_80.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Welcome to the reluctant criminologists</title>
  <dc:creator>Jon Brauer and Jake Day</dc:creator>
  <link>https://www.reluctantcriminologists.com/blog-posts/[1]/welcome-blog.html</link>
  <description><![CDATA[ 



<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.reluctantcriminologists.com/blog-posts/[1]/RC_logo_white.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Reluctant criminologists logo</figcaption>
</figure>
</div>
<section id="why-are-we-doing-this" class="level2">
<h2 class="anchored" data-anchor-id="why-are-we-doing-this">Why are we doing this?</h2>
<p>First, this site is intended primarily as a central repository for conveniently sharing our course material and preliminary ideas with students and colleagues. It allows us to simply point people to a website rather than sending large html files via email or proliferating dropbox links. If it serves only this purpose effectively, we will be happy.</p>
<p>Second, this site is a direct consequence of our recent efforts to re-tool our approaches to doing science. We think this site will serve as evidence for how much we have learned - and likely as even stronger evidence of how much more we have yet to learn.</p>
<p>Of course, this begs the question: Why have we been re-tooling our approaches to science? Well, answering that question requires a longer conversation with multiple threads, and we anticipate weaving some of those threads into our future blog posts. For now, it may be clear from our posted materials that we are motivated to act in response to increasing concerns about replication failures across multiple scientific disciplines and awareness of subsequent reforms. We are also motivated by the perception that our academic disciplines of sociology and criminology, with some exceptions, may be lagging behind other fields <a href="https://statmodeling.stat.columbia.edu/2016/09/22/why-is-the-scientific-replication-crisis-centered-on-psychology/">like psychology</a> in self-reflection on these important issues and widespread adoption of <a href="https://www.economicscience.org/downloads/ReplicationWhitePaper.pdf">potentially effective reforms</a>. Likewise, we are moved by our own experiences with reproducing <a href="https://journals.sagepub.com/doi/10.1177/0049124119826158">high-profile work</a> and attempting to raise awareness through the traditional academic peer-review publication process about concerns regarding underpowered null hypothesis significance tests and common misinterpretations of null findings from such tests.</p>
<p>It is also fair to say that this site is indicative of early-mid-career crises of sorts brought on by other factors such as post-tenure malaise and serious reflections about what we are doing with our limited time in the aftermath of the global COVID-19 pandemic.</p>
<p>In fact, the initial idea for the blog emerged during the height of the pandemic in a long email thread between Jon and Jake. In a somewhat typical exchange, Jake was asking Jon to explain a relatively complex statistical topic (e.g., latent variable modeling in SEM vs.&nbsp;multilevel modeling). Jon was sharing resources, summarizing debates, and explaining issues that have been published on the topic across disparate statistical literatures over the years. Jake thought putting these types of discussions into a blog might be beneficial for multiple reasons. First, rather than burying this writing in emails, others might also appreciate such reviews or tutorials if they were available in a free, public-facing blog. Second, Jon seemed reluctant to write traditional academic articles on such topics since, from his perspective, they would be redundant - the reviews and debates are already out there, you just need to go read them (often in other fields). Meanwhile, Jon was receptive to the idea of a blog; he thought Jake should write more, and a blog might be a good way for both of them to spill ink and “try out” ideas under a critical public eye while perhaps even helping some students and colleagues along the way. So, here we are.</p>
<!-- See about page. Also mention perceived need in our field. See McElreath tweet about cultural anthro. -->
</section>
<section id="how-we-were-inspired-by-charles" class="level2">
<h2 class="anchored" data-anchor-id="how-we-were-inspired-by-charles">How we were inspired by Charles</h2>
<p>The name of our site pays homage to our late mentor and friend, Dr.&nbsp;Charles R. Tittle. It is meant to be a cheeky reference to his chapter entitled “Reflections of a Reluctant but Committed Criminologist” in Gilbert Geis and Mary Dodge’s <a href="https://www.taylorfrancis.com/books/edit/10.4324/9781315721507/lessons-criminology-gilbert-geis-mary-dodge"><em>Lessons of Criminology</em></a> (pp.23-45).</p>
<p>This is one of our favorite pieces written by Charles. Our perspectives on the field of criminology and criminal justice were heavily shaped by Charles and are thus quite comparable to the views he presents in that chapter. Here is how that chapter starts (p.23):</p>
<!-- Why not just use block quote? -->
<blockquote class="blockquote">
<p>“I didn’t intend to become a criminologist. Rather, happenstance led me to investigate certain sociological problems that resulted in my being labeled a criminologist (Tittle, 1991). After a while the reactions of others had the effects that symbolic interactionist theory would predict - I began to think of myself as a criminologist, although one with a larger allegiance. In fact, one of the first conclusions I drew as a criminologist is that criminology ought not be thought of as a discipline. Disciplines have unifying perspectives; criminology does not. Criminology is an umbrella term encompassing diverse studies of crime and crime-relevant phenomena undertaken from many disciplinary points of view. It makes sense to speak of an economic perspective, a political perspective, a historical perspective, or a sociological perspective. It makes no sense to speak of a criminological, a criminal justice, or a criminal perspective (at least not in an academic context). In my mind, the best criminology is done by those with a firm grounding in some discipline, or by those with an appreciation of several different disciplines, the insights of which are then brought to bear on criminological issues.”</p>
</blockquote>
<p>The chapter then proceeds to introduce several lessons that Charles learned throughout his illustrious career, which he later summarized as follows (pp.40-41):</p>
<blockquote class="blockquote">
<ol type="1">
<li>Criminology is not a discipline but a topical area dependent on a variety of disciplines and that criminological knowledge is best pursued and dispensed within the context of a liberal arts education</li>
<li>Our methods of identifying and recruiting new scholars must be improved</li>
<li>Evidence concerning most important issues having to do with crime and crime-relevant phenomena is weak; success requires that we commit ourselves to a long-range mission of improving that situation</li>
<li>Things are more complicated than our extant theories show, calling for improved theories specifying contingent and interactive effects</li>
<li>The most effective criminology demands that we be aware of and committed to the goal of developing general explanatory schemes refined through test and feedback</li>
<li>Science is the best model to follow in developing criminological knowledge</li>
<li>Weak science, which is likely to continue to characterize criminology for some time, is hardly a basis for policy</li>
<li>The barriers to, and distractions from, good scientific criminology, especially the widespread practice of ad hoc work and the intrusion of personal biases and larger ideologies, must be countered</li>
<li>Civility within the scholarly community is necessary for maximum collective effort</li>
</ol>
</blockquote>
<p>If you are interested in learning more about some of Charles Tittle’s intellectual contributions, check out <a href="../../blog-posts/[3]/charles-memorial.html">our blog post on the topic</a>, which contains comments delivered in a tribute panel for Charles at the 2021 American Society of Criminology annual meetings. To be clear, as we also note on our <a href="../../about.html"><em>About</em> page</a>, we were inspired by Charles but he did not endorse this project in any way; in fact, he likely would have thought it was a waste of time better spent contributing in more traditional ways to scientific theory development and testing. We think it’s safe to say that we are both more “reluctant” and less “committed” criminologists than Charles was.</p>
</section>
<section id="but-really-why-are-we-doing-this" class="level2">
<h2 class="anchored" data-anchor-id="but-really-why-are-we-doing-this">But really, why are we doing this?</h2>
<p>If we have a loftier aim for our site, it is to answer the call expressed in Charles’ lessons above by contributing modestly to the advancement of scientific criminology. In other words, this site is an attempt to help improve upon, even if just a little, what we perceive are systemic shortcomings in our respective fields.</p>
<p>Of course, we are not alone - scholars raise similar concerns in other social scientific disciplines, including <a href="https://journals.sagepub.com/doi/10.2466/pr0.1990.66.1.195">psychology</a>, <a href="https://openmkt.org/blog/2022/replications-in-marketing-myth-and-reality/">marketing</a>, and <a href="https://elevanth.org/blog/2022/09/19/the-problem-with-cultural-evolution/">evolutionary anthropology</a> to name a few. Likewise, we benefit immensely from the contributions in blogs and bookdown projects shared freely for the collective good by so many people from various disciplinary perspectives working within and outside academia. We encourage you to check out our <a href="../../blog-posts/[2]/favorite_links.html">favorite links</a> post for some excellent examples. Our hope is that this site might offer a comparable (derivative, bargain-basement) version that enriches conversations in our fields about how we can collectively strengthen our science through concerted efforts to improve our theories and the methods we use to generate knowledge about them.</p>
<p>In our own academic careers and scholarly pursuits, we continually try to improve our understanding of philosophies of science, substantive theories of crime and deviance, and quantitative methods used to test social scientific theories. Rather than solely bothering seemingly uninterested authors about these issues in the reviews we write for journals (we both now sign our reviews but the editors often take our names off), we thought we might as well put our thoughts out in public and subject them to criticism. Of course, we recognize the most likely outcome is that our thoughts, like in many of the reviews we write, will simply be (justifiably?) ignored. But we expect our own thinking on these matters will be strengthened by forcing ourselves to write them down and, ideally, by then accounting for your feedback.</p>
<p>So welcome to our blog! We’ll try to keep the navel gazing to a minimum from here on out.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brauer and jake day2023,
  author = {Brauer and Jake Day, Jon},
  title = {Welcome to the Reluctant Criminologists},
  date = {2023-03-10},
  url = {https://reluctantcriminologists.com/blog-posts/[1]/welcome-blog.html},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brauer and jake day2023" class="csl-entry quarto-appendix-citeas">
Brauer and Jake Day, Jon. 2023. <span>“Welcome to the Reluctant
Criminologists.”</span> March 10, 2023. <a href="https://reluctantcriminologists.com/blog-posts/[1]/welcome-blog.html">https://reluctantcriminologists.com/blog-posts/[1]/welcome-blog.html</a>.
</div></div></section></div> ]]></description>
  <category>general</category>
  <guid>https://www.reluctantcriminologists.com/blog-posts/[1]/welcome-blog.html</guid>
  <pubDate>Fri, 10 Mar 2023 05:00:00 GMT</pubDate>
  <media:content url="https://www.reluctantcriminologists.com/blog-posts/[1]/RC_logo_white.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
